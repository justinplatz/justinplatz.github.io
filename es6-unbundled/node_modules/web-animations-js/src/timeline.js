(function(shared,scope,testing){var originalRequestAnimationFrame=window.requestAnimationFrame;window.requestAnimationFrame=function(f){return originalRequestAnimationFrame(function(x){scope.timeline._updateAnimationsPromises();f(x);scope.timeline._updateAnimationsPromises()})};scope.AnimationTimeline=function(){this._animations=[];this.currentTime=void 0};scope.AnimationTimeline.prototype={getAnimations:function(){this._discardAnimations();return this._animations.slice()},_updateAnimationsPromises:function(){scope.animationsWithPromises=scope.animationsWithPromises.filter(function(animation){return animation._updatePromises()})},_discardAnimations:function(){this._updateAnimationsPromises();this._animations=this._animations.filter(function(animation){return"finished"!=animation.playState&&"idle"!=animation.playState})},_play:function(effect){var animation=new scope.Animation(effect,this);this._animations.push(animation);scope.restartWebAnimationsNextTick();animation._updatePromises();animation._animation.play();animation._updatePromises();return animation},play:function(effect){if(effect){effect.remove()}return this._play(effect)}};var ticking=!1;scope.restartWebAnimationsNextTick=function(){if(!ticking){ticking=!0;requestAnimationFrame(webAnimationsNextTick)}};function webAnimationsNextTick(t){var timeline=scope.timeline;timeline.currentTime=t;timeline._discardAnimations();if(0==timeline._animations.length)ticking=!1;else requestAnimationFrame(webAnimationsNextTick)}var timeline=new scope.AnimationTimeline;scope.timeline=timeline;try{Object.defineProperty(window.document,"timeline",{configurable:!0,get:function(){return timeline}})}catch(e){}try{window.document.timeline=timeline}catch(e){}})(webAnimationsShared,webAnimationsNext,webAnimationsTesting);