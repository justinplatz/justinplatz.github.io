(function(shared,scope,testing){var nullTarget=document.createElementNS("http://www.w3.org/1999/xhtml","div"),sequenceNumber=0;scope.bindAnimationForCustomEffect=function(animation){var target=animation.effect.target,effectFunction,isKeyframeEffect="function"==typeof animation.effect.getFrames();if(isKeyframeEffect){effectFunction=animation.effect.getFrames()}else{effectFunction=animation.effect._onsample}var timing=animation.effect.timing,last=null;timing=shared.normalizeTimingInput(timing);var callback=function(){var t=callback._animation?callback._animation.currentTime:null;if(null!==t){t=shared.calculateIterationProgress(shared.calculateActiveDuration(timing),t,timing);if(isNaN(t))t=null}if(t!==last){if(isKeyframeEffect){effectFunction(t,target,animation.effect)}else{effectFunction(t,animation.effect,animation.effect._animation)}}last=t};callback._animation=animation;callback._registered=!1;callback._sequenceNumber=sequenceNumber++;animation._callback=callback;register(callback)};var callbacks=[],ticking=!1;function register(callback){if(callback._registered)return;callback._registered=!0;callbacks.push(callback);if(!ticking){ticking=!0;requestAnimationFrame(tick)}}function tick(t){var updating=callbacks;callbacks=[];updating.sort(function(left,right){return left._sequenceNumber-right._sequenceNumber});updating=updating.filter(function(callback){callback();var playState=callback._animation?callback._animation.playState:"idle";if("running"!=playState&&"pending"!=playState)callback._registered=!1;return callback._registered});callbacks.push.apply(callbacks,updating);if(callbacks.length){ticking=!0;requestAnimationFrame(tick)}else{ticking=!1}}scope.Animation.prototype._register=function(){if(this._callback)register(this._callback)}})(webAnimationsShared,webAnimationsNext,webAnimationsTesting);