"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const formatting_1=require("./formatting"),index_1=require("./index");class Document{constructor(data){this.kind="document";this.path=data.path;this.members=data.members||[];this.referencePaths=new Set(Array.from(data.referencePaths||[]));this.header=data.header||"";this.isEsModule=data.isEsModule||!1;this.tsLintDisables=data.tsLintDisables}*traverse(){for(const m of this.members){yield*m.traverse()}yield this}simplify(){for(const node of this.traverse()){if("union"===node.kind){node.simplify()}}}serialize(){let out="";if(this.header){out+=formatting_1.formatComment(this.header,0)+"\n"}const disables=this.tsLintDisables.slice();for(const node of this.traverse()){if("name"===node.kind&&"any"===node.name){disables.push({ruleName:"no-any",why:"describes the API as best we are able today"});break}}out+="\n";for(const disable of disables){out+=`// tslint:disable:${disable.ruleName} ${disable.why}\n`}out+="\n";if(0<this.referencePaths.size){for(const ref of this.referencePaths){out+=`/// <reference path="${ref}" />\n`}out+="\n"}out+=this.members.map(m=>m.serialize()).join("\n");if(!0===this.isEsModule&&!this.members.some(m=>"import"===m.kind||"export"===m.kind)){out+="\n"+new index_1.Export({identifiers:[]}).serialize()}return out}}exports.Document=Document;