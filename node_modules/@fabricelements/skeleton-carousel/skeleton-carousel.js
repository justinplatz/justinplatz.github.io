define(["../../@polymer/polymer/polymer-element.js","../../@polymer/iron-a11y-keys-behavior/iron-a11y-keys-behavior.js","../../@polymer/iron-flex-layout/iron-flex-layout.js","../../@polymer/iron-selector/iron-selector.js","../../@polymer/paper-icon-button/paper-icon-button.js","../../@polymer/iron-icons/iron-icons.js","../../@polymer/polymer/lib/utils/flattened-nodes-observer.js","../../@polymer/polymer/lib/legacy/class.js","../../@polymer/polymer/lib/mixins/gesture-event-listeners.js","../../@polymer/polymer/lib/utils/gestures.js"],function(_polymerElement,_ironA11yKeysBehavior,_ironFlexLayout,_ironSelector,_paperIconButton,_ironIcons,_flattenedNodesObserver,_class,_gestureEventListeners,Gestures){"use strict";Gestures=babelHelpers.interopRequireWildcard(Gestures);class SkeletonCarousel extends(0,_class.mixinBehaviors)([_ironA11yKeysBehavior.IronA11yKeysBehavior,_gestureEventListeners.GestureEventListeners],_polymerElement.PolymerElement){static get template(){return _polymerElement.html`
    <!--suppress CssInvalidPseudoSelector -->
    <!--suppress CssUnresolvedCustomProperty -->
    <!--suppress CssUnresolvedCustomPropertySet -->
    <style>
      :host {
        display: block;
        position: relative;
        overflow: hidden;
        contain: content;
        box-sizing: border-box;
        @apply --layout-flex-auto;
        @apply --skeleton-carousel;
        min-height: var(--skeleton-carousel-min-height, 300px);
      }

      :host([direction="horizontal"]) {
        @apply --layout-vertical;
      }

      :host([alt][direction="horizontal"]) {
        @apply --layout-vertical-reverse;
      }

      :host([direction="vertical"]) {
        @apply --layout-inline;
        @apply --layout-horizontal;
      }

      :host([alt][direction="vertical"]) {
        @apply --layout-horizontal-reverse;
      }

      :host,
      #carousel *,
      #container ::slotted(*) {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        outline: none;
        -webkit-tap-highlight-color: rgba(255, 255, 255, 0);
      }

      #carousel,
      #items,
      #container {
        display: block;
        position: relative;
        width: 100%;
        @apply --layout-flex-auto;
      }

      #carousel,
      #container {
        @apply --layout-vertical;
      }

      #carousel {
        overflow: hidden;
        z-index: 0;
      }

      #items {
        position: relative;
        transform: translate3d(0%, 0%, 0);
        will-change: transform;
      }

      :host([direction="horizontal"]) #items {
        @apply --layout-vertical;
      }

      :host([direction="vertical"]) #items {
        @apply --layout-fit;
      }

      #container {
        @apply --layout-inline;
        @apply --skeleton-carousel-container;
      }

      :host([direction="horizontal"]) #container {
        @apply --layout-horizontal;
        @apply --skeleton-carousel-container-horizontal;
      }

      :host([direction="vertical"]) #container {
        @apply --layout-vertical;
        @apply --layout-wrap;
        @apply --skeleton-carousel-container-vertical;
      }

      #container ::slotted(*) {
        display: block;
        position: relative;
        overflow: hidden;
        @apply --layout-vertical;
        @apply --layout-flex-auto;
        min-width: 100%;
        max-width: 100%;
        width: 100%;
        will-change: auto;
        opacity: .8;
        @apply --skeleton-carousel-item;
      }

      #container ::slotted(.selected) {
        opacity: 1;
        @apply --skeleton-carousel-item-selected;
      }

      /*
      * Controls
      */
      #controls {
        display: block;
        padding: .5rem;
        z-index: 1;
        @apply --layout-center-center;
        @apply --layout-center-justified;
        @apply --skeleton-carousel-controls;
      }

      :host([direction="horizontal"]) #controls {
        @apply --skeleton-carousel-controls-horizontal;
      }

      :host([direction="vertical"]) #controls {
        @apply --skeleton-carousel-controls-vertical;
      }

      :host([direction="horizontal"]) #controls,
      :host([direction="horizontal"]) #dots {
        @apply --layout-horizontal;
      }

      :host([direction="vertical"]) #controls,
      :host([direction="vertical"]) #dots {
        @apply --layout-vertical;
      }

      paper-icon-button {
        border-radius: 50%;
      }

      #dots {
        @apply --layout-flex-auto;
        @apply --layout-center-center;
        @apply --skeleton-carousel-dots;
      }

      #dots paper-icon-button {
        color: var(--skeleton-carousel-dot-color, var(--paper-grey-900));
        opacity: .4;
        @apply --skeleton-carousel-dot;
      }

      #dots paper-icon-button.selected {
        opacity: 1;
        @apply --skeleton-carousel-dot-selected;
      }

      #dots paper-icon-button[disabled] {
        opacity: .4;
        @apply --skeleton-carousel-dot-disabled;
      }

      #prev,
      #next {
        color: var(--skeleton-carousel-nav-color, var(--paper-grey-900));
      }

      #prev,
      #next {
        @apply --skeleton-carousel-nav;
      }

      #prev[disabled],
      #next[disabled] {
        color: var(--skeleton-carousel-nav-disabled-color, var(--paper-grey-600));
        @apply --skeleton-carousel-nav-disabled;
      }

      #prev {
        @apply --skeleton-carousel-nav-prev;
      }

      #next {
        @apply --skeleton-carousel-nav-next;
      }

      [hidden] {
        display: none !important;
      }

      /* Apply transition */
      #items,
      #container ::slotted(*),
      paper-icon-button {
        -webkit-transition: all 300ms cubic-bezier(.51, .92, .24, 1);
        -moz-transition: all 300ms cubic-bezier(.51, .92, .24, 1);
        -ms-transition: all 300ms cubic-bezier(.51, .92, .24, 1);
        -o-transition: all 300ms cubic-bezier(.51, .92, .24, 1);
        transition: all 300ms cubic-bezier(.51, .92, .24, 1);
        @apply --skeleton-carousel-transition;
      }

      :host[swiping] #items {
        -webkit-transition: all 300ms linear;
        -moz-transition: all 300ms linear;
        -ms-transition: all 300ms linear;
        -o-transition: all 300ms linear;
        transition: all 300ms linear;
      }
    </style>

    <div id="carousel">
      <div id="items">
        <iron-selector id="container" selected="{{selected}}" fallback-selection="0" selected-class="selected" style$="[[_containerHeight]]">
          <slot></slot>
        </iron-selector>
      </div>
    </div>
    <nav id="controls" hidden$="[[!_controls]]">
      <paper-icon-button icon$="[[_iconPrev]]" id="prev" on-tap="prev" disabled$="[[!showPrev]]" hidden$="[[!nav]]"></paper-icon-button>
      <iron-selector id="dots" selected="{{selected}}" fallback-selection="0" selected-class="selected" hidden$="[[!dots]]" tabindex="-1">
        <template is="dom-repeat" items="[[_dots]]">
          <paper-icon-button icon="[[_iconDot(item, selected)]]" disabled$="[[disabled]]"></paper-icon-button>
        </template>
      </iron-selector>
      <paper-icon-button icon$="[[_iconNext]]" id="next" on-tap="next" disabled$="[[!showNext]]" hidden$="[[!nav]]"></paper-icon-button>
    </nav>
`}static get is(){return"skeleton-carousel"}static get properties(){return{animating:{type:Boolean,value:!1,readOnly:!0,reflectToAttribute:!0,notify:!0},auto:{type:Boolean,value:!1,observer:"_autoAnimate"},direction:{type:String,value:"horizontal",reflectToAttribute:!0},disabled:{type:Boolean,value:!1},dots:{type:Boolean,value:!1},disableSwipe:{type:Boolean,value:!1},disableKeys:{type:Boolean,value:!1},duration:{type:Number,value:4e3},loop:{type:Boolean,value:!1},nav:{type:Boolean,value:!1},selected:{type:Number,value:0,notify:!0,reflectToAttribute:!0,observer:"_selectedObserver"},selectedItem:{type:Object,notify:!0,readOnly:!0,computed:"_computeSelectedItem(selected, _children)"},swiping:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},tabindex:{type:Number,value:0,reflectToAttribute:!0},total:{type:Number,value:0,notify:!0,reflectToAttribute:!0,readOnly:!0},end:{type:Boolean,value:!1,notify:!0,readOny:!0,reflectToAttribute:!0,computed:"_computeEnd(total, selected)"},showNext:{type:Boolean,value:!1,computed:"_computeShowNext(disabled, total, selected, loop)",notify:!0,reflectToAttribute:!0,readOnly:!0},showPrev:{type:Boolean,value:!1,computed:"_computeShowPrev(disabled, selected, loop)",notify:!0,reflectToAttribute:!0,readOnly:!0},_autoInterval:{type:Object},_children:{type:Array,value:[],observer:"_childrenObserver"},_controls:{type:Boolean,value:!1,readOnly:!0,computed:"_computeControls(dots, nav, total)"},_dots:{type:Array,computed:"_computeDots(total)",readOnly:!0,value:[]},_iconPrev:{type:String,value:"icons:arrow-back",readOnly:!0,computed:"_computeIconPrev(direction)"},_iconNext:{type:String,value:"icons:arrow-forward",readOnly:!0,computed:"_computeIconNext(direction)"},_containerHeight:{type:String,value:"height: 100%;",computed:"_computeContainerHeight(direction, total)",readOnly:!0},_x:{type:Number,value:0},_y:{type:Number,value:0}}}connectedCallback(){super.connectedCallback();const container=this.shadowRoot.querySelector("slot"),carousel=this.shadowRoot.querySelector("#carousel");Gestures.addListener(carousel,"track",this._drag.bind(this));this.setScrollDirection("all",carousel);new _flattenedNodesObserver.FlattenedNodesObserver(container,()=>{this._children=_flattenedNodesObserver.FlattenedNodesObserver.getFlattenedNodes(this).filter(n=>n.nodeType===Node.ELEMENT_NODE&&"DOM-REPEAT"!==n.nodeName&&"TEMPLATE"!==n.nodeName)});const items=this.shadowRoot.querySelector("#items");items.addEventListener("transitionend",e=>{e.preventDefault();if(this.swiping||"transform"!==e.propertyName){return}this._setAnimating(!1)})}static get observers(){return["_translateObserver(direction, selected, _x, _y)"]}get keyBindings(){return{"left up":"_prevKey","right down":"_nextKey"}}_computeSelectedItem(selected,children){return children[selected]}_childrenObserver(children){this._setTotal(children.length);this._lazyContent(0);if(1<=children.length)this._lazyContent(1)}_prevKey(event){if(this.disableKeys||this.disabled)return;event.preventDefault();return this.prev()}_nextKey(event){if(this.disableKeys||this.disabled)return;event.preventDefault();return this.next()}_autoAnimate(auto){if(auto){this._autoInterval=setInterval(()=>{this.next()},this.duration)}else{clearInterval(this._autoInterval)}}next(){if(this.disabled)return;const element=this.shadowRoot.querySelector("#container");let total=this.total;if(this.selected<--total||this.loop){this._setAnimating(!0);element.selectNext()}}prev(){if(this.disabled)return;const element=this.shadowRoot.querySelector("#container");if(0<this.selected||this.loop){this._setAnimating(!0);element.selectPrevious()}}_iconDot(item,selected){item--;let icon="icons:radio-button-unchecked";if(+item===+selected)icon="icons:radio-button-checked";return icon}_selectedObserver(newValue,oldValue){this._lazyContent(newValue);let total=this.total;if(newValue<--total){this._lazyContent(++newValue)}this._autoAnimate(!1);this._autoAnimate(this.auto)}_lazyContent(selected){const child=this._children[selected];if(!child)return;if(child.hasAttribute("data-src")){child.src=child.getAttribute("data-src");child.removeAttribute("data-src")}const content=child.querySelectorAll("[data-src]");if(0>=content.length)return;let i=0;for(i;i<content.length;++i){content[i].src=content[i].getAttribute("data-src");content[i].removeAttribute("data-src")}}_computeShowNext(disabled,total,selected,loop){if(disabled)return!1;if(loop)return!0;return selected<--total}_computeShowPrev(disabled,selected,loop){if(disabled)return!1;if(loop)return!0;return 0<selected}_computeDots(total){let array=[];if(0>=total)return array;let i=1;total=++total;for(i;i<total;++i){array.push(i)}return array}_computeEnd(total,selected){const status=selected===--total;if(status)this._event("end");return status}_normalize(value){if(0>value){value=0}else if(1<value){value=1}return value}_calcPercentage(value){value=value.toFixed(2);return`${100*value}%`}_drag(event){if(this.disableSwipe||this.disabled){this._x=0;this._y=0;this._setSwiping(!1);return}const width=this.offsetWidth,height=this.offsetHeight,x=event.detail.ddx?event.detail.ddx:0,y=event.detail.ddy?event.detail.ddy:0;let finalX=x/width,finalY=y/height,finalLeft=0,finalTop=0;if("horizontal"===this.direction)finalLeft=this._x+finalX;if("vertical"===this.direction)finalTop=this._y+finalY;let finalPositionLeft=+finalLeft,finalPositionTop=+finalTop;if(!this.showPrev){if(0<finalPositionLeft){finalPositionLeft=0}if(0<finalPositionTop){finalPositionTop=0}}if(!this.showNext){if(0>finalPositionLeft){finalPositionLeft=0}if(0>finalPositionTop){finalPositionTop=0}}switch(event.detail.state){case"track":this._autoAnimate(!1);this._x=finalPositionLeft;this._y=finalPositionTop;this._setSwiping(!0);break;case"end":this._autoAnimate(this.auto);this._x=0;this._y=0;this._setSwiping(!1);if(.1<=finalPositionLeft||.1<=finalPositionTop){this.prev()}else if(-.1>=finalPositionLeft||-.1>=finalPositionTop){this.next()}break;}}_computeIconPrev(direction){if("vertical"===direction)return"icons:arrow-upward";return"icons:arrow-back"}_computeIconNext(direction){if("vertical"===direction)return"icons:arrow-downward";return"icons:arrow-forward"}_translateObserver(direction,selected,_x,_y){if(0!==_x||0!==_y){this._setAnimating(!0)}let finalX=0,finalY=0,baseSelected=-Math.abs(selected);if(0>=selected)baseSelected=0;if(0===_x&&0===_y){const percentage=this._calcPercentage(baseSelected);if("horizontal"===direction)finalX=percentage;if("vertical"===direction)finalY=percentage}else{_x=baseSelected+_x;_y=baseSelected+_y;if("horizontal"===direction){finalX=this._calcPercentage(_x)}if("vertical"===direction){finalY=this._calcPercentage(_y)}}const element=this.shadowRoot.querySelector("#items");let transform="";if("horizontal"===direction){transform=`translateX(${finalX})`}if("vertical"===direction){transform=`translateY(${finalY})`}element.style.transform=transform}_returnDragPosition(position,selected){return position-selected}_computeContainerHeight(direction,total){let height="auto";if("vertical"===direction)height=this._calcPercentage(total);return`height: ${height};`}_computeControls(dots,nav,total){return 1<total&&(dots||nav)}_event(name,detail=""){this.dispatchEvent(new CustomEvent(name,{detail:detail,bubbles:!0,composed:!0}))}}window.customElements.define("skeleton-carousel",SkeletonCarousel)});