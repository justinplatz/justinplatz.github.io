(function(shared,scope,testing){var _Mathmax=Math.max;function groupChildDuration(node){return node._timing.delay+node.activeDuration+node._timing.endDelay}function constructor(children,timingInput,id){this._id=id;this._parent=null;this.children=children||[];this._reparent(this.children);timingInput=shared.numericTimingToObject(timingInput);this._timingInput=shared.cloneTimingInput(timingInput);this._timing=shared.normalizeTimingInput(timingInput,!0);this.timing=shared.makeTiming(timingInput,!0,this);this.timing._effect=this;if("auto"===this._timing.duration){this._timing.duration=this.activeDuration}}window.SequenceEffect=function(){constructor.apply(this,arguments)};window.GroupEffect=function(){constructor.apply(this,arguments)};constructor.prototype={_isAncestor:function(effect){var a=this;while(null!==a){if(a==effect)return!0;a=a._parent}return!1},_rebuild:function(){var node=this;while(node){if("auto"===node.timing.duration){node._timing.duration=node.activeDuration}node=node._parent}if(this._animation){this._animation._rebuildUnderlyingAnimation()}},_reparent:function(newChildren){scope.removeMulti(newChildren);for(var i=0;i<newChildren.length;i++){newChildren[i]._parent=this}},_putChild:function(args,isAppend){for(var message=isAppend?"Cannot append an ancestor or self":"Cannot prepend an ancestor or self",i=0;i<args.length;i++){if(this._isAncestor(args[i])){throw{type:DOMException.HIERARCHY_REQUEST_ERR,name:"HierarchyRequestError",message:message}}}for(var oldParents=[],i=0;i<args.length;i++){isAppend?this.children.push(args[i]):this.children.unshift(args[i])}this._reparent(args);this._rebuild()},append:function(){this._putChild(arguments,!0)},prepend:function(){this._putChild(arguments,!1)},get parent(){return this._parent},get firstChild(){return this.children.length?this.children[0]:null},get lastChild(){return this.children.length?this.children[this.children.length-1]:null},clone:function(){for(var clonedTiming=shared.cloneTimingInput(this._timingInput),clonedChildren=[],i=0;i<this.children.length;i++){clonedChildren.push(this.children[i].clone())}return this instanceof GroupEffect?new GroupEffect(clonedChildren,clonedTiming):new SequenceEffect(clonedChildren,clonedTiming)},remove:function(){scope.removeMulti([this])}};window.SequenceEffect.prototype=Object.create(constructor.prototype);Object.defineProperty(window.SequenceEffect.prototype,"activeDuration",{get:function(){var total=0;this.children.forEach(function(child){total+=groupChildDuration(child)});return _Mathmax(total,0)}});window.GroupEffect.prototype=Object.create(constructor.prototype);Object.defineProperty(window.GroupEffect.prototype,"activeDuration",{get:function(){var max=0;this.children.forEach(function(child){max=_Mathmax(max,groupChildDuration(child))});return max}});scope.newUnderlyingAnimationForGroup=function(group){var underlyingAnimation,timing=null,ticker=function(tf){var animation=underlyingAnimation._wrapper;if(!animation){return}if("pending"==animation.playState){return}if(!animation.effect){return}if(null==tf){animation._removeChildAnimations();return}if(0==tf&&0>animation.playbackRate){if(!timing){timing=shared.normalizeTimingInput(animation.effect.timing)}tf=shared.calculateIterationProgress(shared.calculateActiveDuration(timing),-1,timing);if(isNaN(tf)||null==tf){animation._forEachChild(function(child){child.currentTime=-1});animation._removeChildAnimations();return}}},underlyingEffect=new KeyframeEffect(null,[],group._timing,group._id);underlyingEffect.onsample=ticker;underlyingAnimation=scope.timeline._play(underlyingEffect);return underlyingAnimation};scope.bindAnimationForGroup=function(animation){animation._animation._wrapper=animation;animation._isGroup=!0;scope.awaitStartTime(animation);animation._constructChildAnimations();animation._setExternalAnimation(animation)};scope.groupChildDuration=groupChildDuration})(webAnimationsShared,webAnimationsNext,webAnimationsTesting);