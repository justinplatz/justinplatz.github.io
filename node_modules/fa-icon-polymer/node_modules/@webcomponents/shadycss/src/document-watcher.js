define(["exports","./style-settings.js","./style-transformer.js","./style-util.js"],function(_exports,_styleSettings,_styleTransformer,_styleUtil){'use strict';Object.defineProperty(_exports,"__esModule",{value:!0});_exports.flush=void 0;_styleTransformer=babelHelpers.interopRequireDefault(_styleTransformer);let flush=function(){};_exports.flush=flush;function getClasses(element){let classes=[];if(element.classList){classes=Array.from(element.classList)}else if(element instanceof window.SVGElement&&element.hasAttribute("class")){classes=element.getAttribute("class").split(/\s+/)}return classes}function getCurrentScope(element){let classes=getClasses(element),idx=classes.indexOf(_styleTransformer.default.SCOPE_NAME);if(-1<idx){return classes[idx+1]}return""}function handler(mxns){for(let x=0,mxn;x<mxns.length;x++){mxn=mxns[x];if(mxn.target===document.documentElement||mxn.target===document.head){continue}for(let i=0,n;i<mxn.addedNodes.length;i++){n=mxn.addedNodes[i];if(n.nodeType!==Node.ELEMENT_NODE){continue}n=n;let root=n.getRootNode(),currentScope=getCurrentScope(n);if(currentScope&&root===n.ownerDocument){_styleTransformer.default.dom(n,currentScope,!0)}else if(root.nodeType===Node.DOCUMENT_FRAGMENT_NODE){let newScope,host=root.host;if(!host){continue}newScope=(0,_styleUtil.getIsExtends)(host).is;if(currentScope===newScope){let unscoped=window.ShadyDOM.nativeMethods.querySelectorAll.call(n,`:not(.${_styleTransformer.default.SCOPE_NAME})`);for(let j=0;j<unscoped.length;j++){_styleTransformer.default.element(unscoped[j],currentScope)}continue}if(currentScope){_styleTransformer.default.dom(n,currentScope,!0)}_styleTransformer.default.dom(n,newScope)}}}}if(!_styleSettings.nativeShadow){let observer=new MutationObserver(handler),start=node=>{observer.observe(node,{childList:!0,subtree:!0})},nativeCustomElements=window.customElements&&!window.customElements.polyfillWrapFlushCallback;if(nativeCustomElements){start(document)}else{let delayedStart=()=>{start(document.body)};if(window.HTMLImports){window.HTMLImports.whenReady(delayedStart)}else{requestAnimationFrame(function(){if("loading"===document.readyState){let listener=function(){delayedStart();document.removeEventListener("readystatechange",listener)};document.addEventListener("readystatechange",listener)}else{delayedStart()}})}}_exports.flush=flush=function(){handler(observer.takeRecords())}}});