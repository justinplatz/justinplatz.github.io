<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,user-scalable=yes"><script>WCT={waitFor:function(cb){HTMLImports.whenReady(cb)}};</script><script src="./test-flags.js"></script><script src="../../web-component-tester/browser.js"></script><script src="../../webcomponents-platform/webcomponents-platform.js"></script><script src="../../es6-promise/dist/es6-promise.auto.min.js"></script><script src="../../template/template.js"></script><script src="../../html-imports/html-imports.min.js"></script><script src="../../shadydom/shadydom.min.js"></script><script src="../../custom-elements/custom-elements.min.js"></script><script src="../scoping-shim.min.js"></script><script src="../apply-shim.min.js"></script><script src="../custom-style-interface.min.js"></script><script src="module/generated/make-element.js"></script></head><body><style>x-container, x-sample{display:block;padding:10px;margin:10px;border:1px solid black;}.target{background-color:rgb(0, 255, 0);}</style><template id="x-sample"><style>.target{background-color:rgb(255, 0, 0);}</style><h2></h2><p>here .target elements are red</p><div class="target">I'm red</div><template id="renderer"><div class="target"></div></template></template><template id="x-container"><style>.target{background-color:rgb(123, 123, 123);}</style><h1>x-container</h1><p>here .target elements are gray</p><div class="target">I'm gray</div><slot></slot></template><h2>body</h2><p>here .target elements are green</p><div class="target">I'm green</div><x-sample id="inBody"></x-sample><x-sample id="inContainer"></x-sample><x-container></x-container><template id="x-dynamic"><style>span{background-color:rgb(123, 123, 123);}</style><div id="container"></div></template><x-dynamic></x-dynamic><script>suite("Dynamic Scoping",()=>{function stamp(parent,host){let template=host.shadowRoot.querySelector("template#renderer"),el=template.content.cloneNode(!0).querySelector("div.target");el.textContent=`stamped by ${host.id}`;parent.appendChild(el);return el}test("DOM is scoped correctly when stamped from an element into document",done=>{let inBody=document.querySelector("x-sample#inBody"),inContainer=document.querySelector("x-sample#inContainer");makeElement("x-sample",function(){this.shadowRoot.querySelector("h2").textContent=`${this.id}`});makeElement("x-container");setTimeout(()=>{let body=stamp(document.body,inBody),container=stamp(document.querySelector("x-container").shadowRoot,inContainer);requestAnimationFrame(()=>{assert.equal(getComputedStyle(body).backgroundColor,"rgb(0, 255, 0)");assert.equal(getComputedStyle(container).backgroundColor,"rgb(123, 123, 123)");done()})},300)});test("DOM is scoped correctly when created dynamically inside a scoped container",done=>{makeElement("x-dynamic",function(){let div=this.shadowRoot.querySelector("#container"),newDiv=div.cloneNode(!0),span=document.createElement("span");span.textContent="created dynamically";newDiv.appendChild(span);this.shadowRoot.appendChild(newDiv);requestAnimationFrame(()=>{assert.equal(getComputedStyle(span).backgroundColor,"rgb(123, 123, 123)");done()})})})});</script></body></html>