(function(sinonGlobal){"use strict";function makeApi(sinon){var push=[].push;function exposeValue(sandbox,config,key,value){if(!value){return}if(config.injectInto&&!(key in config.injectInto)){config.injectInto[key]=value;sandbox.injectedKeys.push(key)}else{push.call(sandbox.args,value)}}function prepareSandboxFromConfig(config){var sandbox=sinon.create(sinon.sandbox);if(config.useFakeServer){if("object"===typeof config.useFakeServer){sandbox.serverPrototype=config.useFakeServer}sandbox.useFakeServer()}if(config.useFakeTimers){if("object"===typeof config.useFakeTimers){sandbox.useFakeTimers.apply(sandbox,config.useFakeTimers)}else{sandbox.useFakeTimers()}}return sandbox}sinon.sandbox=sinon.extend(sinon.create(sinon.collection),{useFakeTimers:function useFakeTimers(){this.clock=sinon.useFakeTimers.apply(sinon,arguments);return this.add(this.clock)},serverPrototype:sinon.fakeServer,useFakeServer:function useFakeServer(){var proto=this.serverPrototype||sinon.fakeServer;if(!proto||!proto.create){return null}this.server=proto.create();return this.add(this.server)},inject:function(obj){sinon.collection.inject.call(this,obj);if(this.clock){obj.clock=this.clock}if(this.server){obj.server=this.server;obj.requests=this.server.requests}obj.match=sinon.match;return obj},restore:function(){if(arguments.length){throw new Error("sandbox.restore() does not take any parameters. Perhaps you meant stub.restore()")}sinon.collection.restore.apply(this,arguments);this.restoreContext()},restoreContext:function(){if(this.injectedKeys){for(var i=0,j=this.injectedKeys.length;i<j;i++){delete this.injectInto[this.injectedKeys[i]]}this.injectedKeys=[]}},create:function(config){if(!config){return sinon.create(sinon.sandbox)}var sandbox=prepareSandboxFromConfig(config);sandbox.args=sandbox.args||[];sandbox.injectedKeys=[];sandbox.injectInto=config.injectInto;var prop,value,exposed=sandbox.inject({});if(config.properties){for(var i=0,l=config.properties.length;i<l;i++){prop=config.properties[i];value=exposed[prop]||"sandbox"===prop&&sandbox;exposeValue(sandbox,config,prop,value)}}else{exposeValue(sandbox,config,"sandbox",value)}return sandbox},match:sinon.match});sinon.sandbox.useFakeXMLHttpRequest=sinon.sandbox.useFakeServer;return sinon.sandbox}var isNode="undefined"!==typeof module&&module.exports&&"function"===typeof require,isAMD="function"===typeof define&&"object"===typeof define.amd&&define.amd;function loadDependencies(require,exports,module){var sinon=require("./util/core");require("./extend");require("./util/fake_server_with_clock");require("./util/fake_timers");require("./collection");module.exports=makeApi(sinon)}if(isAMD){define(loadDependencies);return}if(isNode){loadDependencies(require,module.exports,module);return}if(sinonGlobal){makeApi(sinonGlobal)}})("object"===typeof sinon&&sinon);