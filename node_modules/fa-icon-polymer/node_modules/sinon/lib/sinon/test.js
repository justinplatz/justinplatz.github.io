(function(sinonGlobal){"use strict";function makeApi(sinon){var slice=Array.prototype.slice;function test(callback){var type=typeof callback;if("function"!==type){throw new TypeError("sinon.test needs to wrap a test function, got "+type)}function sinonSandboxedTest(){var config=sinon.getConfig(sinon.config);config.injectInto=config.injectIntoThis&&this||config.injectInto;var sandbox=sinon.sandbox.create(config),args=slice.call(arguments),oldDone=args.length&&args[args.length-1],exception,result;if("function"===typeof oldDone){args[args.length-1]=function sinonDone(res){if(res){sandbox.restore()}else{sandbox.verifyAndRestore()}oldDone(res)}}try{result=callback.apply(this,args.concat(sandbox.args))}catch(e){exception=e}if("undefined"!==typeof exception){sandbox.restore();throw exception}else if("function"!==typeof oldDone){sandbox.verifyAndRestore()}return result}if(callback.length){return function sinonAsyncSandboxedTest(done){return sinonSandboxedTest.apply(this,arguments)}}return sinonSandboxedTest}test.config={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0};sinon.test=test;return test}var isNode="undefined"!==typeof module&&module.exports&&"function"===typeof require,isAMD="function"===typeof define&&"object"===typeof define.amd&&define.amd;function loadDependencies(require,exports,module){var core=require("./util/core");require("./sandbox");module.exports=makeApi(core)}if(isAMD){define(loadDependencies)}else if(isNode){loadDependencies(require,module.exports,module)}else if(sinonGlobal){makeApi(sinonGlobal)}})("object"===typeof sinon&&sinon||null);