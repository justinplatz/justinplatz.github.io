(function(sinonGlobal){"use strict";var div="undefined"!==typeof document&&document.createElement("div"),hasOwn=Object.prototype.hasOwnProperty;function isDOMNode(obj){var success=!1;try{obj.appendChild(div);success=div.parentNode===obj}catch(e){return!1}finally{try{obj.removeChild(div)}catch(e){}}return success}function isElement(obj){return div&&obj&&1===obj.nodeType&&isDOMNode(obj)}function isFunction(obj){return"function"===typeof obj||!!(obj&&obj.constructor&&obj.call&&obj.apply)}function isReallyNaN(val){return"number"===typeof val&&isNaN(val)}function mirrorProperties(target,source){for(var prop in source){if(!hasOwn.call(target,prop)){target[prop]=source[prop]}}}function isRestorable(obj){return"function"===typeof obj&&"function"===typeof obj.restore&&obj.restore.sinon}var hasES5Support="keys"in Object;function makeApi(sinon){sinon.wrapMethod=function wrapMethod(object,property,method){if(!object){throw new TypeError("Should wrap property of object")}if("function"!==typeof method&&"object"!==typeof method){throw new TypeError("Method wrapper should be a function or a property descriptor")}function checkWrappedMethod(wrappedMethod){var error;if(!isFunction(wrappedMethod)){error=new TypeError("Attempted to wrap "+typeof wrappedMethod+" property "+property+" as function")}else if(wrappedMethod.restore&&wrappedMethod.restore.sinon){error=new TypeError("Attempted to wrap "+property+" which is already wrapped")}else if(wrappedMethod.calledBefore){var verb=wrappedMethod.returns?"stubbed":"spied on";error=new TypeError("Attempted to wrap "+property+" which is already "+verb)}if(error){if(wrappedMethod&&wrappedMethod.stackTrace){error.stack+="\n--------------\n"+wrappedMethod.stackTrace}throw error}}var error,wrappedMethod,i;function simplePropertyAssignment(){wrappedMethod=object[property];checkWrappedMethod(wrappedMethod);object[property]=method;method.displayName=property}var owned=object.hasOwnProperty&&object.hasOwnProperty===hasOwn?object.hasOwnProperty(property):hasOwn.call(object,property);if(hasES5Support){var methodDesc="function"===typeof method?{value:method}:method,wrappedMethodDesc=sinon.getPropertyDescriptor(object,property);if(!wrappedMethodDesc){error=new TypeError("Attempted to wrap "+typeof wrappedMethod+" property "+property+" as function")}else if(wrappedMethodDesc.restore&&wrappedMethodDesc.restore.sinon){error=new TypeError("Attempted to wrap "+property+" which is already wrapped")}if(error){if(wrappedMethodDesc&&wrappedMethodDesc.stackTrace){error.stack+="\n--------------\n"+wrappedMethodDesc.stackTrace}throw error}var types=sinon.objectKeys(methodDesc);for(i=0;i<types.length;i++){wrappedMethod=wrappedMethodDesc[types[i]];checkWrappedMethod(wrappedMethod)}mirrorProperties(methodDesc,wrappedMethodDesc);for(i=0;i<types.length;i++){mirrorProperties(methodDesc[types[i]],wrappedMethodDesc[types[i]])}Object.defineProperty(object,property,methodDesc);if("function"===typeof method&&object[property]!==method){delete object[property];simplePropertyAssignment()}}else{simplePropertyAssignment()}method.displayName=property;method.stackTrace=new Error("Stack Trace for original").stack;method.restore=function(){if(!owned){try{delete object[property]}catch(e){}}else if(hasES5Support){Object.defineProperty(object,property,wrappedMethodDesc)}if(hasES5Support){var checkDesc=sinon.getPropertyDescriptor(object,property);if(checkDesc.value===method){object[property]=wrappedMethod}}else if(object[property]===method){object[property]=wrappedMethod}};method.restore.sinon=!0;if(!hasES5Support){mirrorProperties(method,wrappedMethod)}return method};sinon.create=function create(proto){var F=function(){};F.prototype=proto;return new F};sinon.deepEqual=function deepEqual(a,b){if(sinon.match&&sinon.match.isMatcher(a)){return a.test(b)}if("object"!==typeof a||"object"!==typeof b){return isReallyNaN(a)&&isReallyNaN(b)||a===b}if(isElement(a)||isElement(b)){return a===b}if(a===b){return!0}if(null===a&&null!==b||null!==a&&null===b){return!1}if(a instanceof RegExp&&b instanceof RegExp){return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline}var aString=Object.prototype.toString.call(a);if(aString!==Object.prototype.toString.call(b)){return!1}if("[object Date]"===aString){return a.valueOf()===b.valueOf()}var prop,aLength=0,bLength=0;if("[object Array]"===aString&&a.length!==b.length){return!1}for(prop in a){if(hasOwn.call(a,prop)){aLength+=1;if(!(prop in b)){return!1}if(!deepEqual(a[prop],b[prop])){return!1}}}for(prop in b){if(hasOwn.call(b,prop)){bLength+=1}}return aLength===bLength};sinon.functionName=function functionName(func){var name=func.displayName||func.name;if(!name){var matches=func.toString().match(/function ([^\s\(]+)/);name=matches&&matches[1]}return name};sinon.functionToString=function toString(){if(this.getCall&&this.callCount){var thisValue,prop,i=this.callCount;while(i--){thisValue=this.getCall(i).thisValue;for(prop in thisValue){if(thisValue[prop]===this){return prop}}}}return this.displayName||"sinon fake"};sinon.objectKeys=function objectKeys(obj){if(obj!==Object(obj)){throw new TypeError("sinon.objectKeys called on a non-object")}var keys=[],key;for(key in obj){if(hasOwn.call(obj,key)){keys.push(key)}}return keys};sinon.getPropertyDescriptor=function getPropertyDescriptor(object,property){var proto=object,descriptor;while(proto&&!(descriptor=Object.getOwnPropertyDescriptor(proto,property))){proto=Object.getPrototypeOf(proto)}return descriptor};sinon.getConfig=function(custom){var config={};custom=custom||{};var defaults=sinon.defaultConfig;for(var prop in defaults){if(defaults.hasOwnProperty(prop)){config[prop]=custom.hasOwnProperty(prop)?custom[prop]:defaults[prop]}}return config};sinon.defaultConfig={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0};sinon.timesInWords=function timesInWords(count){return 1===count&&"once"||2===count&&"twice"||3===count&&"thrice"||(count||0)+" times"};sinon.calledInOrder=function(spies){for(var i=1,l=spies.length;i<l;i++){if(!spies[i-1].calledBefore(spies[i])||!spies[i].called){return!1}}return!0};sinon.orderByFirstCall=function(spies){return spies.sort(function(a,b){var aCall=a.getCall(0),bCall=b.getCall(0),aId=aCall&&aCall.callId||-1,bId=bCall&&bCall.callId||-1;return aId<bId?-1:1})};sinon.createStubInstance=function(constructor){if("function"!==typeof constructor){throw new TypeError("The constructor should be a function.")}return sinon.stub(sinon.create(constructor.prototype))};sinon.restore=function(object){if(null!==object&&"object"===typeof object){for(var prop in object){if(isRestorable(object[prop])){object[prop].restore()}}}else if(isRestorable(object)){object.restore()}};return sinon}var isNode="undefined"!==typeof module&&module.exports&&"function"===typeof require,isAMD="function"===typeof define&&"object"===typeof define.amd&&define.amd;function loadDependencies(require,exports){makeApi(exports)}if(isAMD){define(loadDependencies);return}if(isNode){loadDependencies(require,module.exports,module);return}if(sinonGlobal){makeApi(sinonGlobal)}})("object"===typeof sinon&&sinon);