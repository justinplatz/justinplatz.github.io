goog.provide("goog.editor.plugins.HeaderFormatterTest");goog.setTestOnly("goog.editor.plugins.HeaderFormatterTest");goog.require("goog.dom");goog.require("goog.editor.Command");goog.require("goog.editor.plugins.BasicTextFormatter");goog.require("goog.editor.plugins.HeaderFormatter");goog.require("goog.events.BrowserEvent");goog.require("goog.testing.LooseMock");goog.require("goog.testing.editor.FieldMock");goog.require("goog.testing.editor.TestHelper");goog.require("goog.testing.jsunit");goog.require("goog.userAgent");var field,editableField,headerFormatter,btf,testHelper;function setUpPage(){field=goog.dom.getElement("field");testHelper=new goog.testing.editor.TestHelper(field)}function setUp(){testHelper.setUpEditableElement();editableField=new goog.testing.editor.FieldMock;headerFormatter=new goog.editor.plugins.HeaderFormatter;headerFormatter.registerFieldObject(editableField);btf=new goog.editor.plugins.BasicTextFormatter;btf.registerFieldObject(editableField)}function tearDown(){editableField=null;headerFormatter.dispose();testHelper.tearDownEditableElement()}function testHeaderShortcuts(){goog.dom.setTextContent(field,"myText");var textNode=field.firstChild;testHelper.select(textNode,0,textNode,textNode.length);editableField.getElement();editableField.$anyTimes();editableField.$returns(field);editableField.getPluginByClassId("Bidi");editableField.$anyTimes();editableField.$returns(null);editableField.execCommand(goog.editor.Command.FORMAT_BLOCK,goog.editor.plugins.HeaderFormatter.HEADER_COMMAND.H1);editableField.$does(function(){btf.execCommandInternal(goog.editor.plugins.BasicTextFormatter.COMMAND.FORMAT_BLOCK,goog.editor.plugins.HeaderFormatter.HEADER_COMMAND.H1)});var event=new goog.testing.LooseMock(goog.events.BrowserEvent);if(goog.userAgent.GECKO){event.stopPropagation()}editableField.$replay();event.$replay();assertTrue("Event handled",headerFormatter.handleKeyboardShortcut(event,"1",!0));assertEquals("Field contains a header","H1",field.firstChild.nodeName);editableField.$verify();event.$verify()}