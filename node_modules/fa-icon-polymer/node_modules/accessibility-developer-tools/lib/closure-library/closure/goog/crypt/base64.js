goog.provide("goog.crypt.base64");goog.require("goog.asserts");goog.require("goog.crypt");goog.require("goog.string");goog.require("goog.userAgent");goog.require("goog.userAgent.product");goog.crypt.base64.byteToCharMap_=null;goog.crypt.base64.charToByteMap_=null;goog.crypt.base64.byteToCharMapWebSafe_=null;goog.crypt.base64.ENCODED_VALS_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"abcdefghijklmnopqrstuvwxyz"+"0123456789";goog.crypt.base64.ENCODED_VALS=goog.crypt.base64.ENCODED_VALS_BASE+"+/=";goog.crypt.base64.ENCODED_VALS_WEBSAFE=goog.crypt.base64.ENCODED_VALS_BASE+"-_.";goog.crypt.base64.ASSUME_NATIVE_SUPPORT_=goog.userAgent.GECKO||goog.userAgent.WEBKIT&&!goog.userAgent.product.SAFARI||goog.userAgent.OPERA;goog.crypt.base64.HAS_NATIVE_ENCODE_=goog.crypt.base64.ASSUME_NATIVE_SUPPORT_||"function"==typeof goog.global.btoa;goog.crypt.base64.HAS_NATIVE_DECODE_=goog.crypt.base64.ASSUME_NATIVE_SUPPORT_||!goog.userAgent.product.SAFARI&&!goog.userAgent.IE&&"function"==typeof goog.global.atob;goog.crypt.base64.encodeByteArray=function(input,opt_webSafe){goog.asserts.assert(goog.isArrayLike(input),"encodeByteArray takes an array as a parameter");goog.crypt.base64.init_();for(var byteToCharMap=opt_webSafe?goog.crypt.base64.byteToCharMapWebSafe_:goog.crypt.base64.byteToCharMap_,output=[],i=0;i<input.length;i+=3){var byte1=input[i],haveByte2=i+1<input.length,byte2=haveByte2?input[i+1]:0,haveByte3=i+2<input.length,byte3=haveByte3?input[i+2]:0,outByte1=byte1>>2,outByte2=(3&byte1)<<4|byte2>>4,outByte3=(15&byte2)<<2|byte3>>6,outByte4=63&byte3;if(!haveByte3){outByte4=64;if(!haveByte2){outByte3=64}}output.push(byteToCharMap[outByte1],byteToCharMap[outByte2],byteToCharMap[outByte3],byteToCharMap[outByte4])}return output.join("")};goog.crypt.base64.encodeString=function(input,opt_webSafe){if(goog.crypt.base64.HAS_NATIVE_ENCODE_&&!opt_webSafe){return goog.global.btoa(input)}return goog.crypt.base64.encodeByteArray(goog.crypt.stringToByteArray(input),opt_webSafe)};goog.crypt.base64.decodeString=function(input,opt_webSafe){if(goog.crypt.base64.HAS_NATIVE_DECODE_&&!opt_webSafe){return goog.global.atob(input)}var output="";function pushByte(b){output+=String.fromCharCode(b)}goog.crypt.base64.decodeStringInternal_(input,pushByte);return output};goog.crypt.base64.decodeStringToByteArray=function(input,opt_ignored){var output=[];function pushByte(b){output.push(b)}goog.crypt.base64.decodeStringInternal_(input,pushByte);return output};goog.crypt.base64.decodeStringToUint8Array=function(input){goog.asserts.assert(!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10"),"Browser does not support typed arrays");var output=new Uint8Array(Math.ceil(3*input.length/4)),outLen=0;function pushByte(b){output[outLen++]=b}goog.crypt.base64.decodeStringInternal_(input,pushByte);return output.subarray(0,outLen)};goog.crypt.base64.decodeStringInternal_=function(input,pushByte){goog.crypt.base64.init_();var nextCharIndex=0;function getByte(default_val){while(nextCharIndex<input.length){var ch=input.charAt(nextCharIndex++),b=goog.crypt.base64.charToByteMap_[ch];if(null!=b){return b}if(!goog.string.isEmptyOrWhitespace(ch)){throw Error("Unknown base64 encoding at char: "+ch)}}return default_val}while(!0){var byte1=getByte(-1),byte2=getByte(0),byte3=getByte(64),byte4=getByte(64);if(64===byte4){if(-1===byte1){return}}var outByte1=byte1<<2|byte2>>4;pushByte(outByte1);if(64!=byte3){var outByte2=240&byte2<<4|byte3>>2;pushByte(outByte2);if(64!=byte4){var outByte3=192&byte3<<6|byte4;pushByte(outByte3)}}}};goog.crypt.base64.init_=function(){if(!goog.crypt.base64.byteToCharMap_){goog.crypt.base64.byteToCharMap_={};goog.crypt.base64.charToByteMap_={};goog.crypt.base64.byteToCharMapWebSafe_={};for(var i=0;i<goog.crypt.base64.ENCODED_VALS.length;i++){goog.crypt.base64.byteToCharMap_[i]=goog.crypt.base64.ENCODED_VALS.charAt(i);goog.crypt.base64.charToByteMap_[goog.crypt.base64.byteToCharMap_[i]]=i;goog.crypt.base64.byteToCharMapWebSafe_[i]=goog.crypt.base64.ENCODED_VALS_WEBSAFE.charAt(i);if(i>=goog.crypt.base64.ENCODED_VALS_BASE.length){goog.crypt.base64.charToByteMap_[goog.crypt.base64.ENCODED_VALS_WEBSAFE.charAt(i)]=i}}}};