goog.provide("goog.async.DelayTest");goog.setTestOnly("goog.async.DelayTest");goog.require("goog.async.Delay");goog.require("goog.testing.MockClock");goog.require("goog.testing.jsunit");var invoked=!1,delay=null,clock=null;function callback(){invoked=!0}function setUp(){clock=new goog.testing.MockClock(!0);invoked=!1;delay=new goog.async.Delay(callback,200)}function tearDown(){clock.dispose();delay.dispose()}function testDelay(){delay.start();assertFalse(invoked);clock.tick(100);assertFalse(invoked);clock.tick(100);assertTrue(invoked)}function testStop(){delay.start();clock.tick(100);assertFalse(invoked);delay.stop();clock.tick(100);assertFalse(invoked)}function testIsActive(){assertFalse(delay.isActive());delay.start();assertTrue(delay.isActive());clock.tick(200);assertFalse(delay.isActive())}function testRestart(){delay.start();clock.tick(100);delay.stop();assertFalse(invoked);delay.start();clock.tick(199);assertFalse(invoked);clock.tick(1);assertTrue(invoked);invoked=!1;delay.start();clock.tick(200);assertTrue(invoked)}function testStartIfNotActive(){delay.startIfNotActive();clock.tick(100);delay.stop();assertFalse(invoked);delay.startIfNotActive();clock.tick(199);assertFalse(invoked);clock.tick(1);assertTrue(invoked);invoked=!1;delay.start();clock.tick(199);assertFalse(invoked);delay.startIfNotActive();clock.tick(1);assertTrue(invoked)}function testOverride(){delay.start(50);clock.tick(49);assertFalse(invoked);clock.tick(1);assertTrue(invoked)}function testDispose(){delay.start();delay.dispose();assertTrue(delay.isDisposed());clock.tick(500);assertFalse(invoked)}function testFire(){delay.start();clock.tick(50);delay.fire();assertTrue(invoked);assertFalse(delay.isActive());invoked=!1;clock.tick(200);assertFalse("Delay fired early with fire call, timeout should have been "+"cleared",invoked)}function testFireIfActive(){delay.fireIfActive();assertFalse(invoked);delay.start();delay.fireIfActive();assertTrue(invoked);invoked=!1;clock.tick(300);assertFalse("Delay fired early with fireIfActive, timeout should have been "+"cleared",invoked)}