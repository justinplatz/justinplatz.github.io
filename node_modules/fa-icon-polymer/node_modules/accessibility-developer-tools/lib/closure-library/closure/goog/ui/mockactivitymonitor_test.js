goog.provide("goog.ui.MockActivityMonitorTest");goog.require("goog.events");goog.require("goog.functions");goog.require("goog.testing.jsunit");goog.require("goog.testing.recordFunction");goog.require("goog.ui.ActivityMonitor");goog.require("goog.ui.MockActivityMonitor");goog.setTestOnly("goog.ui.MockActivityMonitorTest");var googNow=goog.now,monitor,recordedFunction,replacer;function setUp(){monitor=new goog.ui.MockActivityMonitor;recordedFunction=goog.testing.recordFunction();goog.events.listen(monitor,goog.ui.ActivityMonitor.Event.ACTIVITY,recordedFunction)}function tearDown(){goog.dispose(monitor);goog.now=googNow}function testEventFireSameTime(){goog.now=goog.functions.constant(1e3);monitor.simulateEvent();assertEquals(1,recordedFunction.getCallCount());monitor.simulateEvent();assertEquals(2,recordedFunction.getCallCount())}function testEventFireDifferingTime(){goog.now=goog.functions.constant(1e3);monitor.simulateEvent();assertEquals(1,recordedFunction.getCallCount());goog.now=goog.functions.constant(1001);monitor.simulateEvent();assertEquals(2,recordedFunction.getCallCount())}function testDispatchEventReturnValue(){assertTrue(monitor.dispatchEvent(goog.ui.ActivityMonitor.Event.ACTIVITY));assertEquals(1,recordedFunction.getCallCount())}function testDispatchEventPreventDefault(){goog.events.unlisten(monitor,goog.ui.ActivityMonitor.Event.ACTIVITY,recordedFunction);goog.events.listen(monitor,goog.ui.ActivityMonitor.Event.ACTIVITY,function(e){e.preventDefault()});assertFalse(monitor.dispatchEvent(goog.ui.ActivityMonitor.Event.ACTIVITY))}