goog.provide("goog.ui.SelectionMenuButtonTest");goog.setTestOnly("goog.ui.SelectionMenuButtonTest");goog.require("goog.dom");goog.require("goog.events");goog.require("goog.testing.events");goog.require("goog.testing.jsunit");goog.require("goog.ui.Component");goog.require("goog.ui.SelectionMenuButton");var selectionMenuButton,clonedSelectionMenuButtonDom;function setUp(){clonedSelectionMenuButtonDom=goog.dom.getElement("demoSelectionMenuButton").cloneNode(!0);selectionMenuButton=new goog.ui.SelectionMenuButton}function tearDown(){selectionMenuButton.dispose();var element=goog.dom.getElement("demoSelectionMenuButton");element.parentNode.replaceChild(clonedSelectionMenuButtonDom,element)}function testBasicButtonBehavior(){var node=goog.dom.getElement("demoSelectionMenuButton");selectionMenuButton.decorate(node);goog.testing.events.fireClickSequence(node);assertTrue("Menu must open after click",selectionMenuButton.isOpen());var menuItemClicked=0,lastMenuItemClicked=null;goog.events.listen(selectionMenuButton.getMenu(),goog.ui.Component.EventType.ACTION,function(e){menuItemClicked++;lastMenuItemClicked=e.target});var menuItem2=goog.dom.getElement("menuItem2");goog.testing.events.fireClickSequence(menuItem2);assertFalse("Menu must close on clicking when open",selectionMenuButton.isOpen());assertEquals("Number of menu items clicked should be 1",1,menuItemClicked);assertEquals("menuItem2 should be the last menuitem clicked",menuItem2,lastMenuItemClicked.getElement())}function testCheckboxFireEvents(){var node=goog.dom.getElement("demoSelectionMenuButton");selectionMenuButton.decorate(node);var menuItemClicked=0,lastMenuItemClicked=null;goog.events.listen(selectionMenuButton.getMenu(),goog.ui.Component.EventType.ACTION,function(e){menuItemClicked++;lastMenuItemClicked=e.target});var checkbox=goog.dom.getElement("demoCheckbox");assertFalse("Checkbox must be unchecked (i.e. unselected)",checkbox.checked);checkbox.checked=!0;goog.testing.events.fireClickSequence(checkbox);assertFalse("Menu must be closed when clicking checkbox",selectionMenuButton.isOpen());assertEquals("Number of menu items clicked should be 1",1,menuItemClicked);assertEquals("menuItem1 should be the last menuitem clicked",goog.dom.getElement("menuItem1"),lastMenuItemClicked.getElement());checkbox.checked=!1;goog.testing.events.fireClickSequence(checkbox);assertFalse("Menu must be closed when clicking checkbox",selectionMenuButton.isOpen());assertEquals("Number of menu items clicked should be 2",2,menuItemClicked);assertEquals("menuItem2 should be the last menuitem clicked",goog.dom.getElement("menuItem2"),lastMenuItemClicked.getElement())}function testCheckboxReceiveEvents(){var node=goog.dom.getElement("demoSelectionMenuButton");selectionMenuButton.decorate(node);var checkbox=goog.dom.getElement("demoCheckbox");assertFalse("Checkbox must be unchecked (i.e. unselected)",checkbox.checked);goog.testing.events.fireClickSequence(goog.dom.getElement("menuItem1"));assertTrue("Checkbox must be checked (i.e. selected)",checkbox.checked);goog.testing.events.fireClickSequence(goog.dom.getElement("menuItem2"));assertFalse("Checkbox must be unchecked (i.e. unselected)",checkbox.checked)}function testSelectionState(){var node=goog.dom.getElement("demoSelectionMenuButton");selectionMenuButton.decorate(node);var checkbox=goog.dom.getElement("demoCheckbox");assertFalse("Checkbox must be unchecked (i.e. unselected)",checkbox.checked);selectionMenuButton.setSelectionState(goog.ui.SelectionMenuButton.SelectionState.ALL);assertTrue("Checkbox should be checked when selecting all",checkbox.checked);assertEquals("selectionState should be ALL",selectionMenuButton.getSelectionState(),goog.ui.SelectionMenuButton.SelectionState.ALL);selectionMenuButton.setSelectionState(goog.ui.SelectionMenuButton.SelectionState.NONE);assertFalse("Checkbox should be checked when selecting all",checkbox.checked);assertEquals("selectionState should be NONE",selectionMenuButton.getSelectionState(),goog.ui.SelectionMenuButton.SelectionState.NONE);selectionMenuButton.setSelectionState(goog.ui.SelectionMenuButton.SelectionState.SOME);assertTrue("Checkbox should be checked when selecting all",checkbox.checked);assertEquals("selectionState should be SOME",selectionMenuButton.getSelectionState(),goog.ui.SelectionMenuButton.SelectionState.SOME)}function testCheckboxDisabled(){var node=goog.dom.getElement("demoSelectionMenuButton");selectionMenuButton.decorate(node);var checkbox=goog.dom.getElement("demoCheckbox");assertFalse("Checkbox must be enabled",checkbox.disabled);selectionMenuButton.setEnabled(!1);assertTrue("Checkbox must be disabled",checkbox.disabled);selectionMenuButton.setEnabled(!0);assertFalse("Checkbox must be enabled",checkbox.disabled)}function testCheckboxClickMenuClosed(){var node=goog.dom.getElement("demoSelectionMenuButton");selectionMenuButton.decorate(node);var checkbox=goog.dom.getElement("demoCheckbox");goog.testing.events.fireMouseDownEvent(checkbox);assertFalse("Menu must be closed when mousedown checkbox",selectionMenuButton.isOpen());goog.testing.events.fireMouseUpEvent(checkbox);assertFalse("Menu must remain closed when mouseup checkbox",selectionMenuButton.isOpen());selectionMenuButton.setOpen(!0);goog.testing.events.fireClickSequence(checkbox);assertFalse("Menu must close when clickin checkbox",selectionMenuButton.isOpen())}