goog.provide("goog.positioning.clientPositionTest");goog.setTestOnly("goog.positioning.clientPositionTest");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.positioning.ClientPosition");goog.require("goog.positioning.Corner");goog.require("goog.style");goog.require("goog.testing.jsunit");var popupElement,testArea,POPUP_HEIGHT=100,POPUP_WIDTH=150;function setUp(){testArea=goog.dom.getElement("test-area");goog.style.setSize(testArea,5e3,5e3);window.scrollTo(0,0);popupElement=goog.dom.createDom(goog.dom.TagName.DIV);goog.style.setSize(popupElement,POPUP_WIDTH,POPUP_HEIGHT);popupElement.style.position="absolute";popupElement.style.background="blue"}function tearDown(){popupElement=null;goog.dom.removeChildren(testArea);testArea.setAttribute("style","")}function testClientPositionWithZeroViewportOffset(){goog.dom.appendChild(testArea,popupElement);var x=300,y=200,pos=new goog.positioning.ClientPosition(x,y);pos.reposition(popupElement,goog.positioning.Corner.TOP_LEFT);assertPageOffset(x,y,popupElement);pos.reposition(popupElement,goog.positioning.Corner.TOP_RIGHT);assertPageOffset(x-POPUP_WIDTH,y,popupElement);pos.reposition(popupElement,goog.positioning.Corner.BOTTOM_LEFT);assertPageOffset(x,y-POPUP_HEIGHT,popupElement);pos.reposition(popupElement,goog.positioning.Corner.BOTTOM_RIGHT);assertPageOffset(x-POPUP_WIDTH,y-POPUP_HEIGHT,popupElement)}function testClientPositionWithSomeViewportOffset(){goog.dom.appendChild(testArea,popupElement);var x=300,y=200,scrollX=135,scrollY=270;window.scrollTo(scrollX,scrollY);var pos=new goog.positioning.ClientPosition(x,y);pos.reposition(popupElement,goog.positioning.Corner.TOP_LEFT);assertPageOffset(scrollX+x,scrollY+y,popupElement)}function testClientPositionWithPositionContext(){var contextAbsoluteX=90,contextAbsoluteY=110,x=300,y=200,contextElement=goog.dom.createDom(goog.dom.TagName.DIV,void 0,popupElement);goog.style.setPosition(contextElement,contextAbsoluteX,contextAbsoluteY);contextElement.style.position="absolute";goog.dom.appendChild(testArea,contextElement);var pos=new goog.positioning.ClientPosition(x,y);pos.reposition(popupElement,goog.positioning.Corner.TOP_LEFT);assertPageOffset(x,y,popupElement)}function assertPageOffset(expectedX,expectedY,el){var offsetCoordinate=goog.style.getPageOffset(el);assertEquals("x-coord page offset is wrong.",expectedX,offsetCoordinate.x);assertEquals("y-coord page offset is wrong.",expectedY,offsetCoordinate.y)}