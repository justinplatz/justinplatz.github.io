goog.provide("goog.debug");goog.require("goog.array");goog.require("goog.html.SafeHtml");goog.require("goog.html.SafeUrl");goog.require("goog.html.uncheckedconversions");goog.require("goog.string.Const");goog.require("goog.structs.Set");goog.require("goog.userAgent");goog.define("goog.debug.LOGGING_ENABLED",goog.DEBUG);goog.define("goog.debug.FORCE_SLOPPY_STACKS",!1);goog.debug.catchErrors=function(logFunc,opt_cancel,opt_target){var target=opt_target||goog.global,oldErrorHandler=target.onerror,retVal=!!opt_cancel;if(goog.userAgent.WEBKIT&&!goog.userAgent.isVersionOrHigher("535.3")){retVal=!retVal}target.onerror=function(message,url,line,opt_col,opt_error){if(oldErrorHandler){oldErrorHandler(message,url,line,opt_col,opt_error)}logFunc({message:message,fileName:url,line:line,col:opt_col,error:opt_error});return retVal}};goog.debug.expose=function(obj,opt_showFn){if("undefined"==typeof obj){return"undefined"}if(null==obj){return"NULL"}var str=[];for(var x in obj){if(!opt_showFn&&goog.isFunction(obj[x])){continue}var s=x+" = ";try{s+=obj[x]}catch(e){s+="*** "+e+" ***"}str.push(s)}return str.join("\n")};goog.debug.deepExpose=function(obj,opt_showFn){var str=[],helper=function(obj,space,parentSeen){var nestspace=space+"  ",seen=new goog.structs.Set(parentSeen),indentMultiline=function(str){return str.replace(/\n/g,"\n"+space)};try{if(!goog.isDef(obj)){str.push("undefined")}else if(goog.isNull(obj)){str.push("NULL")}else if(goog.isString(obj)){str.push("\""+indentMultiline(obj)+"\"")}else if(goog.isFunction(obj)){str.push(indentMultiline(obj+""))}else if(goog.isObject(obj)){if(seen.contains(obj)){str.push("*** reference loop detected ***")}else{seen.add(obj);str.push("{");for(var x in obj){if(!opt_showFn&&goog.isFunction(obj[x])){continue}str.push("\n");str.push(nestspace);str.push(x+" = ");helper(obj[x],nestspace,seen)}str.push("\n"+space+"}")}}else{str.push(obj)}}catch(e){str.push("*** "+e+" ***")}};helper(obj,"",new goog.structs.Set);return str.join("")};goog.debug.exposeArray=function(arr){for(var str=[],i=0;i<arr.length;i++){if(goog.isArray(arr[i])){str.push(goog.debug.exposeArray(arr[i]))}else{str.push(arr[i])}}return"[ "+str.join(", ")+" ]"};goog.debug.exposeException=function(err,opt_fn){var html=goog.debug.exposeExceptionAsHtml(err,opt_fn);return goog.html.SafeHtml.unwrap(html)};goog.debug.exposeExceptionAsHtml=function(err,opt_fn){try{var e=goog.debug.normalizeErrorObject(err),viewSourceUrl=goog.debug.createViewSourceUrl_(e.fileName),error=goog.html.SafeHtml.concat(goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces("Message: "+e.message+"\nUrl: "),goog.html.SafeHtml.create("a",{href:viewSourceUrl,target:"_new"},e.fileName),goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces("\nLine: "+e.lineNumber+"\n\nBrowser stack:\n"+e.stack+"-> "+"[end]\n\nJS stack traversal:\n"+goog.debug.getStacktrace(opt_fn)+"-> "));return error}catch(e2){return goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces("Exception trying to expose exception! You win, we lose. "+e2)}};goog.debug.createViewSourceUrl_=function(opt_fileName){if(!goog.isDefAndNotNull(opt_fileName)){opt_fileName=""}if(!/^https?:\/\//i.test(opt_fileName)){return goog.html.SafeUrl.fromConstant(goog.string.Const.from("sanitizedviewsrc"))}var sanitizedFileName=goog.html.SafeUrl.sanitize(opt_fileName);return goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("view-source scheme plus HTTP/HTTPS URL"),"view-source:"+goog.html.SafeUrl.unwrap(sanitizedFileName))};goog.debug.normalizeErrorObject=function(err){var href=goog.getObjectByName("window.location.href");if(goog.isString(err)){return{message:err,name:"Unknown error",lineNumber:"Not available",fileName:href,stack:"Not available"}}var lineNumber,fileName,threwError=!1;try{lineNumber=err.lineNumber||err.line||"Not available"}catch(e){lineNumber="Not available";threwError=!0}try{fileName=err.fileName||err.filename||err.sourceURL||goog.global.$googDebugFname||href}catch(e){fileName="Not available";threwError=!0}if(threwError||!err.lineNumber||!err.fileName||!err.stack||!err.message||!err.name){return{message:err.message||"Not available",name:err.name||"UnknownError",lineNumber:lineNumber,fileName:fileName,stack:err.stack||"Not available"}}return err};goog.debug.enhanceError=function(err,opt_message){var error;if(!(err instanceof Error)){error=Error(err);if(Error.captureStackTrace){Error.captureStackTrace(error,goog.debug.enhanceError)}}else{error=err}if(!error.stack){error.stack=goog.debug.getStacktrace(goog.debug.enhanceError)}if(opt_message){var x=0;while(error["message"+x]){++x}error["message"+x]=opt_message+""}return error};goog.debug.getStacktraceSimple=function(opt_depth){if(!goog.debug.FORCE_SLOPPY_STACKS){var stack=goog.debug.getNativeStackTrace_(goog.debug.getStacktraceSimple);if(stack){return stack}}var sb=[],fn=arguments.callee.caller,depth=0;while(fn&&(!opt_depth||depth<opt_depth)){sb.push(goog.debug.getFunctionName(fn));sb.push("()\n");try{fn=fn.caller}catch(e){sb.push("[exception trying to get caller]\n");break}depth++;if(depth>=goog.debug.MAX_STACK_DEPTH){sb.push("[...long stack...]");break}}if(opt_depth&&depth>=opt_depth){sb.push("[...reached max depth limit...]")}else{sb.push("[end]")}return sb.join("")};goog.debug.MAX_STACK_DEPTH=50;goog.debug.getNativeStackTrace_=function(fn){var tempErr=new Error;if(Error.captureStackTrace){Error.captureStackTrace(tempErr,fn);return tempErr.stack+""}else{try{throw tempErr}catch(e){tempErr=e}var stack=tempErr.stack;if(stack){return stack+""}}return null};goog.debug.getStacktrace=function(opt_fn){var stack;if(!goog.debug.FORCE_SLOPPY_STACKS){var contextFn=opt_fn||goog.debug.getStacktrace;stack=goog.debug.getNativeStackTrace_(contextFn)}if(!stack){stack=goog.debug.getStacktraceHelper_(opt_fn||arguments.callee.caller,[])}return stack};goog.debug.getStacktraceHelper_=function(fn,visited){var sb=[];if(goog.array.contains(visited,fn)){sb.push("[...circular reference...]")}else if(fn&&visited.length<goog.debug.MAX_STACK_DEPTH){sb.push(goog.debug.getFunctionName(fn)+"(");for(var args=fn.arguments,i=0;args&&i<args.length;i++){if(0<i){sb.push(", ")}var argDesc,arg=args[i];switch(typeof arg){case"object":argDesc=arg?"object":"null";break;case"string":argDesc=arg;break;case"number":argDesc=arg+"";break;case"boolean":argDesc=arg?"true":"false";break;case"function":argDesc=goog.debug.getFunctionName(arg);argDesc=argDesc?argDesc:"[fn]";break;case"undefined":default:argDesc=typeof arg;break;}if(40<argDesc.length){argDesc=argDesc.substr(0,40)+"..."}sb.push(argDesc)}visited.push(fn);sb.push(")\n");try{sb.push(goog.debug.getStacktraceHelper_(fn.caller,visited))}catch(e){sb.push("[exception trying to get caller]\n")}}else if(fn){sb.push("[...long stack...]")}else{sb.push("[end]")}return sb.join("")};goog.debug.setFunctionResolver=function(resolver){goog.debug.fnNameResolver_=resolver};goog.debug.getFunctionName=function(fn){if(goog.debug.fnNameCache_[fn]){return goog.debug.fnNameCache_[fn]}if(goog.debug.fnNameResolver_){var name=goog.debug.fnNameResolver_(fn);if(name){goog.debug.fnNameCache_[fn]=name;return name}}var functionSource=fn+"";if(!goog.debug.fnNameCache_[functionSource]){var matches=/function ([^\(]+)/.exec(functionSource);if(matches){var method=matches[1];goog.debug.fnNameCache_[functionSource]=method}else{goog.debug.fnNameCache_[functionSource]="[Anonymous]"}}return goog.debug.fnNameCache_[functionSource]};goog.debug.makeWhitespaceVisible=function(string){return string.replace(/ /g,"[_]").replace(/\f/g,"[f]").replace(/\n/g,"[n]\n").replace(/\r/g,"[r]").replace(/\t/g,"[t]")};goog.debug.runtimeType=function(value){if(value instanceof Function){return value.displayName||value.name||"unknown type name"}else if(value instanceof Object){return value.constructor.displayName||value.constructor.name||Object.prototype.toString.call(value)}else{return null===value?"null":typeof value}};goog.debug.fnNameCache_={};goog.debug.fnNameResolver_;