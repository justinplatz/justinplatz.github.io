goog.setTestOnly("goog.testing.fs");goog.provide("goog.testing.fs");goog.require("goog.Timer");goog.require("goog.array");goog.require("goog.async.Deferred");goog.require("goog.fs");goog.require("goog.testing.fs.Blob");goog.require("goog.testing.fs.FileSystem");goog.testing.fs.getTemporary=function(size){var d=new goog.async.Deferred;goog.Timer.callOnce(goog.bind(d.callback,d,new goog.testing.fs.FileSystem));return d};goog.testing.fs.getPersistent=function(size){return goog.testing.fs.getTemporary(size)};goog.testing.fs.objectUrls_={};goog.testing.fs.createObjectUrl=function(blob){var url=blob.toDataUrl();goog.testing.fs.objectUrls_[url]=!0;return url};goog.testing.fs.revokeObjectUrl=function(url){delete goog.testing.fs.objectUrls_[url]};goog.testing.fs.isObjectUrlGranted=function(blob){return blob.toDataUrl()in goog.testing.fs.objectUrls_};goog.testing.fs.getBlob=function(var_args){return new goog.testing.fs.Blob(goog.array.map(arguments,String).join(""))};goog.testing.fs.getBlobWithProperties=function(parts,opt_type,opt_endings){return new goog.testing.fs.Blob(goog.array.map(parts,String).join(""),opt_type)};goog.testing.fs.blobToString=function(blob,opt_encoding){var d=new goog.async.Deferred;goog.Timer.callOnce(goog.bind(d.callback,d,blob.toString()));return d};goog.testing.fs.sliceBlob=function(testBlob,start,opt_end){return testBlob.slice(start,opt_end)};goog.testing.fs.install=function(stubs){var fs=goog.getObjectByName("goog.fs");stubs.replace(fs,"getTemporary",goog.testing.fs.getTemporary);stubs.replace(fs,"getPersistent",goog.testing.fs.getPersistent);stubs.replace(fs,"createObjectUrl",goog.testing.fs.createObjectUrl);stubs.replace(fs,"revokeObjectUrl",goog.testing.fs.revokeObjectUrl);stubs.replace(fs,"getBlob",goog.testing.fs.getBlob);stubs.replace(fs,"getBlobWithProperties",goog.testing.fs.getBlobWithProperties);stubs.replace(fs,"blobToString",goog.testing.fs.blobToString);stubs.replace(fs,"browserSupportsObjectUrls",function(){return!0})};