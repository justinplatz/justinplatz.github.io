goog.provide("goog.fx.CssSpriteAnimationTest");goog.setTestOnly("goog.fx.CssSpriteAnimationTest");goog.require("goog.fx.CssSpriteAnimation");goog.require("goog.math.Box");goog.require("goog.math.Size");goog.require("goog.testing.MockClock");goog.require("goog.testing.jsunit");var el,size,box,time=1e3,anim,clock;function setUpPage(){clock=new goog.testing.MockClock(!0);el=document.getElementById("test");size=new goog.math.Size(10,10);box=new goog.math.Box(0,10,100,0)}function tearDownPage(){clock.dispose()}function tearDown(){anim.clearSpritePosition();anim.dispose()}function assertBackgroundPosition(x,y){if("undefined"!=typeof el.style.backgroundPositionX){assertEquals(x+"px",el.style.backgroundPositionX);assertEquals(y+"px",el.style.backgroundPositionY)}else{var bgPos=el.style.backgroundPosition,message="Expected <"+x+"px "+y+"px>, found <"+bgPos+">";if(x==y){assertTrue(message,bgPos==x||bgPos==x+"px"||bgPos==x+" "+y||bgPos==x+"px "+y+"px")}else{assertTrue(message,bgPos==x+" "+y||bgPos==x+"px "+y||bgPos==x+" "+y+"px"||bgPos==x+"px "+y+"px")}}}function testAnimation(){anim=new goog.fx.CssSpriteAnimation(el,size,box,time);anim.play();assertBackgroundPosition(0,0);clock.tick(5);assertBackgroundPosition(0,0);clock.tick(95);assertBackgroundPosition(0,-10);clock.tick(100);assertBackgroundPosition(0,-20);clock.tick(300);assertBackgroundPosition(0,-50);clock.tick(400);assertBackgroundPosition(0,-90);clock.tick(100);assertBackgroundPosition(0,0);assertTrue(anim.isPlaying());assertFalse(anim.isStopped());clock.tick(100);assertBackgroundPosition(0,-10)}function testAnimation_disableLoop(){anim=new goog.fx.CssSpriteAnimation(el,size,box,time,void 0,!0);anim.play();assertBackgroundPosition(0,0);clock.tick(5);assertBackgroundPosition(0,0);clock.tick(95);assertBackgroundPosition(0,-10);clock.tick(100);assertBackgroundPosition(0,-20);clock.tick(300);assertBackgroundPosition(0,-50);clock.tick(400);assertBackgroundPosition(0,-90);clock.tick(100);assertBackgroundPosition(0,-90);assertTrue(anim.isStopped());assertFalse(anim.isPlaying());clock.tick(100);assertBackgroundPosition(0,-90)}function testClearSpritePosition(){anim=new goog.fx.CssSpriteAnimation(el,size,box,time);anim.play();assertBackgroundPosition(0,0);clock.tick(100);assertBackgroundPosition(0,-10);anim.clearSpritePosition();if("undefined"!=typeof el.style.backgroundPositionX){assertEquals("",el.style.backgroundPositionX);assertEquals("",el.style.backgroundPositionY)}assertEquals("",el.style.backgroundPosition)}