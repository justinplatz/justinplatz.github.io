goog.provide("goog.date.relative");goog.provide("goog.date.relative.TimeDeltaFormatter");goog.provide("goog.date.relative.Unit");goog.require("goog.i18n.DateTimeFormat");goog.require("goog.i18n.DateTimePatterns");goog.date.relative.MINUTE_MS_=6e4;goog.date.relative.DAY_MS_=864e5;goog.date.relative.Unit={MINUTES:0,HOURS:1,DAYS:2};goog.date.relative.fullDateFormatter_;goog.date.relative.shortTimeFormatter_;goog.date.relative.monthDateFormatter_;goog.date.relative.TimeDeltaFormatter;goog.date.relative.formatTimeDelta_;goog.date.relative.setTimeDeltaFormatter=function(formatter){goog.date.relative.formatTimeDelta_=formatter};goog.date.relative.formatMonth_=function(date){if(!goog.date.relative.monthDateFormatter_){goog.date.relative.monthDateFormatter_=new goog.i18n.DateTimeFormat(goog.i18n.DateTimePatterns.MONTH_DAY_ABBR)}return goog.date.relative.monthDateFormatter_.format(date)};goog.date.relative.formatShortTime_=function(date){if(!goog.date.relative.shortTimeFormatter_){goog.date.relative.shortTimeFormatter_=new goog.i18n.DateTimeFormat(goog.i18n.DateTimeFormat.Format.SHORT_TIME)}return goog.date.relative.shortTimeFormatter_.format(date)};goog.date.relative.formatFullDate_=function(date){if(!goog.date.relative.fullDateFormatter_){goog.date.relative.fullDateFormatter_=new goog.i18n.DateTimeFormat(goog.i18n.DateTimeFormat.Format.FULL_DATE)}return goog.date.relative.fullDateFormatter_.format(date)};goog.date.relative.format=function(dateMs){var _Mathfloor=Math.floor,now=goog.now(),delta=_Mathfloor((now-dateMs)/goog.date.relative.MINUTE_MS_),future=!1;if(0>delta){future=!0;delta*=-1}if(60>delta){return goog.date.relative.formatTimeDelta_(delta,future,goog.date.relative.Unit.MINUTES)}else{delta=_Mathfloor(delta/60);if(24>delta){return goog.date.relative.formatTimeDelta_(delta,future,goog.date.relative.Unit.HOURS)}else{var midnight=new Date(goog.now());midnight.setHours(0);midnight.setMinutes(0);midnight.setSeconds(0);midnight.setMilliseconds(0);delta=Math.ceil((midnight.getTime()-dateMs)/goog.date.relative.DAY_MS_);if(future){delta*=-1}if(14>delta){return goog.date.relative.formatTimeDelta_(delta,future,goog.date.relative.Unit.DAYS)}else{return""}}}};goog.date.relative.formatPast=function(dateMs){var now=goog.now();if(now<dateMs){dateMs=now}return goog.date.relative.format(dateMs)};goog.date.relative.formatDay=function(dateMs,opt_formatter){var today=new Date(goog.now());today.setHours(0);today.setMinutes(0);today.setSeconds(0);today.setMilliseconds(0);var yesterday=new Date(today.getTime()-goog.date.relative.DAY_MS_),tomorrow=new Date(today.getTime()+goog.date.relative.DAY_MS_),dayAfterTomorrow=new Date(today.getTime()+2*goog.date.relative.DAY_MS_),message;if(dateMs>=tomorrow.getTime()&&dateMs<dayAfterTomorrow.getTime()){var MSG_TOMORROW=goog.getMsg("Tomorrow");message=MSG_TOMORROW}else if(dateMs>=today.getTime()&&dateMs<tomorrow.getTime()){var MSG_TODAY=goog.getMsg("Today");message=MSG_TODAY}else if(dateMs>=yesterday.getTime()&&dateMs<today.getTime()){var MSG_YESTERDAY=goog.getMsg("Yesterday");message=MSG_YESTERDAY}else{var formatFunction=opt_formatter||goog.date.relative.formatMonth_;message=formatFunction(new Date(dateMs))}return message};goog.date.relative.getDateString=function(date,opt_shortTimeMsg,opt_fullDateMsg){return goog.date.relative.getDateString_(date,goog.date.relative.format,opt_shortTimeMsg,opt_fullDateMsg)};goog.date.relative.getPastDateString=function(date,opt_shortTimeMsg,opt_fullDateMsg){return goog.date.relative.getDateString_(date,goog.date.relative.formatPast,opt_shortTimeMsg,opt_fullDateMsg)};goog.date.relative.getDateString_=function(date,relativeFormatter,opt_shortTimeMsg,opt_fullDateMsg){var dateMs=date.getTime(),relativeDate=relativeFormatter(dateMs);if(relativeDate){relativeDate=" ("+relativeDate+")"}var delta=Math.floor((goog.now()-dateMs)/goog.date.relative.MINUTE_MS_);if(delta<24*60){return(opt_shortTimeMsg||goog.date.relative.formatShortTime_(date))+relativeDate}else{return(opt_fullDateMsg||goog.date.relative.formatFullDate_(date))+relativeDate}};goog.date.relative.getMessage_=function(delta,future,unit){var deltaFormatted=goog.i18n.DateTimeFormat.localizeNumbers(delta);if(!future&&unit==goog.date.relative.Unit.MINUTES){var MSG_MINUTES_AGO_SINGULAR=goog.getMsg("{$num} minute ago",{num:deltaFormatted}),MSG_MINUTES_AGO_PLURAL=goog.getMsg("{$num} minutes ago",{num:deltaFormatted});return 1==delta?MSG_MINUTES_AGO_SINGULAR:MSG_MINUTES_AGO_PLURAL}else if(future&&unit==goog.date.relative.Unit.MINUTES){var MSG_IN_MINUTES_SINGULAR=goog.getMsg("in {$num} minute",{num:deltaFormatted}),MSG_IN_MINUTES_PLURAL=goog.getMsg("in {$num} minutes",{num:deltaFormatted});return 1==delta?MSG_IN_MINUTES_SINGULAR:MSG_IN_MINUTES_PLURAL}else if(!future&&unit==goog.date.relative.Unit.HOURS){var MSG_HOURS_AGO_SINGULAR=goog.getMsg("{$num} hour ago",{num:deltaFormatted}),MSG_HOURS_AGO_PLURAL=goog.getMsg("{$num} hours ago",{num:deltaFormatted});return 1==delta?MSG_HOURS_AGO_SINGULAR:MSG_HOURS_AGO_PLURAL}else if(future&&unit==goog.date.relative.Unit.HOURS){var MSG_IN_HOURS_SINGULAR=goog.getMsg("in {$num} hour",{num:deltaFormatted}),MSG_IN_HOURS_PLURAL=goog.getMsg("in {$num} hours",{num:deltaFormatted});return 1==delta?MSG_IN_HOURS_SINGULAR:MSG_IN_HOURS_PLURAL}else if(!future&&unit==goog.date.relative.Unit.DAYS){var MSG_DAYS_AGO_SINGULAR=goog.getMsg("{$num} day ago",{num:deltaFormatted}),MSG_DAYS_AGO_PLURAL=goog.getMsg("{$num} days ago",{num:deltaFormatted});return 1==delta?MSG_DAYS_AGO_SINGULAR:MSG_DAYS_AGO_PLURAL}else if(future&&unit==goog.date.relative.Unit.DAYS){var MSG_IN_DAYS_SINGULAR=goog.getMsg("in {$num} day",{num:deltaFormatted}),MSG_IN_DAYS_PLURAL=goog.getMsg("in {$num} days",{num:deltaFormatted});return 1==delta?MSG_IN_DAYS_SINGULAR:MSG_IN_DAYS_PLURAL}else{return""}};goog.date.relative.setTimeDeltaFormatter(goog.date.relative.getMessage_);