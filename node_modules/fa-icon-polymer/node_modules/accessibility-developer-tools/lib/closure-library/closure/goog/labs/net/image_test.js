goog.provide("goog.labs.net.imageTest");goog.require("goog.labs.net.image");goog.require("goog.string");goog.require("goog.testing.TestCase");goog.require("goog.testing.jsunit");goog.require("goog.testing.recordFunction");goog.setTestOnly("goog.labs.net.imageTest");function setUpPage(){goog.testing.TestCase.getActiveTestCase().promiseTimeout=1e4}function testValidImage(){var url="testdata/cleardot.gif";return goog.labs.net.image.load(url).then(function(value){assertEquals("IMG",value.tagName);assertTrue(goog.string.endsWith(value.src,url))})}function testInvalidImage(){var url="testdata/invalid.gif";return goog.labs.net.image.load(url).then(function(){fail("Invalid image should not resolve")},function(errResult){assertNull(errResult)})}function testImageFactory(){var returnedImage=new Image,factory=function(){return returnedImage},countedFactory=goog.testing.recordFunction(factory),url="testdata/cleardot.gif";return goog.labs.net.image.load(url,countedFactory).then(function(value){assertEquals(returnedImage,value);assertEquals(1,countedFactory.getCallCount())})}function testExistingImage(){var image=new Image,url="testdata/cleardot.gif";return goog.labs.net.image.load(url,image).then(function(value){assertEquals(image,value)})}