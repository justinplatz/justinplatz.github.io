goog.provide("goog.labs.net.image");goog.require("goog.Promise");goog.require("goog.events.EventHandler");goog.require("goog.events.EventType");goog.require("goog.net.EventType");goog.require("goog.userAgent");goog.labs.net.image.load=function(uri,opt_image){return new goog.Promise(function(resolve,reject){var image;if(!goog.isDef(opt_image)){image=new Image}else if(goog.isFunction(opt_image)){image=opt_image()}else{image=opt_image}var loadEvent=goog.userAgent.IE&&11>goog.userAgent.VERSION?goog.net.EventType.READY_STATE_CHANGE:goog.events.EventType.LOAD,handler=new goog.events.EventHandler;handler.listen(image,[loadEvent,goog.net.EventType.ABORT,goog.net.EventType.ERROR],function(e){if(e.type==goog.net.EventType.READY_STATE_CHANGE&&image.readyState!=goog.net.EventType.COMPLETE){return}goog.dispose(handler);if(e.type==loadEvent){resolve(image)}else{reject(null)}});image.src=uri})};