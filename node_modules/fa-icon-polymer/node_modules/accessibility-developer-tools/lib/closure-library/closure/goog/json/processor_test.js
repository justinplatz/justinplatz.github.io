goog.provide("goog.json.processorTest");goog.setTestOnly("goog.json.processorTest");goog.require("goog.json.EvalJsonProcessor");goog.require("goog.json.NativeJsonProcessor");goog.require("goog.testing.jsunit");goog.require("goog.userAgent");var SUPPORTS_NATIVE_JSON=!1;function setUpPage(){SUPPORTS_NATIVE_JSON=goog.global.JSON&&!(goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("5.0"))}var REPLACER=function(k,v){return!!k?v+"d":v},REVIVER=function(k,v){return!!k?v.substring(0,v.length-1):v};function testJsParser(){var json="{\"a\":1,\"b\":{\"c\":2}}";runParsingTest(new goog.json.EvalJsonProcessor,json,json)}function testNativeParser(){if(!SUPPORTS_NATIVE_JSON){return}var json="{\"a\":1,\"b\":{\"c\":2}}";runParsingTest(new goog.json.NativeJsonProcessor,json,json)}function testJsParser_withReplacer(){runParsingTest(new goog.json.EvalJsonProcessor(REPLACER),"{\"a\":\"foo\",\"b\":\"goo\"}","{\"a\":\"food\",\"b\":\"good\"}")}function testNativeParser_withReplacer(){if(!SUPPORTS_NATIVE_JSON){return}runParsingTest(new goog.json.NativeJsonProcessor(REPLACER),"{\"a\":\"foo\",\"b\":\"goo\"}","{\"a\":\"food\",\"b\":\"good\"}")}function testNativeParser_withReviver(){if(!SUPPORTS_NATIVE_JSON){return}var json="{\"a\":\"fod\",\"b\":\"god\"}";runParsingTest(new goog.json.NativeJsonProcessor(REPLACER,REVIVER),json,json)}function testUnsafeJsParser(){var json="{\"a\":1,\"b\":{\"c\":2}}";runParsingTest(new goog.json.EvalJsonProcessor(null,!0),json,json)}function testUnsafeJsParser_withReplacer(){runParsingTest(new goog.json.EvalJsonProcessor(REPLACER,!0),"{\"a\":\"foo\",\"b\":\"goo\"}","{\"a\":\"food\",\"b\":\"good\"}")}function runParsingTest(parser,input,expected){assertEquals(expected,parser.stringify(parser.parse(input)))}