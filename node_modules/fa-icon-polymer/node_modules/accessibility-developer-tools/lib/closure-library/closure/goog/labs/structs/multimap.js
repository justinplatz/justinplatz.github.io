goog.provide("goog.labs.structs.Multimap");goog.require("goog.array");goog.require("goog.labs.structs.Map");goog.require("goog.object");goog.labs.structs.Multimap=function(){this.clear()};goog.labs.structs.Multimap.prototype.map_;goog.labs.structs.Multimap.prototype.count_=0;goog.labs.structs.Multimap.prototype.clear=function(){this.count_=0;this.map_=new goog.labs.structs.Map};goog.labs.structs.Multimap.prototype.clone=function(){var map=new goog.labs.structs.Multimap;map.addAllFromMultimap(this);return map};goog.labs.structs.Multimap.prototype.add=function(key,value){var values=this.map_.get(key);if(!values){this.map_.set(key,values=[])}values.push(value);this.count_++};goog.labs.structs.Multimap.prototype.addAllValues=function(key,values){goog.array.forEach(values,function(v){this.add(key,v)},this)};goog.labs.structs.Multimap.prototype.addAllFromMultimap=function(map){goog.array.forEach(map.getEntries(),function(entry){this.add(entry[0],entry[1])},this)};goog.labs.structs.Multimap.prototype.replaceValues=function(key,values){this.removeAll(key);this.addAllValues(key,values)};goog.labs.structs.Multimap.prototype.get=function(key){var values=this.map_.get(key);return values?goog.array.clone(values):[]};goog.labs.structs.Multimap.prototype.remove=function(key,value){var values=this.map_.get(key);if(!values){return!1}var removed=goog.array.removeIf(values,function(v){return goog.object.is(value,v)});if(removed){this.count_--;if(0==values.length){this.map_.remove(key)}}return removed};goog.labs.structs.Multimap.prototype.removeAll=function(key){var values=this.map_.get(key);if(this.map_.remove(key)){this.count_-=values.length;return!0}return!1};goog.labs.structs.Multimap.prototype.isEmpty=function(){return!this.count_};goog.labs.structs.Multimap.prototype.getCount=function(){return this.count_};goog.labs.structs.Multimap.prototype.containsEntry=function(key,value){var values=this.map_.get(key);if(!values){return!1}var index=goog.array.findIndex(values,function(v){return goog.object.is(v,value)});return 0<=index};goog.labs.structs.Multimap.prototype.containsKey=function(key){return this.map_.containsKey(key)};goog.labs.structs.Multimap.prototype.containsValue=function(value){return goog.array.some(this.map_.getValues(),function(values){return goog.array.some(values,function(v){return goog.object.is(v,value)})})};goog.labs.structs.Multimap.prototype.getKeys=function(){return this.map_.getKeys()};goog.labs.structs.Multimap.prototype.getValues=function(){return goog.array.flatten(this.map_.getValues())};goog.labs.structs.Multimap.prototype.getEntries=function(){for(var keys=this.getKeys(),entries=[],i=0;i<keys.length;i++){for(var key=keys[i],values=this.get(key),j=0;j<values.length;j++){entries.push([key,values[j]])}}return entries};