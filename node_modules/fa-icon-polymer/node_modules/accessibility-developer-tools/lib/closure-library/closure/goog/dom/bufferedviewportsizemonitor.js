goog.provide("goog.dom.BufferedViewportSizeMonitor");goog.require("goog.asserts");goog.require("goog.async.Delay");goog.require("goog.events");goog.require("goog.events.EventTarget");goog.require("goog.events.EventType");goog.dom.BufferedViewportSizeMonitor=function(viewportSizeMonitor,opt_bufferMs){goog.dom.BufferedViewportSizeMonitor.base(this,"constructor");this.resizeDelay_;this.viewportSizeMonitor_=viewportSizeMonitor;this.currentSize_=this.viewportSizeMonitor_.getSize();this.resizeBufferMs_=opt_bufferMs||goog.dom.BufferedViewportSizeMonitor.RESIZE_EVENT_DELAY_MS_;this.listenerKey_=goog.events.listen(viewportSizeMonitor,goog.events.EventType.RESIZE,this.handleResize_,!1,this)};goog.inherits(goog.dom.BufferedViewportSizeMonitor,goog.events.EventTarget);goog.dom.BufferedViewportSizeMonitor.EventType={RESIZE_HEIGHT:goog.events.getUniqueId("resizeheight"),RESIZE_WIDTH:goog.events.getUniqueId("resizewidth")};goog.dom.BufferedViewportSizeMonitor.RESIZE_EVENT_DELAY_MS_=100;goog.dom.BufferedViewportSizeMonitor.prototype.disposeInternal=function(){goog.events.unlistenByKey(this.listenerKey_);goog.dom.BufferedViewportSizeMonitor.base(this,"disposeInternal")};goog.dom.BufferedViewportSizeMonitor.prototype.handleResize_=function(){if(!this.resizeDelay_){this.resizeDelay_=new goog.async.Delay(this.onWindowResize_,this.resizeBufferMs_,this);this.registerDisposable(this.resizeDelay_)}this.resizeDelay_.start()};goog.dom.BufferedViewportSizeMonitor.prototype.onWindowResize_=function(){if(this.viewportSizeMonitor_.isDisposed()){return}var previousSize=this.currentSize_,currentSize=this.viewportSizeMonitor_.getSize();goog.asserts.assert(currentSize,"Viewport size should be set at this point");this.currentSize_=currentSize;if(previousSize){var resized=!1;if(previousSize.width!=currentSize.width){this.dispatchEvent(goog.dom.BufferedViewportSizeMonitor.EventType.RESIZE_WIDTH);resized=!0}if(previousSize.height!=currentSize.height){this.dispatchEvent(goog.dom.BufferedViewportSizeMonitor.EventType.RESIZE_HEIGHT);resized=!0}if(resized){this.dispatchEvent(goog.events.EventType.RESIZE)}}else{this.dispatchEvent(goog.dom.BufferedViewportSizeMonitor.EventType.RESIZE_HEIGHT);this.dispatchEvent(goog.dom.BufferedViewportSizeMonitor.EventType.RESIZE_WIDTH);this.dispatchEvent(goog.events.EventType.RESIZE)}};goog.dom.BufferedViewportSizeMonitor.prototype.getSize=function(){return this.currentSize_?this.currentSize_.clone():null};