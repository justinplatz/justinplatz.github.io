goog.provide("goog.proto2.PbLiteSerializer");goog.require("goog.asserts");goog.require("goog.proto2.FieldDescriptor");goog.require("goog.proto2.LazyDeserializer");goog.require("goog.proto2.Serializer");goog.proto2.PbLiteSerializer=function(){};goog.inherits(goog.proto2.PbLiteSerializer,goog.proto2.LazyDeserializer);goog.proto2.PbLiteSerializer.prototype.zeroIndexing_=!1;goog.proto2.PbLiteSerializer.prototype.setZeroIndexed=function(zeroIndexing){this.zeroIndexing_=zeroIndexing};goog.proto2.PbLiteSerializer.prototype.serialize=function(message){for(var descriptor=message.getDescriptor(),fields=descriptor.getFields(),serialized=[],zeroIndexing=this.zeroIndexing_,i=0,field;i<fields.length;i++){field=fields[i];if(!message.has(field)){continue}var tag=field.getTag(),index=zeroIndexing?tag-1:tag;if(field.isRepeated()){serialized[index]=[];for(var j=0;j<message.countOf(field);j++){serialized[index][j]=this.getSerializedValue(field,message.get(field,j))}}else{serialized[index]=this.getSerializedValue(field,message.get(field))}}message.forEachUnknown(function(tag,value){var index=zeroIndexing?tag-1:tag;serialized[index]=value});return serialized};goog.proto2.PbLiteSerializer.prototype.deserializeField=function(message,field,value){if(null==value){return value}if(field.isRepeated()){var data=[];goog.asserts.assert(goog.isArray(value),"Value must be array: %s",value);for(var i=0;i<value.length;i++){data[i]=this.getDeserializedValue(field,value[i])}return data}else{return this.getDeserializedValue(field,value)}};goog.proto2.PbLiteSerializer.prototype.getSerializedValue=function(field,value){if(field.getFieldType()==goog.proto2.FieldDescriptor.FieldType.BOOL){return value?1:0}return goog.proto2.Serializer.prototype.getSerializedValue.apply(this,arguments)};goog.proto2.PbLiteSerializer.prototype.getDeserializedValue=function(field,value){if(field.getFieldType()==goog.proto2.FieldDescriptor.FieldType.BOOL){goog.asserts.assert(goog.isNumber(value)||goog.isBoolean(value),"Value is expected to be a number or boolean");return!!value}return goog.proto2.Serializer.prototype.getDeserializedValue.apply(this,arguments)};goog.proto2.PbLiteSerializer.prototype.deserialize=function(descriptor,data){var toConvert=data;if(this.zeroIndexing_){toConvert=[];for(var key in data){toConvert[parseInt(key,10)+1]=data[key]}}return goog.proto2.PbLiteSerializer.base(this,"deserialize",descriptor,toConvert)};