goog.provide("goog.fx.AnimationParallelQueue");goog.provide("goog.fx.AnimationQueue");goog.provide("goog.fx.AnimationSerialQueue");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.events");goog.require("goog.fx.Transition");goog.require("goog.fx.TransitionBase");goog.fx.AnimationQueue=function(){goog.fx.AnimationQueue.base(this,"constructor");this.queue=[]};goog.inherits(goog.fx.AnimationQueue,goog.fx.TransitionBase);goog.fx.AnimationQueue.prototype.add=function(animation){goog.asserts.assert(this.isStopped(),"Not allowed to add animations to a running animation queue.");if(goog.array.contains(this.queue,animation)){return}this.queue.push(animation);goog.events.listen(animation,goog.fx.Transition.EventType.FINISH,this.onAnimationFinish,!1,this)};goog.fx.AnimationQueue.prototype.remove=function(animation){goog.asserts.assert(this.isStopped(),"Not allowed to remove animations from a running animation queue.");if(goog.array.remove(this.queue,animation)){goog.events.unlisten(animation,goog.fx.Transition.EventType.FINISH,this.onAnimationFinish,!1,this)}};goog.fx.AnimationQueue.prototype.onAnimationFinish=goog.abstractMethod;goog.fx.AnimationQueue.prototype.disposeInternal=function(){goog.array.forEach(this.queue,function(animation){animation.dispose()});this.queue.length=0;goog.fx.AnimationQueue.base(this,"disposeInternal")};goog.fx.AnimationParallelQueue=function(){goog.fx.AnimationParallelQueue.base(this,"constructor");this.finishedCounter_=0};goog.inherits(goog.fx.AnimationParallelQueue,goog.fx.AnimationQueue);goog.fx.AnimationParallelQueue.prototype.play=function(opt_restart){if(0==this.queue.length){return!1}if(opt_restart||this.isStopped()){this.finishedCounter_=0;this.onBegin()}else if(this.isPlaying()){return!1}this.onPlay();if(this.isPaused()){this.onResume()}var resuming=this.isPaused()&&!opt_restart;this.startTime=goog.now();this.endTime=null;this.setStatePlaying();goog.array.forEach(this.queue,function(anim){if(!resuming||anim.isPaused()){anim.play(opt_restart)}});return!0};goog.fx.AnimationParallelQueue.prototype.pause=function(){if(this.isPlaying()){goog.array.forEach(this.queue,function(anim){if(anim.isPlaying()){anim.pause()}});this.setStatePaused();this.onPause()}};goog.fx.AnimationParallelQueue.prototype.stop=function(opt_gotoEnd){goog.array.forEach(this.queue,function(anim){if(!anim.isStopped()){anim.stop(opt_gotoEnd)}});this.setStateStopped();this.endTime=goog.now();this.onStop();this.onEnd()};goog.fx.AnimationParallelQueue.prototype.onAnimationFinish=function(e){this.finishedCounter_++;if(this.finishedCounter_==this.queue.length){this.endTime=goog.now();this.setStateStopped();this.onFinish();this.onEnd()}};goog.fx.AnimationSerialQueue=function(){goog.fx.AnimationSerialQueue.base(this,"constructor");this.current_=0};goog.inherits(goog.fx.AnimationSerialQueue,goog.fx.AnimationQueue);goog.fx.AnimationSerialQueue.prototype.play=function(opt_restart){if(0==this.queue.length){return!1}if(opt_restart||this.isStopped()){if(this.current_<this.queue.length&&!this.queue[this.current_].isStopped()){this.queue[this.current_].stop(!1)}this.current_=0;this.onBegin()}else if(this.isPlaying()){return!1}this.onPlay();if(this.isPaused()){this.onResume()}this.startTime=goog.now();this.endTime=null;this.setStatePlaying();this.queue[this.current_].play(opt_restart);return!0};goog.fx.AnimationSerialQueue.prototype.pause=function(){if(this.isPlaying()){this.queue[this.current_].pause();this.setStatePaused();this.onPause()}};goog.fx.AnimationSerialQueue.prototype.stop=function(opt_gotoEnd){this.setStateStopped();this.endTime=goog.now();if(opt_gotoEnd){for(var i=this.current_,anim;i<this.queue.length;++i){anim=this.queue[i];if(anim.isStopped())anim.play();if(!anim.isStopped())anim.stop(!0)}}else if(this.current_<this.queue.length){this.queue[this.current_].stop(!1)}this.onStop();this.onEnd()};goog.fx.AnimationSerialQueue.prototype.onAnimationFinish=function(e){if(this.isPlaying()){this.current_++;if(this.current_<this.queue.length){this.queue[this.current_].play()}else{this.endTime=goog.now();this.setStateStopped();this.onFinish();this.onEnd()}}};