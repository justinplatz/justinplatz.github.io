goog.provide("goog.async.nextTick");goog.provide("goog.async.throwException");goog.require("goog.debug.entryPointRegistry");goog.require("goog.dom.TagName");goog.require("goog.functions");goog.require("goog.labs.userAgent.browser");goog.require("goog.labs.userAgent.engine");goog.async.throwException=function(exception){goog.global.setTimeout(function(){throw exception},0)};goog.async.nextTick=function(callback,opt_context,opt_useSetImmediate){var cb=callback;if(opt_context){cb=goog.bind(callback,opt_context)}cb=goog.async.nextTick.wrapCallback_(cb);if(goog.isFunction(goog.global.setImmediate)&&(opt_useSetImmediate||goog.async.nextTick.useSetImmediate_())){goog.global.setImmediate(cb);return}if(!goog.async.nextTick.setImmediate_){goog.async.nextTick.setImmediate_=goog.async.nextTick.getSetImmediateEmulator_()}goog.async.nextTick.setImmediate_(cb)};goog.async.nextTick.useSetImmediate_=function(){if(!goog.global.Window||!goog.global.Window.prototype){return!0}if(goog.labs.userAgent.browser.isEdge()||goog.global.Window.prototype.setImmediate!=goog.global.setImmediate){return!0}return!1};goog.async.nextTick.setImmediate_;goog.async.nextTick.getSetImmediateEmulator_=function(){var Channel=goog.global.MessageChannel;if("undefined"===typeof Channel&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!goog.labs.userAgent.engine.isPresto()){Channel=function(){var iframe=document.createElement(goog.dom.TagName.IFRAME+"");iframe.style.display="none";iframe.src="";document.documentElement.appendChild(iframe);var win=iframe.contentWindow,doc=win.document;doc.open();doc.write("");doc.close();var message="callImmediate"+Math.random(),origin="file:"==win.location.protocol?"*":win.location.protocol+"//"+win.location.host,onmessage=goog.bind(function(e){if("*"!=origin&&e.origin!=origin||e.data!=message){return}this.port1.onmessage()},this);win.addEventListener("message",onmessage,!1);this.port1={};this.port2={postMessage:function(){win.postMessage(message,origin)}}}}if("undefined"!==typeof Channel&&!goog.labs.userAgent.browser.isIE()){var channel=new Channel,head={},tail=head;channel.port1.onmessage=function(){if(goog.isDef(head.next)){head=head.next;var cb=head.cb;head.cb=null;cb()}};return function(cb){tail.next={cb:cb};tail=tail.next;channel.port2.postMessage(0)}}if("undefined"!==typeof document&&"onreadystatechange"in document.createElement(goog.dom.TagName.SCRIPT+"")){return function(cb){var script=document.createElement(goog.dom.TagName.SCRIPT+"");script.onreadystatechange=function(){script.onreadystatechange=null;script.parentNode.removeChild(script);script=null;cb();cb=null};document.documentElement.appendChild(script)}}return function(cb){goog.global.setTimeout(cb,0)}};goog.async.nextTick.wrapCallback_=goog.functions.identity;goog.debug.entryPointRegistry.register(function(transformer){goog.async.nextTick.wrapCallback_=transformer});