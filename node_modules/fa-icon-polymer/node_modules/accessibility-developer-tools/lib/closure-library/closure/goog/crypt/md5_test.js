goog.provide("goog.crypt.Md5Test");goog.setTestOnly("goog.crypt.Md5Test");goog.require("goog.crypt");goog.require("goog.crypt.Md5");goog.require("goog.crypt.hashTester");goog.require("goog.testing.jsunit");var sixty="123456789012345678901234567890123456789012345678901234567890";function testBasicOperations(){var md5=new goog.crypt.Md5;goog.crypt.hashTester.runBasicTests(md5)}function testBlockOperations(){var md5=new goog.crypt.Md5;goog.crypt.hashTester.runBlockTests(md5,64)}function testHashing(){var md5=new goog.crypt.Md5;assertEquals("d41d8cd98f00b204e9800998ecf8427e",goog.crypt.byteArrayToHex(md5.digest()));md5.reset();md5.update([97]);assertEquals("0cc175b9c0f1b6a831c399e269772661",goog.crypt.byteArrayToHex(md5.digest()));md5.reset();md5.update([97]);md5.update("bc");assertEquals("900150983cd24fb0d6963f7d28e17f72",goog.crypt.byteArrayToHex(md5.digest()));md5.reset();md5.update("abcdefghijklmnopqrstuvwxyz");assertEquals("c3fcd3d76192e4007dfb496cca67e13b",goog.crypt.byteArrayToHex(md5.digest()));md5.reset();md5.update("message ");md5.update("digest");assertEquals("f96b697d7cb7938d525a2f31aaf161d0",goog.crypt.byteArrayToHex(md5.digest()));md5.reset();md5.update("ABCDEFGHIJKLMNOPQRSTUVWXYZ");md5.update("abcdefghijklmnopqrstuvwxyz");md5.update("0123456789");assertEquals("d174ab98d277d9f5a5611c2c9f419d9f",goog.crypt.byteArrayToHex(md5.digest()))}function testPadding(){var md5=new goog.crypt.Md5;md5.update(sixty);md5.update(sixty.substr(0,59));assertEquals("6261005311809757906e04c0d670492d",goog.crypt.byteArrayToHex(md5.digest()));md5.reset();md5.update(sixty);md5.update(sixty);assertEquals("1d453b96d48d5e0cec4a20a71fecaa81",goog.crypt.byteArrayToHex(md5.digest()))}function testTwoAccumulators(){var md5_A=new goog.crypt.Md5,md5_B=new goog.crypt.Md5;md5_A.update(sixty);md5_B.update(sixty);md5_A.update(sixty+"1");md5_B.update(sixty+"2");assertEquals("0801d688cc107d4789ec8b9a4519f01f",goog.crypt.byteArrayToHex(md5_A.digest()));assertEquals("6e1a35ffc185d1e684d6ed281c0d4bd2",goog.crypt.byteArrayToHex(md5_B.digest()))}function testCollision(){var A=[209,49,221,2,197,230,238,196,105,61,154,6,152,175,249,92,47,202,181,135,18,70,126,171,64,4,88,62,184,251,127,137,85,173,52,6,9,244,179,2,131,228,136,131,37,113,65,90,8,81,37,232,247,205,201,159,217,29,189,242,128,55,60,91,216,130,62,49,86,52,143,91,174,109,172,212,54,201,25,198,221,83,226,180,135,218,3,253,2,57,99,6,210,72,205,160,233,159,51,66,15,87,126,232,206,84,182,112,128,168,13,30,198,152,33,188,182,168,131,147,150,249,101,43,111,247,42,112],B=[209,49,221,2,197,230,238,196,105,61,154,6,152,175,249,92,47,202,181,7,18,70,126,171,64,4,88,62,184,251,127,137,85,173,52,6,9,244,179,2,131,228,136,131,37,241,65,90,8,81,37,232,247,205,201,159,217,29,189,114,128,55,60,91,216,130,62,49,86,52,143,91,174,109,172,212,54,201,25,198,221,83,226,52,135,218,3,253,2,57,99,6,210,72,205,160,233,159,51,66,15,87,126,232,206,84,182,112,128,40,13,30,198,152,33,188,182,168,131,147,150,249,101,171,111,247,42,112],digest="79054025255fb1a26e4bc422aef54eb4",md5_A=new goog.crypt.Md5,md5_B=new goog.crypt.Md5;md5_A.update(A);md5_B.update(B);assertEquals(digest,goog.crypt.byteArrayToHex(md5_A.digest()));assertEquals(digest,goog.crypt.byteArrayToHex(md5_B.digest()))}