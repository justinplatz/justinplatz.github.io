goog.provide("goog.structs.weak");goog.require("goog.userAgent");goog.structs.weak.SUPPORTED_BROWSER=Object.defineProperty&&!(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"))&&!(goog.userAgent.SAFARI&&!goog.userAgent.isVersionOrHigher("534.48.3"));goog.structs.weak.USE_NATIVE_WEAKMAP="WeakMap"in goog.global&&!(goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("24"));goog.structs.weak.USE_NATIVE_WEAKSET="WeakSet"in goog.global;goog.structs.weak.WEAKREFS_PROPERTY_NAME="__shimWeakrefs__";goog.structs.weak.counter_=0;goog.structs.weak.generateId=function(){return(1e9*Math.random()>>>0)+""+goog.structs.weak.counter_++%1e9};goog.structs.weak.checkKeyType=function(key){if(!goog.isObject(key)){throw TypeError("Invalid value used in weak collection")}if(Object.isExtensible&&!Object.isExtensible(key)){throw TypeError("Unsupported non-extensible object used as weak map key")}};goog.structs.weak.set=function(id,key,value){goog.structs.weak.checkKeyType(key);if(!key.hasOwnProperty(goog.structs.weak.WEAKREFS_PROPERTY_NAME)){Object.defineProperty(key,goog.structs.weak.WEAKREFS_PROPERTY_NAME,{value:{}})}key[goog.structs.weak.WEAKREFS_PROPERTY_NAME][id]=value};goog.structs.weak.has=function(id,key){goog.structs.weak.checkKeyType(key);return key.hasOwnProperty(goog.structs.weak.WEAKREFS_PROPERTY_NAME)?id in key[goog.structs.weak.WEAKREFS_PROPERTY_NAME]:!1};goog.structs.weak.remove=function(id,key){if(goog.structs.weak.has(id,key)){delete key[goog.structs.weak.WEAKREFS_PROPERTY_NAME][id];return!0}return!1};