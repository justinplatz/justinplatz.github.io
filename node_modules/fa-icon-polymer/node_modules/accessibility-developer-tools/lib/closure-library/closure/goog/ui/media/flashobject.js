goog.provide("goog.ui.media.FlashObject");goog.provide("goog.ui.media.FlashObject.ScriptAccessLevel");goog.provide("goog.ui.media.FlashObject.Wmodes");goog.require("goog.asserts");goog.require("goog.dom.TagName");goog.require("goog.dom.safe");goog.require("goog.events.Event");goog.require("goog.events.EventHandler");goog.require("goog.events.EventType");goog.require("goog.html.TrustedResourceUrl");goog.require("goog.html.flash");goog.require("goog.log");goog.require("goog.object");goog.require("goog.string");goog.require("goog.structs.Map");goog.require("goog.style");goog.require("goog.ui.Component");goog.require("goog.userAgent");goog.require("goog.userAgent.flash");goog.ui.media.FlashObject=function(flashUrl,opt_domHelper){goog.ui.Component.call(this,opt_domHelper);this.flashUrl_=flashUrl;this.eventHandler_=new goog.events.EventHandler(this);this.flashVars_=new goog.structs.Map};goog.inherits(goog.ui.media.FlashObject,goog.ui.Component);goog.ui.media.FlashObject.SwfReadyStates_={LOADING:0,UNINITIALIZED:1,LOADED:2,INTERACTIVE:3,COMPLETE:4};goog.ui.media.FlashObject.IeSwfReadyStates_={LOADING:"loading",UNINITIALIZED:"uninitialized",LOADED:"loaded",INTERACTIVE:"interactive",COMPLETE:"complete"};goog.ui.media.FlashObject.Wmodes={OPAQUE:"opaque",TRANSPARENT:"transparent",WINDOW:"window"};goog.ui.media.FlashObject.ScriptAccessLevel={ALWAYS:"always",SAME_DOMAIN:"sameDomain",NEVER:"never"};goog.ui.media.FlashObject.CSS_CLASS=goog.getCssName("goog-ui-media-flash");goog.ui.media.FlashObject.FLASH_CSS_CLASS=goog.getCssName("goog-ui-media-flash-object");goog.ui.media.FlashObject.prototype.logger_=goog.log.getLogger("goog.ui.media.FlashObject");goog.ui.media.FlashObject.prototype.wmode_=goog.ui.media.FlashObject.Wmodes.WINDOW;goog.ui.media.FlashObject.prototype.requiredVersion_;goog.ui.media.FlashObject.prototype.width_;goog.ui.media.FlashObject.prototype.height_;goog.ui.media.FlashObject.prototype.backgroundColor_="#000000";goog.ui.media.FlashObject.prototype.allowScriptAccess_=goog.ui.media.FlashObject.ScriptAccessLevel.SAME_DOMAIN;goog.ui.media.FlashObject.prototype.setWmode=function(wmode){this.wmode_=wmode;return this};goog.ui.media.FlashObject.prototype.getWmode=function(){return this.wmode_};goog.ui.media.FlashObject.prototype.addFlashVars=function(map){this.flashVars_.addAll(map);return this};goog.ui.media.FlashObject.prototype.setFlashVar=function(key,value){this.flashVars_.set(key,value);return this};goog.ui.media.FlashObject.prototype.setFlashVars=function(flashVar,opt_value){if(flashVar instanceof goog.structs.Map||"object"==goog.typeOf(flashVar)){this.addFlashVars(flashVar)}else{goog.asserts.assert(goog.isString(flashVar)&&goog.isDef(opt_value),"Invalid argument(s)");this.setFlashVar(flashVar,opt_value)}return this};goog.ui.media.FlashObject.prototype.getFlashVars=function(){return this.flashVars_};goog.ui.media.FlashObject.prototype.setBackgroundColor=function(color){this.backgroundColor_=color;return this};goog.ui.media.FlashObject.prototype.getBackgroundColor=function(){return this.backgroundColor_};goog.ui.media.FlashObject.prototype.setAllowScriptAccess=function(value){this.allowScriptAccess_=value;return this};goog.ui.media.FlashObject.prototype.getAllowScriptAccess=function(){return this.allowScriptAccess_};goog.ui.media.FlashObject.prototype.setSize=function(width,height){var _Mathround=Math.round;this.width_=goog.isString(width)?width:_Mathround(width)+"px";this.height_=goog.isString(height)?height:_Mathround(height)+"px";if(this.getElement()){goog.style.setSize(this.getFlashElement(),this.width_,this.height_)}return this};goog.ui.media.FlashObject.prototype.getRequiredVersion=function(){return this.requiredVersion_};goog.ui.media.FlashObject.prototype.setRequiredVersion=function(version){this.requiredVersion_=version;return this};goog.ui.media.FlashObject.prototype.hasRequiredVersion=function(){return null!=this.requiredVersion_};goog.ui.media.FlashObject.prototype.enterDocument=function(){goog.ui.media.FlashObject.superClass_.enterDocument.call(this);goog.dom.safe.setInnerHtml(this.getElement(),this.createSwfTag_());if(this.width_&&this.height_){this.setSize(this.width_,this.height_)}this.eventHandler_.listen(this.getElement(),goog.object.getValues(goog.events.EventType),goog.events.Event.stopPropagation)};goog.ui.media.FlashObject.prototype.createDom=function(){if(this.hasRequiredVersion()&&!goog.userAgent.flash.isVersion(this.getRequiredVersion())){goog.log.warning(this.logger_,"Required flash version not found:"+this.getRequiredVersion());throw Error(goog.ui.Component.Error.NOT_SUPPORTED)}var element=this.getDomHelper().createElement(goog.dom.TagName.DIV);element.className=goog.ui.media.FlashObject.CSS_CLASS;this.setElementInternal(element)};goog.ui.media.FlashObject.prototype.createSwfTag_=function(){for(var keys=this.flashVars_.getKeys(),values=this.flashVars_.getValues(),flashVars=[],i=0;i<keys.length;i++){var key=goog.string.urlEncode(keys[i]),value=goog.string.urlEncode(values[i]);flashVars.push(key+"="+value)}var flashVarsString=flashVars.join("&");if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(11)){return this.createSwfTagOldIe_(flashVarsString)}else{return this.createSwfTagModern_(flashVarsString)}};goog.ui.media.FlashObject.prototype.createSwfTagModern_=function(flashVars){return goog.html.flash.createEmbed(this.flashUrl_,{AllowScriptAccess:this.allowScriptAccess_,allowFullScreen:"true",allowNetworking:"all",bgcolor:this.backgroundColor_,class:goog.ui.media.FlashObject.FLASH_CSS_CLASS,FlashVars:flashVars,id:this.getId(),name:this.getId(),quality:"high",SeamlessTabbing:"false",wmode:this.wmode_})};goog.ui.media.FlashObject.prototype.createSwfTagOldIe_=function(flashVars){return goog.html.flash.createObjectForOldIe(this.flashUrl_,{allowFullScreen:"true",AllowScriptAccess:this.allowScriptAccess_,allowNetworking:"all",bgcolor:this.backgroundColor_,FlashVars:flashVars,quality:"high",SeamlessTabbing:"false",wmode:this.wmode_},{class:goog.ui.media.FlashObject.FLASH_CSS_CLASS,id:this.getId(),name:this.getId()})};goog.ui.media.FlashObject.prototype.getFlashElement=function(){return this.getElement()?this.getElement().firstChild:null};goog.ui.media.FlashObject.prototype.disposeInternal=function(){goog.ui.media.FlashObject.superClass_.disposeInternal.call(this);this.flashVars_=null;this.eventHandler_.dispose();this.eventHandler_=null};goog.ui.media.FlashObject.prototype.isLoaded=function(){if(!this.isInDocument()||!this.getElement()){return!1}if(goog.userAgent.EDGE_OR_IE&&this.getFlashElement().readyState&&this.getFlashElement().readyState==goog.ui.media.FlashObject.IeSwfReadyStates_.COMPLETE){return!0}if(this.getFlashElement().readyState&&this.getFlashElement().readyState==goog.ui.media.FlashObject.SwfReadyStates_.COMPLETE){return!0}if("PercentLoaded"in this.getFlashElement()&&100==this.getFlashElement().PercentLoaded()){return!0}return!1};