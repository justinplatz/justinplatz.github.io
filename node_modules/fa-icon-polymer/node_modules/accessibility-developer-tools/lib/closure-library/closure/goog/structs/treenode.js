goog.provide("goog.structs.TreeNode");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.structs.Node");goog.structs.TreeNode=function(key,value){goog.structs.Node.call(this,key,value);this.parent_=null;this.children_=null};goog.inherits(goog.structs.TreeNode,goog.structs.Node);goog.structs.TreeNode.EMPTY_ARRAY_=[];goog.structs.TreeNode.prototype.clone=function(){return new goog.structs.TreeNode(this.getKey(),this.getValue())};goog.structs.TreeNode.prototype.deepClone=function(){var clone=this.clone();this.forEachChild(function(child){clone.addChild(child.deepClone())});return clone};goog.structs.TreeNode.prototype.getParent=function(){return this.parent_};goog.structs.TreeNode.prototype.isLeaf=function(){return!this.getChildCount()};goog.structs.TreeNode.prototype.isLastChild=function(){var parent=this.getParent();return!!(parent&&this==goog.array.peek(parent.getChildren()))};goog.structs.TreeNode.prototype.getChildren=function(){return this.children_||goog.structs.TreeNode.EMPTY_ARRAY_};goog.structs.TreeNode.prototype.getChildAt=function(index){return this.getChildren()[index]||null};goog.structs.TreeNode.prototype.getChildCount=function(){return this.getChildren().length};goog.structs.TreeNode.prototype.getDepth=function(){var depth=0,node=this;while(node.getParent()){depth++;node=node.getParent()}return depth};goog.structs.TreeNode.prototype.getAncestors=function(){var ancestors=[],node=this.getParent();while(node){ancestors.push(node);node=node.getParent()}return ancestors};goog.structs.TreeNode.prototype.getRoot=function(){var root=this;while(root.getParent()){root=root.getParent()}return root};goog.structs.TreeNode.prototype.getSubtreeKeys=function(){var ret=[];this.forEachChild(function(child){ret.push(child.getKey());if(!child.isLeaf()){ret.push(child.getSubtreeKeys())}});return ret};goog.structs.TreeNode.prototype.contains=function(node){var current=node;do{current=current.getParent()}while(current&&current!=this);return!!current};goog.structs.TreeNode.findCommonAncestor=function(var_args){var ret=arguments[0];if(!ret){return null}for(var retDepth=ret.getDepth(),i=1;i<arguments.length;i++){var node=arguments[i],depth=node.getDepth();while(node!=ret){if(depth<=retDepth){ret=ret.getParent();retDepth--}if(depth>retDepth){node=node.getParent();depth--}}}return ret};goog.structs.TreeNode.prototype.getNodeByKey=function(key){if(this.getKey()==key){return this}for(var children=this.getChildren(),i=0,descendant;i<children.length;i++){descendant=children[i].getNodeByKey(key);if(descendant){return descendant}}return null};goog.structs.TreeNode.prototype.forEachChild=function(f,opt_this){goog.array.forEach(this.getChildren(),f,opt_this)};goog.structs.TreeNode.prototype.forEachDescendant=function(f,opt_this){for(var children=this.getChildren(),i=0;i<children.length;i++){f.call(opt_this,children[i]);children[i].forEachDescendant(f,opt_this)}};goog.structs.TreeNode.prototype.traverse=function(f,opt_this){if(!1!==f.call(opt_this,this)){for(var children=this.getChildren(),i=0;i<children.length;i++){children[i].traverse(f,opt_this)}}};goog.structs.TreeNode.prototype.setParent=function(parent){this.parent_=parent};goog.structs.TreeNode.prototype.addChild=function(child){this.addChildAt(child,this.children_?this.children_.length:0)};goog.structs.TreeNode.prototype.addChildAt=function(child,index){goog.asserts.assert(!child.getParent());child.setParent(this);this.children_=this.children_||[];goog.asserts.assert(0<=index&&index<=this.children_.length);goog.array.insertAt(this.children_,child,index)};goog.structs.TreeNode.prototype.replaceChildAt=function(newChild,index){goog.asserts.assert(!newChild.getParent(),"newChild must not have parent node");var children=this.getChildren(),oldChild=children[index];goog.asserts.assert(oldChild,"Invalid child or child index is given.");oldChild.setParent(null);children[index]=newChild;newChild.setParent(this);return oldChild};goog.structs.TreeNode.prototype.replaceChild=function(newChild,oldChild){return this.replaceChildAt(newChild,goog.array.indexOf(this.getChildren(),oldChild))};goog.structs.TreeNode.prototype.removeChildAt=function(index){var child=this.children_&&this.children_[index];if(child){child.setParent(null);goog.array.removeAt(this.children_,index);if(0==this.children_.length){this.children_=null}return child}return null};goog.structs.TreeNode.prototype.removeChild=function(child){return child&&this.removeChildAt(goog.array.indexOf(this.getChildren(),child))};goog.structs.TreeNode.prototype.removeChildren=function(){if(this.children_){for(var i=0;i<this.children_.length;i++){this.children_[i].setParent(null)}this.children_=null}};