goog.provide("goog.crypt.CtrTest");goog.require("goog.crypt");goog.require("goog.crypt.Aes");goog.require("goog.crypt.Ctr");goog.require("goog.testing.jsunit");goog.setTestOnly("goog.crypt.CtrTest");function runCtrAesTest(keyBytes,initialVectorBytes,plainTextBytes,cipherTextBytes){var aes=new goog.crypt.Aes(keyBytes),Ctr=new goog.crypt.Ctr(aes),encryptedBytes=Ctr.encrypt(plainTextBytes,initialVectorBytes);assertEquals("Encrypted bytes should match cipher text.",goog.crypt.byteArrayToHex(encryptedBytes),goog.crypt.byteArrayToHex(cipherTextBytes));var decryptedBytes=Ctr.decrypt(cipherTextBytes,initialVectorBytes);assertEquals("Decrypted bytes should match plain text.",goog.crypt.byteArrayToHex(decryptedBytes),goog.crypt.byteArrayToHex(plainTextBytes))}function assertIncEquals(toIncrement,expectedResult){var counter=goog.crypt.hexToByteArray(toIncrement);goog.crypt.Ctr.incrementBigEndianCounter_(counter);assertEquals(expectedResult,goog.crypt.byteArrayToHex(counter))}function testIncrementCounter(){assertIncEquals("","");assertIncEquals("00","01");assertIncEquals("09","0a");assertIncEquals("0e","0f");assertIncEquals("0f","10");assertIncEquals("1f","20");assertIncEquals("ff","00");assertIncEquals("0000","0001");assertIncEquals("00f0","00f1");assertIncEquals("00ff","0100");assertIncEquals("0f00","0f01");assertIncEquals("0fff","1000");assertIncEquals("1000","1001");assertIncEquals("ff00","ff01");assertIncEquals("ff0f","ff10");assertIncEquals("ffff","0000");assertIncEquals("ffffffffffffffffffffffffffffffffffffffffffffffff","000000000000000000000000000000000000000000000000")}function testAes128CtrCipherAlgorithm(){runCtrAesTest(goog.crypt.hexToByteArray("2b7e151628aed2a6abf7158809cf4f3c"),goog.crypt.hexToByteArray("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"),goog.crypt.hexToByteArray("6bc1bee22e409f96e93d7e117393172a"),goog.crypt.hexToByteArray("874d6191b620e3261bef6864990db6ce"));runCtrAesTest(goog.crypt.hexToByteArray("2b7e151628aed2a6abf7158809cf4f3c"),goog.crypt.hexToByteArray("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"),goog.crypt.hexToByteArray("6bc1bee22e409f96e93d7e117393172a"+"ae2d8a571e03ac9c9eb76fac45af8e51"+"30c81c46a35ce411e5fbc1191a0a52ef"),goog.crypt.hexToByteArray("874d6191b620e3261bef6864990db6ce"+"9806f66b7970fdff8617187bb9fffdff"+"5ae4df3edbd5d35e5b4f09020db03eab"));runCtrAesTest(goog.crypt.hexToByteArray("2b7e151628aed2a6abf7158809cf4f3c"),goog.crypt.hexToByteArray("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"),goog.crypt.hexToByteArray("6bc1bee22e409f96e93d7e117393172a"+"ae2d8a571e03ac9c9eb76fac45af8e51"+"30c81c"),goog.crypt.hexToByteArray("874d6191b620e3261bef6864990db6ce"+"9806f66b7970fdff8617187bb9fffdff"+"5ae4df"))}function testAes192CtrCipherAlgorithm(){runCtrAesTest(goog.crypt.hexToByteArray("8e73b0f7da0e6452c810f32b809079e5"+"62f8ead2522c6b7b"),goog.crypt.hexToByteArray("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"),goog.crypt.hexToByteArray("6bc1bee22e409f96e93d7e117393172a"),goog.crypt.hexToByteArray("1abc932417521ca24f2b0459fe7e6e0b"));runCtrAesTest(goog.crypt.hexToByteArray("8e73b0f7da0e6452c810f32b809079e5"+"62f8ead2522c6b7b"),goog.crypt.hexToByteArray("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"),goog.crypt.hexToByteArray("6bc1bee22e409f96e93d7e117393172a"+"ae2d8a571e03ac9c9eb76fac45af8e51"+"30c81c46a35ce411e5fbc1191a0a52ef"),goog.crypt.hexToByteArray("1abc932417521ca24f2b0459fe7e6e0b"+"090339ec0aa6faefd5ccc2c6f4ce8e94"+"1e36b26bd1ebc670d1bd1d665620abf7"))}function testAes256CtrCipherAlgorithm(){runCtrAesTest(goog.crypt.hexToByteArray("603deb1015ca71be2b73aef0857d7781"+"1f352c073b6108d72d9810a30914dff4"),goog.crypt.hexToByteArray("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"),goog.crypt.hexToByteArray("6bc1bee22e409f96e93d7e117393172a"),goog.crypt.hexToByteArray("601ec313775789a5b7a7f504bbf3d228"));runCtrAesTest(goog.crypt.hexToByteArray("603deb1015ca71be2b73aef0857d7781"+"1f352c073b6108d72d9810a30914dff4"),goog.crypt.hexToByteArray("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"),goog.crypt.hexToByteArray("6bc1bee22e409f96e93d7e117393172a"+"ae2d8a571e03ac9c9eb76fac45af8e51"+"30c81c46a35ce411e5fbc1191a0a52ef"),goog.crypt.hexToByteArray("601ec313775789a5b7a7f504bbf3d228"+"f443e3ca4d62b59aca84e990cacaf5c5"+"2b0930daa23de94ce87017ba2d84988d"));runCtrAesTest(goog.crypt.hexToByteArray("603deb1015ca71be2b73aef0857d7781"+"1f352c073b6108d72d9810a30914dff4"),goog.crypt.hexToByteArray("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"),goog.crypt.hexToByteArray("6bc1bee22e409f96e93d7e117393172a"+"ae2d8a571e03ac9c9eb76fac45af8e51"+"30c81c46a35ce411e5fbc1191a0a52"),goog.crypt.hexToByteArray("601ec313775789a5b7a7f504bbf3d228"+"f443e3ca4d62b59aca84e990cacaf5c5"+"2b0930daa23de94ce87017ba2d8498"))}