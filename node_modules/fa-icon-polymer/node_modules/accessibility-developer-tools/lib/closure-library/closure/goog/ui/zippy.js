goog.provide("goog.ui.Zippy");goog.provide("goog.ui.Zippy.Events");goog.provide("goog.ui.ZippyEvent");goog.require("goog.a11y.aria");goog.require("goog.a11y.aria.Role");goog.require("goog.a11y.aria.State");goog.require("goog.dom");goog.require("goog.dom.classlist");goog.require("goog.events.Event");goog.require("goog.events.EventHandler");goog.require("goog.events.EventTarget");goog.require("goog.events.EventType");goog.require("goog.events.KeyCodes");goog.require("goog.events.KeyHandler");goog.require("goog.style");goog.ui.Zippy=function(header,opt_content,opt_expanded,opt_expandedHeader,opt_domHelper){goog.ui.Zippy.base(this,"constructor");this.dom_=opt_domHelper||goog.dom.getDomHelper();this.elHeader_=this.dom_.getElement(header)||null;this.elExpandedHeader_=this.dom_.getElement(opt_expandedHeader||null);this.lazyCreateFunc_=goog.isFunction(opt_content)?opt_content:null;this.elContent_=this.lazyCreateFunc_||!opt_content?null:this.dom_.getElement(opt_content);this.expanded_=!0==opt_expanded;if(!goog.isDef(opt_expanded)&&!this.lazyCreateFunc_){if(this.elExpandedHeader_){this.expanded_=goog.style.isElementShown(this.elExpandedHeader_)}else if(this.elHeader_){this.expanded_=goog.dom.classlist.contains(this.elHeader_,goog.getCssName("goog-zippy-expanded"))}}this.keyboardEventHandler_=new goog.events.EventHandler(this);this.keyHandler_=new goog.events.KeyHandler;this.mouseEventHandler_=new goog.events.EventHandler(this);var self=this;function addHeaderEvents(el){if(el){el.tabIndex=0;goog.a11y.aria.setRole(el,self.getAriaRole());goog.dom.classlist.add(el,goog.getCssName("goog-zippy-header"));self.enableMouseEventsHandling_(el);self.enableKeyboardEventsHandling_(el)}}addHeaderEvents(this.elHeader_);addHeaderEvents(this.elExpandedHeader_);this.setExpanded(this.expanded_)};goog.inherits(goog.ui.Zippy,goog.events.EventTarget);goog.tagUnsealableClass(goog.ui.Zippy);goog.ui.Zippy.Events={ACTION:"action",TOGGLE:"toggle"};goog.ui.Zippy.prototype.handleMouseEvents_=!0;goog.ui.Zippy.prototype.handleKeyEvents_=!0;goog.ui.Zippy.prototype.disposeInternal=function(){goog.ui.Zippy.base(this,"disposeInternal");goog.dispose(this.keyboardEventHandler_);goog.dispose(this.keyHandler_);goog.dispose(this.mouseEventHandler_)};goog.ui.Zippy.prototype.getAriaRole=function(){return goog.a11y.aria.Role.TAB};goog.ui.Zippy.prototype.getContentElement=function(){return this.elContent_};goog.ui.Zippy.prototype.getVisibleHeaderElement=function(){var expandedHeader=this.elExpandedHeader_;return expandedHeader&&goog.style.isElementShown(expandedHeader)?expandedHeader:this.elHeader_};goog.ui.Zippy.prototype.expand=function(){this.setExpanded(!0)};goog.ui.Zippy.prototype.collapse=function(){this.setExpanded(!1)};goog.ui.Zippy.prototype.toggle=function(){this.setExpanded(!this.expanded_)};goog.ui.Zippy.prototype.setExpanded=function(expanded){if(this.elContent_){goog.style.setElementShown(this.elContent_,expanded)}else if(expanded&&this.lazyCreateFunc_){this.elContent_=this.lazyCreateFunc_()}if(this.elContent_){goog.dom.classlist.add(this.elContent_,goog.getCssName("goog-zippy-content"))}if(this.elExpandedHeader_){goog.style.setElementShown(this.elHeader_,!expanded);goog.style.setElementShown(this.elExpandedHeader_,expanded)}else{this.updateHeaderClassName(expanded)}this.setExpandedInternal(expanded);this.dispatchEvent(new goog.ui.ZippyEvent(goog.ui.Zippy.Events.TOGGLE,this,this.expanded_))};goog.ui.Zippy.prototype.setExpandedInternal=function(expanded){this.expanded_=expanded};goog.ui.Zippy.prototype.isExpanded=function(){return this.expanded_};goog.ui.Zippy.prototype.updateHeaderClassName=function(expanded){if(this.elHeader_){goog.dom.classlist.enable(this.elHeader_,goog.getCssName("goog-zippy-expanded"),expanded);goog.dom.classlist.enable(this.elHeader_,goog.getCssName("goog-zippy-collapsed"),!expanded);goog.a11y.aria.setState(this.elHeader_,goog.a11y.aria.State.EXPANDED,expanded)}};goog.ui.Zippy.prototype.isHandleKeyEvents=function(){return this.handleKeyEvents_};goog.ui.Zippy.prototype.isHandleMouseEvents=function(){return this.handleMouseEvents_};goog.ui.Zippy.prototype.setHandleKeyboardEvents=function(enable){if(this.handleKeyEvents_!=enable){this.handleKeyEvents_=enable;if(enable){this.enableKeyboardEventsHandling_(this.elHeader_);this.enableKeyboardEventsHandling_(this.elExpandedHeader_)}else{this.keyboardEventHandler_.removeAll();this.keyHandler_.detach()}}};goog.ui.Zippy.prototype.setHandleMouseEvents=function(enable){if(this.handleMouseEvents_!=enable){this.handleMouseEvents_=enable;if(enable){this.enableMouseEventsHandling_(this.elHeader_);this.enableMouseEventsHandling_(this.elExpandedHeader_)}else{this.mouseEventHandler_.removeAll()}}};goog.ui.Zippy.prototype.enableKeyboardEventsHandling_=function(header){if(header){this.keyHandler_.attach(header);this.keyboardEventHandler_.listen(this.keyHandler_,goog.events.KeyHandler.EventType.KEY,this.onHeaderKeyDown_)}};goog.ui.Zippy.prototype.enableMouseEventsHandling_=function(header){if(header){this.mouseEventHandler_.listen(header,goog.events.EventType.CLICK,this.onHeaderClick_)}};goog.ui.Zippy.prototype.onHeaderKeyDown_=function(event){if(event.keyCode==goog.events.KeyCodes.ENTER||event.keyCode==goog.events.KeyCodes.SPACE){this.toggle();this.dispatchActionEvent_();event.preventDefault();event.stopPropagation()}};goog.ui.Zippy.prototype.onHeaderClick_=function(event){this.toggle();this.dispatchActionEvent_()};goog.ui.Zippy.prototype.dispatchActionEvent_=function(){this.dispatchEvent(new goog.events.Event(goog.ui.Zippy.Events.ACTION,this))};goog.ui.ZippyEvent=function(type,target,expanded){goog.ui.ZippyEvent.base(this,"constructor",type,target);this.expanded=expanded};goog.inherits(goog.ui.ZippyEvent,goog.events.Event);