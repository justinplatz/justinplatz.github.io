goog.provide("goog.ui.DatePicker");goog.provide("goog.ui.DatePicker.Events");goog.provide("goog.ui.DatePickerEvent");goog.require("goog.a11y.aria");goog.require("goog.asserts");goog.require("goog.date.Date");goog.require("goog.date.DateRange");goog.require("goog.date.Interval");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.classlist");goog.require("goog.events.Event");goog.require("goog.events.EventType");goog.require("goog.events.KeyHandler");goog.require("goog.i18n.DateTimeFormat");goog.require("goog.i18n.DateTimePatterns");goog.require("goog.i18n.DateTimeSymbols");goog.require("goog.style");goog.require("goog.ui.Component");goog.require("goog.ui.DefaultDatePickerRenderer");goog.require("goog.ui.IdGenerator");goog.ui.DatePicker=function(opt_date,opt_dateTimeSymbols,opt_domHelper,opt_renderer){goog.ui.Component.call(this,opt_domHelper);this.symbols_=opt_dateTimeSymbols||goog.i18n.DateTimeSymbols;this.wdayNames_=this.symbols_.STANDALONESHORTWEEKDAYS;this.i18nDateFormatterDay_=new goog.i18n.DateTimeFormat("d",this.symbols_);this.i18nDateFormatterDay2_=new goog.i18n.DateTimeFormat("dd",this.symbols_);this.i18nDateFormatterWeek_=new goog.i18n.DateTimeFormat("w",this.symbols_);var patYear=goog.i18n.DateTimePatterns.YEAR_FULL||"y";this.i18nDateFormatterYear_=new goog.i18n.DateTimeFormat(patYear,this.symbols_);var patMMMMy=goog.i18n.DateTimePatterns.YEAR_MONTH_FULL||"MMMM y";this.i18nDateFormatterMonthYear_=new goog.i18n.DateTimeFormat(patMMMMy,this.symbols_);this.renderer_=opt_renderer||new goog.ui.DefaultDatePickerRenderer(this.getBaseCssClass(),this.getDomHelper());this.date_=new goog.date.Date(opt_date);this.date_.setFirstWeekCutOffDay(this.symbols_.FIRSTWEEKCUTOFFDAY);this.date_.setFirstDayOfWeek(this.symbols_.FIRSTDAYOFWEEK);this.activeMonth_=this.date_.clone();this.activeMonth_.setDate(1);this.wdayStyles_=["","","","","","",""];this.wdayStyles_[this.symbols_.WEEKENDRANGE[0]]=goog.getCssName(this.getBaseCssClass(),"wkend-start");this.wdayStyles_[this.symbols_.WEEKENDRANGE[1]]=goog.getCssName(this.getBaseCssClass(),"wkend-end");this.keyHandlers_={};this.grid_=[];this.elTable_;this.tableBody_;this.tableFoot_;this.elYear_;this.elMonth_;this.elToday_;this.elNone_;this.menu_;this.menuSelected_;this.menuCallback_};goog.inherits(goog.ui.DatePicker,goog.ui.Component);goog.tagUnsealableClass(goog.ui.DatePicker);goog.ui.DatePicker.prototype.showFixedNumWeeks_=!0;goog.ui.DatePicker.prototype.showOtherMonths_=!0;goog.ui.DatePicker.prototype.userSelectableDateRange_=goog.date.DateRange.allTime();goog.ui.DatePicker.prototype.extraWeekAtEnd_=!0;goog.ui.DatePicker.prototype.showWeekNum_=!0;goog.ui.DatePicker.prototype.showWeekdays_=!0;goog.ui.DatePicker.prototype.allowNone_=!0;goog.ui.DatePicker.prototype.showToday_=!0;goog.ui.DatePicker.prototype.simpleNavigation_=!1;goog.ui.DatePicker.prototype.decoratorFunction_=null;goog.ui.DatePicker.prototype.longDateFormat_=!1;goog.ui.DatePicker.prototype.elNavRow_=null;goog.ui.DatePicker.prototype.elMonthYear_=null;goog.ui.DatePicker.prototype.elFootRow_=null;goog.ui.DatePicker.prototype.cellIdGenerator_=goog.ui.IdGenerator.getInstance();goog.ui.DatePicker.BASE_CSS_CLASS_=goog.getCssName("goog-date-picker");goog.ui.DatePicker.YEAR_MENU_RANGE_=5;goog.ui.DatePicker.Events={CHANGE:"change",CHANGE_ACTIVE_MONTH:"changeActiveMonth",SELECT:"select"};goog.ui.DatePicker.prototype.isCreated=goog.ui.DatePicker.prototype.isInDocument;goog.ui.DatePicker.prototype.getFirstWeekday=function(){return this.activeMonth_.getFirstDayOfWeek()};goog.ui.DatePicker.prototype.getWeekdayClass=function(wday){return this.wdayStyles_[wday]};goog.ui.DatePicker.prototype.getShowFixedNumWeeks=function(){return this.showFixedNumWeeks_};goog.ui.DatePicker.prototype.getShowOtherMonths=function(){return this.showOtherMonths_};goog.ui.DatePicker.prototype.getExtraWeekAtEnd=function(){return this.extraWeekAtEnd_};goog.ui.DatePicker.prototype.getShowWeekNum=function(){return this.showWeekNum_};goog.ui.DatePicker.prototype.getShowWeekdayNames=function(){return this.showWeekdays_};goog.ui.DatePicker.prototype.getAllowNone=function(){return this.allowNone_};goog.ui.DatePicker.prototype.getShowToday=function(){return this.showToday_};goog.ui.DatePicker.prototype.getBaseCssClass=function(){return goog.ui.DatePicker.BASE_CSS_CLASS_};goog.ui.DatePicker.prototype.setFirstWeekday=function(wday){this.activeMonth_.setFirstDayOfWeek(wday);this.updateCalendarGrid_();this.redrawWeekdays_()};goog.ui.DatePicker.prototype.setWeekdayClass=function(wday,className){this.wdayStyles_[wday]=className;this.redrawCalendarGrid_()};goog.ui.DatePicker.prototype.setShowFixedNumWeeks=function(b){this.showFixedNumWeeks_=b;this.updateCalendarGrid_()};goog.ui.DatePicker.prototype.setShowOtherMonths=function(b){this.showOtherMonths_=b;this.redrawCalendarGrid_()};goog.ui.DatePicker.prototype.setUserSelectableDateRange=function(dateRange){this.userSelectableDateRange_=dateRange};goog.ui.DatePicker.prototype.getUserSelectableDateRange=function(){return this.userSelectableDateRange_};goog.ui.DatePicker.prototype.isUserSelectableDate_=function(date){return this.userSelectableDateRange_.contains(date)};goog.ui.DatePicker.prototype.setUseSimpleNavigationMenu=function(b){this.simpleNavigation_=b;this.updateNavigationRow_();this.updateCalendarGrid_()};goog.ui.DatePicker.prototype.setExtraWeekAtEnd=function(b){this.extraWeekAtEnd_=b;this.updateCalendarGrid_()};goog.ui.DatePicker.prototype.setShowWeekNum=function(b){this.showWeekNum_=b;this.updateNavigationRow_();this.updateFooterRow_();this.updateCalendarGrid_()};goog.ui.DatePicker.prototype.setShowWeekdayNames=function(b){this.showWeekdays_=b;this.redrawWeekdays_();this.redrawCalendarGrid_()};goog.ui.DatePicker.prototype.setUseNarrowWeekdayNames=function(b){this.wdayNames_=b?this.symbols_.STANDALONENARROWWEEKDAYS:this.symbols_.STANDALONESHORTWEEKDAYS;this.redrawWeekdays_()};goog.ui.DatePicker.prototype.setAllowNone=function(b){this.allowNone_=b;if(this.elNone_){this.updateTodayAndNone_()}};goog.ui.DatePicker.prototype.setShowToday=function(b){this.showToday_=b;if(this.elToday_){this.updateTodayAndNone_()}};goog.ui.DatePicker.prototype.updateTodayAndNone_=function(){goog.style.setElementShown(this.elToday_,this.showToday_);goog.style.setElementShown(this.elNone_,this.allowNone_);goog.style.setElementShown(this.tableFoot_,this.showToday_||this.allowNone_)};goog.ui.DatePicker.prototype.setDecorator=function(f){this.decoratorFunction_=f};goog.ui.DatePicker.prototype.setLongDateFormat=function(b){this.longDateFormat_=b;this.redrawCalendarGrid_()};goog.ui.DatePicker.prototype.previousMonth=function(){this.activeMonth_.add(new goog.date.Interval(goog.date.Interval.MONTHS,-1));this.updateCalendarGrid_();this.fireChangeActiveMonthEvent_()};goog.ui.DatePicker.prototype.nextMonth=function(){this.activeMonth_.add(new goog.date.Interval(goog.date.Interval.MONTHS,1));this.updateCalendarGrid_();this.fireChangeActiveMonthEvent_()};goog.ui.DatePicker.prototype.previousYear=function(){this.activeMonth_.add(new goog.date.Interval(goog.date.Interval.YEARS,-1));this.updateCalendarGrid_();this.fireChangeActiveMonthEvent_()};goog.ui.DatePicker.prototype.nextYear=function(){this.activeMonth_.add(new goog.date.Interval(goog.date.Interval.YEARS,1));this.updateCalendarGrid_();this.fireChangeActiveMonthEvent_()};goog.ui.DatePicker.prototype.selectToday=function(){this.setDate(new goog.date.Date)};goog.ui.DatePicker.prototype.selectNone=function(){if(this.allowNone_){this.setDate(null)}};goog.ui.DatePicker.prototype.getActiveMonth=function(){return this.activeMonth_.clone()};goog.ui.DatePicker.prototype.getDate=function(){return this.date_&&this.date_.clone()};goog.ui.DatePicker.prototype.getDateAt=function(row,col){return this.grid_[row]?this.grid_[row][col]?this.grid_[row][col].clone():null:null};goog.ui.DatePicker.prototype.getDateElementAt=function(row,col){if(0>row||0>col){return null}var adjustedRow=row+1;return this.elTable_[adjustedRow]?this.elTable_[adjustedRow][col+1]||null:null};goog.ui.DatePicker.prototype.setDate=function(date){this.setDate_(date,!0)};goog.ui.DatePicker.prototype.setDate_=function(date,fireSelection){var sameMonth=date==this.date_||date&&this.date_&&date.getFullYear()==this.date_.getFullYear()&&date.getMonth()==this.date_.getMonth(),sameDate=date==this.date_||sameMonth&&date.getDate()==this.date_.getDate();this.date_=date&&new goog.date.Date(date);if(date){this.activeMonth_.set(this.date_);this.activeMonth_.setFullYear(this.date_.getFullYear());this.activeMonth_.setDate(1)}this.updateCalendarGrid_();if(fireSelection){var selectEvent=new goog.ui.DatePickerEvent(goog.ui.DatePicker.Events.SELECT,this,this.date_);this.dispatchEvent(selectEvent)}if(!sameDate){var changeEvent=new goog.ui.DatePickerEvent(goog.ui.DatePicker.Events.CHANGE,this,this.date_);this.dispatchEvent(changeEvent)}if(!sameMonth){this.fireChangeActiveMonthEvent_()}};goog.ui.DatePicker.prototype.updateNavigationRow_=function(){if(!this.elNavRow_){return}var row=this.elNavRow_;while(row.firstChild){row.removeChild(row.firstChild)}var fullDateFormat=this.symbols_.DATEFORMATS[goog.i18n.DateTimeFormat.Format.FULL_DATE].toLowerCase();this.renderer_.renderNavigationRow(row,this.simpleNavigation_,this.showWeekNum_,fullDateFormat);if(this.simpleNavigation_){this.addPreventDefaultClickHandler_(row,goog.getCssName(this.getBaseCssClass(),"previousMonth"),this.previousMonth);this.addPreventDefaultClickHandler_(row,goog.getCssName(this.getBaseCssClass(),"nextMonth"),this.nextMonth);this.elMonthYear_=goog.dom.getElementByClass(goog.getCssName(this.getBaseCssClass(),"monthyear"),row)}else{this.addPreventDefaultClickHandler_(row,goog.getCssName(this.getBaseCssClass(),"previousMonth"),this.previousMonth);this.addPreventDefaultClickHandler_(row,goog.getCssName(this.getBaseCssClass(),"nextMonth"),this.nextMonth);this.addPreventDefaultClickHandler_(row,goog.getCssName(this.getBaseCssClass(),"month"),this.showMonthMenu_);this.addPreventDefaultClickHandler_(row,goog.getCssName(this.getBaseCssClass(),"previousYear"),this.previousYear);this.addPreventDefaultClickHandler_(row,goog.getCssName(this.getBaseCssClass(),"nextYear"),this.nextYear);this.addPreventDefaultClickHandler_(row,goog.getCssName(this.getBaseCssClass(),"year"),this.showYearMenu_);this.elMonth_=goog.dom.getElementByClass(goog.getCssName(this.getBaseCssClass(),"month"),row);this.elYear_=goog.dom.getDomHelper().getElementByClass(goog.getCssName(this.getBaseCssClass(),"year"),row)}};goog.ui.DatePicker.prototype.addPreventDefaultClickHandler_=function(parentElement,cssName,handlerFunction){var element=goog.dom.getElementByClass(cssName,parentElement);this.getHandler().listen(element,goog.events.EventType.CLICK,function(e){e.preventDefault();handlerFunction.call(this,e)})};goog.ui.DatePicker.prototype.updateFooterRow_=function(){if(!this.elFootRow_){return}var row=this.elFootRow_;goog.dom.removeChildren(row);this.renderer_.renderFooterRow(row,this.showWeekNum_);this.addPreventDefaultClickHandler_(row,goog.getCssName(this.getBaseCssClass(),"today-btn"),this.selectToday);this.addPreventDefaultClickHandler_(row,goog.getCssName(this.getBaseCssClass(),"none-btn"),this.selectNone);this.elToday_=goog.dom.getElementByClass(goog.getCssName(this.getBaseCssClass(),"today-btn"),row);this.elNone_=goog.dom.getElementByClass(goog.getCssName(this.getBaseCssClass(),"none-btn"),row);this.updateTodayAndNone_()};goog.ui.DatePicker.prototype.decorateInternal=function(el){goog.ui.DatePicker.superClass_.decorateInternal.call(this,el);goog.asserts.assert(el);goog.dom.classlist.add(el,this.getBaseCssClass());var table=this.dom_.createElement(goog.dom.TagName.TABLE),thead=this.dom_.createElement(goog.dom.TagName.THEAD),tbody=this.dom_.createElement(goog.dom.TagName.TBODY),tfoot=this.dom_.createElement(goog.dom.TagName.TFOOT);goog.a11y.aria.setRole(tbody,"grid");tbody.tabIndex=0;this.tableBody_=tbody;this.tableFoot_=tfoot;var row=this.dom_.createElement(goog.dom.TagName.TR);row.className=goog.getCssName(this.getBaseCssClass(),"head");this.elNavRow_=row;this.updateNavigationRow_();thead.appendChild(row);var cell;this.elTable_=[];for(var i=0;7>i;i++){row=this.dom_.createElement(goog.dom.TagName.TR);this.elTable_[i]=[];for(var j=0;8>j;j++){cell=this.dom_.createElement(0==j||0==i?"th":"td");if((0==j||0==i)&&j!=i){cell.className=0==j?goog.getCssName(this.getBaseCssClass(),"week"):goog.getCssName(this.getBaseCssClass(),"wday");goog.a11y.aria.setRole(cell,0==j?"rowheader":"columnheader")}row.appendChild(cell);this.elTable_[i][j]=cell}tbody.appendChild(row)}row=this.dom_.createElement(goog.dom.TagName.TR);row.className=goog.getCssName(this.getBaseCssClass(),"foot");this.elFootRow_=row;this.updateFooterRow_();tfoot.appendChild(row);table.cellSpacing="0";table.cellPadding="0";table.appendChild(thead);table.appendChild(tbody);table.appendChild(tfoot);el.appendChild(table);this.redrawWeekdays_();this.updateCalendarGrid_();el.tabIndex=0};goog.ui.DatePicker.prototype.createDom=function(){goog.ui.DatePicker.superClass_.createDom.call(this);this.decorateInternal(this.getElement())};goog.ui.DatePicker.prototype.enterDocument=function(){goog.ui.DatePicker.superClass_.enterDocument.call(this);var eh=this.getHandler();eh.listen(this.tableBody_,goog.events.EventType.CLICK,this.handleGridClick_);eh.listen(this.getKeyHandlerForElement_(this.getElement()),goog.events.KeyHandler.EventType.KEY,this.handleGridKeyPress_)};goog.ui.DatePicker.prototype.exitDocument=function(){goog.ui.DatePicker.superClass_.exitDocument.call(this);this.destroyMenu_();for(var uid in this.keyHandlers_){this.keyHandlers_[uid].dispose()}this.keyHandlers_={}};goog.ui.DatePicker.prototype.create=goog.ui.DatePicker.prototype.decorate;goog.ui.DatePicker.prototype.disposeInternal=function(){goog.ui.DatePicker.superClass_.disposeInternal.call(this);this.elTable_=null;this.tableBody_=null;this.tableFoot_=null;this.elNavRow_=null;this.elFootRow_=null;this.elMonth_=null;this.elMonthYear_=null;this.elYear_=null;this.elToday_=null;this.elNone_=null};goog.ui.DatePicker.prototype.handleGridClick_=function(event){if(event.target.tagName==goog.dom.TagName.TD){var el,x=-2,y=-2;for(el=event.target;el;el=el.previousSibling,x++){}for(el=event.target.parentNode;el;el=el.previousSibling,y++){}var obj=this.grid_[y][x];if(this.isUserSelectableDate_(obj)){this.setDate(obj.clone())}}};goog.ui.DatePicker.prototype.handleGridKeyPress_=function(event){var months,days;switch(event.keyCode){case 33:event.preventDefault();months=-1;break;case 34:event.preventDefault();months=1;break;case 37:event.preventDefault();days=-1;break;case 39:event.preventDefault();days=1;break;case 38:event.preventDefault();days=-7;break;case 40:event.preventDefault();days=7;break;case 36:event.preventDefault();this.selectToday();case 46:event.preventDefault();this.selectNone();break;case 13:case 32:event.preventDefault();this.setDate_(this.date_,!0);default:return;}var date;if(this.date_){date=this.date_.clone();date.add(new goog.date.Interval(0,months,days))}else{date=this.activeMonth_.clone();date.setDate(1)}if(this.isUserSelectableDate_(date)){this.setDate_(date,!1)}};goog.ui.DatePicker.prototype.showMonthMenu_=function(event){event.stopPropagation();for(var list=[],i=0;12>i;i++){list.push(this.symbols_.STANDALONEMONTHS[i])}this.createMenu_(this.elMonth_,list,this.handleMonthMenuClick_,this.symbols_.STANDALONEMONTHS[this.activeMonth_.getMonth()])};goog.ui.DatePicker.prototype.showYearMenu_=function(event){event.stopPropagation();for(var list=[],year=this.activeMonth_.getFullYear(),loopDate=this.activeMonth_.clone(),i=-goog.ui.DatePicker.YEAR_MENU_RANGE_;i<=goog.ui.DatePicker.YEAR_MENU_RANGE_;i++){loopDate.setFullYear(year+i);list.push(this.i18nDateFormatterYear_.format(loopDate))}this.createMenu_(this.elYear_,list,this.handleYearMenuClick_,this.i18nDateFormatterYear_.format(this.activeMonth_))};goog.ui.DatePicker.prototype.handleMonthMenuClick_=function(target){var itemIndex=+target.getAttribute("itemIndex");this.activeMonth_.setMonth(itemIndex);this.updateCalendarGrid_();if(this.elMonth_.focus){this.elMonth_.focus()}};goog.ui.DatePicker.prototype.handleYearMenuClick_=function(target){if(target.firstChild.nodeType==goog.dom.NodeType.TEXT){var itemIndex=+target.getAttribute("itemIndex"),year=this.activeMonth_.getFullYear();this.activeMonth_.setFullYear(year+itemIndex-goog.ui.DatePicker.YEAR_MENU_RANGE_);this.updateCalendarGrid_()}this.elYear_.focus()};goog.ui.DatePicker.prototype.createMenu_=function(srcEl,items,method,selected){this.destroyMenu_();var el=this.dom_.createElement(goog.dom.TagName.DIV);el.className=goog.getCssName(this.getBaseCssClass(),"menu");this.menuSelected_=null;for(var ul=this.dom_.createElement(goog.dom.TagName.UL),i=0,li;i<items.length;i++){li=this.dom_.createDom(goog.dom.TagName.LI,null,items[i]);li.setAttribute("itemIndex",i);if(items[i]==selected){this.menuSelected_=li}ul.appendChild(li)}el.appendChild(ul);srcEl=srcEl;el.style.left=srcEl.offsetLeft+srcEl.parentNode.offsetLeft+"px";el.style.top=srcEl.offsetTop+"px";el.style.width=srcEl.clientWidth+"px";this.elMonth_.parentNode.appendChild(el);this.menu_=el;if(!this.menuSelected_){this.menuSelected_=ul.firstChild}this.menuSelected_.className=goog.getCssName(this.getBaseCssClass(),"menu-selected");this.menuCallback_=method;var eh=this.getHandler();eh.listen(this.menu_,goog.events.EventType.CLICK,this.handleMenuClick_);eh.listen(this.getKeyHandlerForElement_(this.menu_),goog.events.KeyHandler.EventType.KEY,this.handleMenuKeyPress_);eh.listen(this.dom_.getDocument(),goog.events.EventType.CLICK,this.destroyMenu_);el.tabIndex=0;el.focus()};goog.ui.DatePicker.prototype.handleMenuClick_=function(event){event.stopPropagation();this.destroyMenu_();if(this.menuCallback_){this.menuCallback_(event.target)}};goog.ui.DatePicker.prototype.handleMenuKeyPress_=function(event){event.stopPropagation();var el,menuSelected=this.menuSelected_;switch(event.keyCode){case 35:event.preventDefault();el=menuSelected.parentNode.lastChild;break;case 36:event.preventDefault();el=menuSelected.parentNode.firstChild;break;case 38:event.preventDefault();el=menuSelected.previousSibling;break;case 40:event.preventDefault();el=menuSelected.nextSibling;break;case 13:case 9:case 0:event.preventDefault();this.destroyMenu_();this.menuCallback_(menuSelected);break;}if(el&&el!=menuSelected){menuSelected.className="";el.className=goog.getCssName(this.getBaseCssClass(),"menu-selected");this.menuSelected_=el}};goog.ui.DatePicker.prototype.destroyMenu_=function(){if(this.menu_){var eh=this.getHandler();eh.unlisten(this.menu_,goog.events.EventType.CLICK,this.handleMenuClick_);eh.unlisten(this.getKeyHandlerForElement_(this.menu_),goog.events.KeyHandler.EventType.KEY,this.handleMenuKeyPress_);eh.unlisten(this.dom_.getDocument(),goog.events.EventType.CLICK,this.destroyMenu_);goog.dom.removeNode(this.menu_);delete this.menu_}};goog.ui.DatePicker.prototype.updateCalendarGrid_=function(){if(!this.getElement()){return}var date=this.activeMonth_.clone();date.setDate(1);if(this.elMonthYear_){goog.dom.setTextContent(this.elMonthYear_,this.i18nDateFormatterMonthYear_.format(date))}if(this.elMonth_){goog.dom.setTextContent(this.elMonth_,this.symbols_.STANDALONEMONTHS[date.getMonth()])}if(this.elYear_){goog.dom.setTextContent(this.elYear_,this.i18nDateFormatterYear_.format(date))}var wday=date.getWeekday(),days=date.getNumberOfDaysInMonth();date.add(new goog.date.Interval(goog.date.Interval.MONTHS,-1));date.setDate(date.getNumberOfDaysInMonth()-(wday-1));if(this.showFixedNumWeeks_&&!this.extraWeekAtEnd_&&33>days+wday){date.add(new goog.date.Interval(goog.date.Interval.DAYS,-7))}var dayInterval=new goog.date.Interval(goog.date.Interval.DAYS,1);this.grid_=[];for(var y=0;6>y;y++){this.grid_[y]=[];for(var x=0;7>x;x++){this.grid_[y][x]=date.clone();var year=date.getFullYear();date.add(dayInterval);if(0==date.getMonth()&&1==date.getDate()){year++}date.setFullYear(year)}}this.redrawCalendarGrid_()};goog.ui.DatePicker.prototype.redrawCalendarGrid_=function(){if(!this.getElement()){return}for(var month=this.activeMonth_.getMonth(),today=new goog.date.Date,todayYear=today.getFullYear(),todayMonth=today.getMonth(),todayDate=today.getDate(),y=0;6>y;y++){if(this.showWeekNum_){goog.dom.setTextContent(this.elTable_[y+1][0],this.i18nDateFormatterWeek_.format(this.grid_[y][0]));goog.dom.classlist.set(this.elTable_[y+1][0],goog.getCssName(this.getBaseCssClass(),"week"))}else{goog.dom.setTextContent(this.elTable_[y+1][0],"");goog.dom.classlist.set(this.elTable_[y+1][0],"")}for(var x=0;7>x;x++){var o=this.grid_[y][x],el=this.elTable_[y+1][x+1];if(!el.id){el.id=this.cellIdGenerator_.getNextUniqueId()}goog.asserts.assert(el,"The table DOM element cannot be null.");goog.a11y.aria.setRole(el,"gridcell");var classes=[goog.getCssName(this.getBaseCssClass(),"date")];if(!this.isUserSelectableDate_(o)){classes.push(goog.getCssName(this.getBaseCssClass(),"unavailable-date"))}if(this.showOtherMonths_||o.getMonth()==month){if(o.getMonth()!=month){classes.push(goog.getCssName(this.getBaseCssClass(),"other-month"))}var wday=(x+this.activeMonth_.getFirstDayOfWeek()+7)%7;if(this.wdayStyles_[wday]){classes.push(this.wdayStyles_[wday])}if(o.getDate()==todayDate&&o.getMonth()==todayMonth&&o.getFullYear()==todayYear){classes.push(goog.getCssName(this.getBaseCssClass(),"today"))}if(this.date_&&o.getDate()==this.date_.getDate()&&o.getMonth()==this.date_.getMonth()&&o.getFullYear()==this.date_.getFullYear()){classes.push(goog.getCssName(this.getBaseCssClass(),"selected"));goog.asserts.assert(this.tableBody_,"The table body DOM element cannot be null");goog.a11y.aria.setState(this.tableBody_,"activedescendant",el.id)}if(this.decoratorFunction_){var customClass=this.decoratorFunction_(o);if(customClass){classes.push(customClass)}}var formatedDate=this.longDateFormat_?this.i18nDateFormatterDay2_.format(o):this.i18nDateFormatterDay_.format(o);goog.dom.setTextContent(el,formatedDate)}else{goog.dom.setTextContent(el,"")}goog.dom.classlist.set(el,classes.join(" "))}if(4<=y){var parentEl=this.elTable_[y+1][0].parentElement||this.elTable_[y+1][0].parentNode;goog.style.setElementShown(parentEl,this.grid_[y][0].getMonth()==month||this.showFixedNumWeeks_)}}};goog.ui.DatePicker.prototype.fireChangeActiveMonthEvent_=function(){var changeMonthEvent=new goog.ui.DatePickerEvent(goog.ui.DatePicker.Events.CHANGE_ACTIVE_MONTH,this,this.getActiveMonth());this.dispatchEvent(changeMonthEvent)};goog.ui.DatePicker.prototype.redrawWeekdays_=function(){if(!this.getElement()){return}if(this.showWeekdays_){for(var x=0;7>x;x++){var el=this.elTable_[0][x+1],wday=(x+this.activeMonth_.getFirstDayOfWeek()+7)%7;goog.dom.setTextContent(el,this.wdayNames_[(wday+1)%7])}}var parentEl=this.elTable_[0][0].parentElement||this.elTable_[0][0].parentNode;goog.style.setElementShown(parentEl,this.showWeekdays_)};goog.ui.DatePicker.prototype.getKeyHandlerForElement_=function(el){var uid=goog.getUid(el);if(!(uid in this.keyHandlers_)){this.keyHandlers_[uid]=new goog.events.KeyHandler(el)}return this.keyHandlers_[uid]};goog.ui.DatePickerEvent=function(type,target,date){goog.events.Event.call(this,type,target);this.date=date};goog.inherits(goog.ui.DatePickerEvent,goog.events.Event);