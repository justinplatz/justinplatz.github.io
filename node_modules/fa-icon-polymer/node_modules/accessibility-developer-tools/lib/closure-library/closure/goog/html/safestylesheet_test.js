goog.provide("goog.html.safeStyleSheetTest");goog.require("goog.html.SafeStyleSheet");goog.require("goog.object");goog.require("goog.string.Const");goog.require("goog.testing.jsunit");goog.setTestOnly("goog.html.safeStyleSheetTest");function testSafeStyleSheet(){var styleSheet="P.special { color:red ; }",safeStyleSheet=goog.html.SafeStyleSheet.fromConstant(goog.string.Const.from(styleSheet)),extracted=goog.html.SafeStyleSheet.unwrap(safeStyleSheet);assertEquals(styleSheet,extracted);assertEquals(styleSheet,safeStyleSheet.getTypedStringValue());assertEquals("SafeStyleSheet{"+styleSheet+"}",safeStyleSheet+"");assertTrue(safeStyleSheet.implementsGoogStringTypedString)}function testUnwrap(){var privateFieldName="privateDoNotAccessOrElseSafeStyleSheetWrappedValue_",markerFieldName="SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_",propNames=goog.object.getKeys(goog.html.SafeStyleSheet.fromConstant(goog.string.Const.from("")));assertContains(privateFieldName,propNames);assertContains(markerFieldName,propNames);var evil={};evil[privateFieldName]="P.special { color:expression(evil) ; }";evil[markerFieldName]={};var exception=assertThrows(function(){goog.html.SafeStyleSheet.unwrap(evil)});assertContains("expected object of type SafeStyleSheet",exception.message)}function testFromConstant_allowsEmptyString(){assertEquals(goog.html.SafeStyleSheet.EMPTY,goog.html.SafeStyleSheet.fromConstant(goog.string.Const.from("")))}function testFromConstant_throwsOnLessThanCharacter(){assertThrows(function(){goog.html.SafeStyleSheet.fromConstant(goog.string.Const.from("x<x"))})}function testConcat(){var styleSheet1=goog.html.SafeStyleSheet.fromConstant(goog.string.Const.from("P.special { color:red ; }")),styleSheet2=goog.html.SafeStyleSheet.fromConstant(goog.string.Const.from("P.regular { color:blue ; }")),expected="P.special { color:red ; }P.special { color:red ; }"+"P.regular { color:blue ; }P.regular { color:blue ; }",concatStyleSheet=goog.html.SafeStyleSheet.concat(styleSheet1,[styleSheet1,styleSheet2],styleSheet2);assertEquals(expected,goog.html.SafeStyleSheet.unwrap(concatStyleSheet));concatStyleSheet=goog.html.SafeStyleSheet.concat();assertEquals("",goog.html.SafeStyleSheet.unwrap(concatStyleSheet));concatStyleSheet=goog.html.SafeStyleSheet.concat([]);assertEquals("",goog.html.SafeStyleSheet.unwrap(concatStyleSheet))}function testEmpty(){assertEquals("",goog.html.SafeStyleSheet.unwrap(goog.html.SafeStyleSheet.EMPTY))}