goog.provide("goog.html.safeScriptTest");goog.require("goog.html.SafeScript");goog.require("goog.object");goog.require("goog.string.Const");goog.require("goog.testing.jsunit");goog.setTestOnly("goog.html.safeScriptTest");function testSafeScript(){var script="var string = 'hello';",safeScript=goog.html.SafeScript.fromConstant(goog.string.Const.from(script)),extracted=goog.html.SafeScript.unwrap(safeScript);assertEquals(script,extracted);assertEquals(script,safeScript.getTypedStringValue());assertEquals("SafeScript{"+script+"}",safeScript+"");assertTrue(safeScript.implementsGoogStringTypedString)}function testUnwrap(){var privateFieldName="privateDoNotAccessOrElseSafeScriptWrappedValue_",markerFieldName="SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_",propNames=goog.object.getKeys(goog.html.SafeScript.fromConstant(goog.string.Const.from("")));assertContains(privateFieldName,propNames);assertContains(markerFieldName,propNames);var evil={};evil[privateFieldName]="var string = 'evil';";evil[markerFieldName]={};var exception=assertThrows(function(){goog.html.SafeScript.unwrap(evil)});assertContains("expected object of type SafeScript",exception.message)}function testFromConstant_allowsEmptyString(){assertEquals(goog.html.SafeScript.EMPTY,goog.html.SafeScript.fromConstant(goog.string.Const.from("")))}function testEmpty(){assertEquals("",goog.html.SafeScript.unwrap(goog.html.SafeScript.EMPTY))}