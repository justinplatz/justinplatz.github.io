goog.provide("goog.net.streams.Base64StreamDecoder");goog.require("goog.asserts");goog.require("goog.crypt.base64");goog.scope(function(){goog.net.streams.Base64StreamDecoder=function(){this.isInputValid_=!0;this.streamPos_=0;this.leftoverInput_=""};var Decoder=goog.net.streams.Base64StreamDecoder;Decoder.prototype.isInputValid=function(){return this.isInputValid_};Decoder.prototype.error_=function(input,errorMsg){this.isInputValid_=!1;throw Error("The stream is broken @"+this.streamPos_+". Error: "+errorMsg+". With input:\n"+input)};Decoder.prototype.decode=function(input){goog.asserts.assertString(input);if(!this.isInputValid_){this.error_(input,"stream already broken")}this.leftoverInput_+=input;var groups=Math.floor(this.leftoverInput_.length/4);if(0==groups){return null}try{var result=goog.crypt.base64.decodeStringToByteArray(this.leftoverInput_.substr(0,4*groups))}catch(e){this.error_(this.leftoverInput_,e.message)}this.streamPos_+=4*groups;this.leftoverInput_=this.leftoverInput_.substr(4*groups);return result}});