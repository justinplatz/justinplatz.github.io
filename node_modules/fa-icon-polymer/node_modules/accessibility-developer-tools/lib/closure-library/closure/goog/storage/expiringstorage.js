goog.provide("goog.storage.ExpiringStorage");goog.require("goog.storage.RichStorage");goog.storage.ExpiringStorage=function(mechanism){goog.storage.ExpiringStorage.base(this,"constructor",mechanism)};goog.inherits(goog.storage.ExpiringStorage,goog.storage.RichStorage);goog.storage.ExpiringStorage.EXPIRATION_TIME_KEY="expiration";goog.storage.ExpiringStorage.CREATION_TIME_KEY="creation";goog.storage.ExpiringStorage.getCreationTime=function(wrapper){return wrapper[goog.storage.ExpiringStorage.CREATION_TIME_KEY]};goog.storage.ExpiringStorage.getExpirationTime=function(wrapper){return wrapper[goog.storage.ExpiringStorage.EXPIRATION_TIME_KEY]};goog.storage.ExpiringStorage.isExpired=function(wrapper){var creation=goog.storage.ExpiringStorage.getCreationTime(wrapper),expiration=goog.storage.ExpiringStorage.getExpirationTime(wrapper);return!!expiration&&expiration<goog.now()||!!creation&&creation>goog.now()};goog.storage.ExpiringStorage.prototype.set=function(key,value,opt_expiration){var wrapper=goog.storage.RichStorage.Wrapper.wrapIfNecessary(value);if(wrapper){if(opt_expiration){if(opt_expiration<goog.now()){goog.storage.ExpiringStorage.prototype.remove.call(this,key);return}wrapper[goog.storage.ExpiringStorage.EXPIRATION_TIME_KEY]=opt_expiration}wrapper[goog.storage.ExpiringStorage.CREATION_TIME_KEY]=goog.now()}goog.storage.ExpiringStorage.base(this,"set",key,wrapper)};goog.storage.ExpiringStorage.prototype.getWrapper=function(key,opt_expired){var wrapper=goog.storage.ExpiringStorage.base(this,"getWrapper",key);if(!wrapper){return}if(!opt_expired&&goog.storage.ExpiringStorage.isExpired(wrapper)){goog.storage.ExpiringStorage.prototype.remove.call(this,key);return}return wrapper};