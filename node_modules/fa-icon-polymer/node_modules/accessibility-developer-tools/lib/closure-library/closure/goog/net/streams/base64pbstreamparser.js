goog.module("goog.net.streams.Base64PbStreamParser");var asserts=goog.require("goog.asserts"),Base64StreamDecoder=goog.require("goog.net.streams.Base64StreamDecoder"),PbStreamParser=goog.require("goog.net.streams.PbStreamParser"),StreamParser=goog.require("goog.net.streams.StreamParser"),Base64PbStreamParser=function(){this.errorMessage_=null;this.streamPos_=0;this.base64Decoder_=new Base64StreamDecoder;this.pbParser_=new PbStreamParser};Base64PbStreamParser.prototype.isInputValid=function(){return null===this.errorMessage_};Base64PbStreamParser.prototype.getErrorMessage=function(){return this.errorMessage_};Base64PbStreamParser.prototype.error_=function(input,errorMsg){this.errorMessage_="The stream is broken @"+this.streamPos_+". Error: "+errorMsg+". With input:\n"+input;throw Error(this.errorMessage_)};Base64PbStreamParser.prototype.parse=function(input){asserts.assertString(input);if(null!==this.errorMessage_){this.error_(input,"stream already broken")}var result=null;try{var rawBytes=this.base64Decoder_.decode(input);result=null===rawBytes?null:this.pbParser_.parse(rawBytes)}catch(e){this.error_(input,e.message)}this.streamPos_+=input.length;return result};exports=Base64PbStreamParser;