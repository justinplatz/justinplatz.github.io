goog.provide("goog.math.tdma");goog.math.tdma.solve=function(subDiag,mainDiag,supDiag,vecRight,opt_result){mainDiag=mainDiag.slice();vecRight=vecRight.slice();for(var nDim=mainDiag.length,i=1,m;i<nDim;++i){m=subDiag[i-1]/mainDiag[i-1];mainDiag[i]=mainDiag[i]-m*supDiag[i-1];vecRight[i]=vecRight[i]-m*vecRight[i-1]}var result=opt_result||Array(vecRight.length);result[nDim-1]=vecRight[nDim-1]/mainDiag[nDim-1];for(i=nDim-2;0<=i;--i){result[i]=(vecRight[i]-supDiag[i]*result[i+1])/mainDiag[i]}return result};