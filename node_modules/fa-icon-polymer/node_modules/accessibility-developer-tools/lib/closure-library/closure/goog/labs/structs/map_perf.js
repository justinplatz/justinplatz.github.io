goog.provide("goog.labs.structs.MapPerf");goog.setTestOnly("goog.labs.structs.MapPerf");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.labs.structs.Map");goog.require("goog.structs.Map");goog.require("goog.testing.PerformanceTable");goog.require("goog.testing.jsunit");goog.scope(function(){var MapPerf=goog.labs.structs.MapPerf;MapPerf.MapType;MapPerf.perfTable;MapPerf.keyList=[];MapPerf.MAX_NUM_KEY=1e4;MapPerf.fillMap=function(map,numKeys){goog.asserts.assert(numKeys<=MapPerf.MAX_NUM_KEY);for(var i=0;i<numKeys;++i){map.set(MapPerf.keyList[i],i)}};MapPerf.primeMapWithDeletion=function(map){for(var i=0;1e3>i;++i){map.set(MapPerf.keyList[i],i)}for(var i=0;1e3>i;++i){map.remove(MapPerf.keyList[i])}return map};MapPerf.runPerformanceTestForMapGet=function(map,message){MapPerf.fillMap(map,1e4);MapPerf.perfTable.run(function(){for(var localMap=map,localKeyList=MapPerf.keyList,i=0,sum;500>i;++i){sum=0;for(var j=0;1e4>j;++j){sum+=localMap.get(localKeyList[j])}}},message)};MapPerf.runPerformanceTestForMapSet=function(map,message){MapPerf.perfTable.run(function(){for(var localMap=map,localKeyList=MapPerf.keyList,i=0;500>i;++i){for(var j=0;1e4>j;++j){localMap.set(localKeyList[i],i)}}},message)};goog.global.setUpPage=function(){var content=goog.dom.createDom(goog.dom.TagName.DIV);goog.dom.insertChildAt(document.body,content,0);goog.dom.append(content,goog.dom.createDom(goog.dom.TagName.H1,null,"Closure Performance Tests - Map"),goog.dom.createDom(goog.dom.TagName.P,null,goog.dom.createDom(goog.dom.TagName.STRONG,null,"User-agent: "),goog.dom.createDom(goog.dom.TagName.SPAN,{id:"ua"},navigator.userAgent)),goog.dom.createDom(goog.dom.TagName.DIV,{id:"perf-table"}),goog.dom.createDom(goog.dom.TagName.HR));MapPerf.perfTable=new goog.testing.PerformanceTable(goog.dom.getElement("perf-table"));for(var i=0;i<MapPerf.MAX_NUM_KEY;++i){MapPerf.keyList.push("k"+i)}};goog.global.testGetFromLabsMap=function(){MapPerf.runPerformanceTestForMapGet(new goog.labs.structs.Map,"#get: no previous deletion (Labs)")};goog.global.testGetFromOriginalMap=function(){MapPerf.runPerformanceTestForMapGet(new goog.structs.Map,"#get: no previous deletion (Original)")};goog.global.testGetWithPreviousDeletionFromLabsMap=function(){MapPerf.runPerformanceTestForMapGet(MapPerf.primeMapWithDeletion(new goog.labs.structs.Map),"#get: with previous deletion (Labs)")};goog.global.testGetWithPreviousDeletionFromOriginalMap=function(){MapPerf.runPerformanceTestForMapGet(MapPerf.primeMapWithDeletion(new goog.structs.Map),"#get: with previous deletion (Original)")};goog.global.testSetFromLabsMap=function(){MapPerf.runPerformanceTestForMapSet(new goog.labs.structs.Map,"#set: no previous deletion (Labs)")};goog.global.testSetFromOriginalMap=function(){MapPerf.runPerformanceTestForMapSet(new goog.structs.Map,"#set: no previous deletion (Original)")}});