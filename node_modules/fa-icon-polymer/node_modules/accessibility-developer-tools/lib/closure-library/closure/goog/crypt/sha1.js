goog.provide("goog.crypt.Sha1");goog.require("goog.crypt.Hash");goog.crypt.Sha1=function(){goog.crypt.Sha1.base(this,"constructor");this.blockSize=512/8;this.chain_=[];this.buf_=[];this.W_=[];this.pad_=[];this.pad_[0]=128;for(var i=1;i<this.blockSize;++i){this.pad_[i]=0}this.inbuf_=0;this.total_=0;this.reset()};goog.inherits(goog.crypt.Sha1,goog.crypt.Hash);goog.crypt.Sha1.prototype.reset=function(){this.chain_[0]=1732584193;this.chain_[1]=4023233417;this.chain_[2]=2562383102;this.chain_[3]=271733878;this.chain_[4]=3285377520;this.inbuf_=0;this.total_=0};goog.crypt.Sha1.prototype.compress_=function(buf,opt_offset){if(!opt_offset){opt_offset=0}var W=this.W_;if(goog.isString(buf)){for(var i=0;16>i;i++){W[i]=buf.charCodeAt(opt_offset)<<24|buf.charCodeAt(opt_offset+1)<<16|buf.charCodeAt(opt_offset+2)<<8|buf.charCodeAt(opt_offset+3);opt_offset+=4}}else{for(var i=0;16>i;i++){W[i]=buf[opt_offset]<<24|buf[opt_offset+1]<<16|buf[opt_offset+2]<<8|buf[opt_offset+3];opt_offset+=4}}for(var i=16,t;80>i;i++){t=W[i-3]^W[i-8]^W[i-14]^W[i-16];W[i]=4294967295&(t<<1|t>>>31)}for(var a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4],f,k,i=0;80>i;i++){if(40>i){if(20>i){f=d^b&(c^d);k=1518500249}else{f=b^c^d;k=1859775393}}else{if(60>i){f=b&c|d&(b|c);k=2400959708}else{f=b^c^d;k=3395469782}}var t=4294967295&(a<<5|a>>>27)+f+e+k+W[i];e=d;d=c;c=4294967295&(b<<30|b>>>2);b=a;a=t}this.chain_[0]=4294967295&this.chain_[0]+a;this.chain_[1]=4294967295&this.chain_[1]+b;this.chain_[2]=4294967295&this.chain_[2]+c;this.chain_[3]=4294967295&this.chain_[3]+d;this.chain_[4]=4294967295&this.chain_[4]+e};goog.crypt.Sha1.prototype.update=function(bytes,opt_length){if(null==bytes){return}if(!goog.isDef(opt_length)){opt_length=bytes.length}var lengthMinusBlock=opt_length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;while(n<opt_length){if(0==inbuf){while(n<=lengthMinusBlock){this.compress_(bytes,n);n+=this.blockSize}}if(goog.isString(bytes)){while(n<opt_length){buf[inbuf]=bytes.charCodeAt(n);++inbuf;++n;if(inbuf==this.blockSize){this.compress_(buf);inbuf=0;break}}}else{while(n<opt_length){buf[inbuf]=bytes[n];++inbuf;++n;if(inbuf==this.blockSize){this.compress_(buf);inbuf=0;break}}}}this.inbuf_=inbuf;this.total_+=opt_length};goog.crypt.Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;if(56>this.inbuf_){this.update(this.pad_,56-this.inbuf_)}else{this.update(this.pad_,this.blockSize-(this.inbuf_-56))}for(var i=this.blockSize-1;56<=i;i--){this.buf_[i]=255&totalBits;totalBits/=256}this.compress_(this.buf_);for(var n=0,i=0;5>i;i++){for(var j=24;0<=j;j-=8){digest[n]=255&this.chain_[i]>>j;++n}}return digest};