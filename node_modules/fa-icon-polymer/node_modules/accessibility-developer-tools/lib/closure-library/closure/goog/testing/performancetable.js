goog.setTestOnly("goog.testing.PerformanceTable");goog.provide("goog.testing.PerformanceTable");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.testing.PerformanceTimer");goog.testing.PerformanceTable=function(root,opt_timer,opt_precision,opt_numSamples){this.root_=root;this.precision_=opt_precision||0;var timer=opt_timer;if(!timer){timer=new goog.testing.PerformanceTimer;timer.setNumSamples(opt_numSamples||5);timer.setDiscardOutliers(!0)}this.timer_=timer;this.initRoot_()};goog.testing.PerformanceTable.prototype.getTimer=function(){return this.timer_};goog.testing.PerformanceTable.prototype.initRoot_=function(){this.root_.innerHTML="<table class=\"test-results\" cellspacing=\"1\">"+"  <thead>"+"    <tr>"+"      <th rowspan=\"2\">Test Description</th>"+"      <th rowspan=\"2\">Runs</th>"+"      <th colspan=\"4\">Results (ms)</th>"+"    </tr>"+"    <tr>"+"      <th>Average</th>"+"      <th>Std Dev</th>"+"      <th>Minimum</th>"+"      <th>Maximum</th>"+"    </tr>"+"  </thead>"+"  <tbody>"+"  </tbody>"+"</table>"};goog.testing.PerformanceTable.prototype.getTableBody_=function(){return goog.dom.getElementsByTagName(goog.dom.TagName.TBODY,goog.asserts.assert(this.root_))[0]};goog.testing.PerformanceTable.prototype.round_=function(num){var factor=Math.pow(10,this.precision_);return Math.round(num*factor)/factor+""};goog.testing.PerformanceTable.prototype.run=function(fn,opt_desc){this.runTask(new goog.testing.PerformanceTimer.Task(fn),opt_desc)};goog.testing.PerformanceTable.prototype.runTask=function(task,opt_desc){var results=this.timer_.runTask(task);this.recordResults(results,opt_desc)};goog.testing.PerformanceTable.prototype.recordResults=function(results,opt_desc){var average=results.average,standardDeviation=results.standardDeviation,isSuspicious=0>average||standardDeviation>.5*average,resultsRow=goog.dom.createDom(goog.dom.TagName.TR,null,goog.dom.createDom(goog.dom.TagName.TD,"test-description",opt_desc||"No description"),goog.dom.createDom(goog.dom.TagName.TD,"test-count",results.count+""),goog.dom.createDom(goog.dom.TagName.TD,"test-average",this.round_(average)),goog.dom.createDom(goog.dom.TagName.TD,"test-standard-deviation",this.round_(standardDeviation)),goog.dom.createDom(goog.dom.TagName.TD,"test-minimum",results.minimum+""),goog.dom.createDom(goog.dom.TagName.TD,"test-maximum",results.maximum+""));if(isSuspicious){resultsRow.className="test-suspicious"}this.getTableBody_().appendChild(resultsRow)};goog.testing.PerformanceTable.prototype.reportError=function(reason){this.getTableBody_().appendChild(goog.dom.createDom(goog.dom.TagName.TR,null,goog.dom.createDom(goog.dom.TagName.TD,{class:"test-error",colSpan:5},reason+"")))};