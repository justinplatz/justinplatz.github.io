goog.provide("goog.db.IndexedDb");goog.require("goog.db.Error");goog.require("goog.db.ObjectStore");goog.require("goog.db.Transaction");goog.require("goog.events.Event");goog.require("goog.events.EventHandler");goog.require("goog.events.EventTarget");goog.db.IndexedDb=function(db){goog.db.IndexedDb.base(this,"constructor");this.db_=db;this.eventHandler_=new goog.events.EventHandler(this);this.eventHandler_.listen(this.db_,goog.db.IndexedDb.EventType.ABORT,goog.bind(this.dispatchEvent,this,goog.db.IndexedDb.EventType.ABORT));this.eventHandler_.listen(this.db_,goog.db.IndexedDb.EventType.ERROR,this.dispatchError_);this.eventHandler_.listen(this.db_,goog.db.IndexedDb.EventType.VERSION_CHANGE,this.dispatchVersionChange_);this.eventHandler_.listen(this.db_,goog.db.IndexedDb.EventType.CLOSE,goog.bind(this.dispatchEvent,this,goog.db.IndexedDb.EventType.CLOSE))};goog.inherits(goog.db.IndexedDb,goog.events.EventTarget);goog.db.IndexedDb.prototype.open_=!0;goog.db.IndexedDb.prototype.dispatchError_=function(ev){this.dispatchEvent({type:goog.db.IndexedDb.EventType.ERROR,errorCode:ev.target.error.severity})};goog.db.IndexedDb.prototype.dispatchVersionChange_=function(ev){this.dispatchEvent(new goog.db.IndexedDb.VersionChangeEvent(ev.oldVersion,ev.newVersion))};goog.db.IndexedDb.prototype.close=function(){if(this.open_){this.db_.close();this.open_=!1}};goog.db.IndexedDb.prototype.isOpen=function(){return this.open_};goog.db.IndexedDb.prototype.getName=function(){return this.db_.name};goog.db.IndexedDb.prototype.getVersion=function(){return this.db_.version};goog.db.IndexedDb.prototype.getObjectStoreNames=function(){return this.db_.objectStoreNames};goog.db.IndexedDb.prototype.createObjectStore=function(name,opt_params){try{return new goog.db.ObjectStore(this.db_.createObjectStore(name,opt_params))}catch(ex){throw goog.db.Error.fromException(ex,"creating object store "+name)}};goog.db.IndexedDb.prototype.deleteObjectStore=function(name){try{this.db_.deleteObjectStore(name)}catch(ex){throw goog.db.Error.fromException(ex,"deleting object store "+name)}};goog.db.IndexedDb.prototype.createTransaction=function(storeNames,opt_mode){try{var transaction=opt_mode?this.db_.transaction(storeNames,opt_mode):this.db_.transaction(storeNames);return new goog.db.Transaction(transaction,this)}catch(ex){throw goog.db.Error.fromException(ex,"creating transaction")}};goog.db.IndexedDb.prototype.disposeInternal=function(){goog.db.IndexedDb.base(this,"disposeInternal");this.eventHandler_.dispose()};goog.db.IndexedDb.EventType={ABORT:"abort",CLOSE:"close",ERROR:"error",VERSION_CHANGE:"versionchange"};goog.db.IndexedDb.VersionChangeEvent=function(oldVersion,newVersion){goog.db.IndexedDb.VersionChangeEvent.base(this,"constructor",goog.db.IndexedDb.EventType.VERSION_CHANGE);this.oldVersion=oldVersion;this.newVersion=newVersion};goog.inherits(goog.db.IndexedDb.VersionChangeEvent,goog.events.Event);