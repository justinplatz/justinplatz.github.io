goog.provide("goog.ui.media.Youtube");goog.provide("goog.ui.media.YoutubeModel");goog.require("goog.dom.TagName");goog.require("goog.html.uncheckedconversions");goog.require("goog.string");goog.require("goog.ui.Component");goog.require("goog.ui.media.FlashObject");goog.require("goog.ui.media.Media");goog.require("goog.ui.media.MediaModel");goog.require("goog.ui.media.MediaRenderer");goog.ui.media.Youtube=function(){goog.ui.media.MediaRenderer.call(this)};goog.inherits(goog.ui.media.Youtube,goog.ui.media.MediaRenderer);goog.addSingletonGetter(goog.ui.media.Youtube);goog.ui.media.Youtube.newControl=function(youtubeModel,opt_domHelper){var control=new goog.ui.media.Media(youtubeModel,goog.ui.media.Youtube.getInstance(),opt_domHelper);control.setStateInternal(goog.ui.Component.State.ACTIVE);return control};goog.ui.media.Youtube.CSS_CLASS=goog.getCssName("goog-ui-media-youtube");goog.ui.media.Youtube.prototype.setState=function(c,state,enable){var control=c;goog.ui.media.Youtube.superClass_.setState.call(this,control,state,enable);if(!control.getElement()){throw Error(goog.ui.Component.Error.STATE_INVALID)}var domHelper=control.getDomHelper(),dataModel=control.getDataModel();if(!!(state&goog.ui.Component.State.SELECTED)&&enable){var flashEls=domHelper.getElementsByTagNameAndClass(goog.dom.TagName.DIV,goog.ui.media.FlashObject.CSS_CLASS,control.getElement());if(0<flashEls.length){return}var youtubeFlash=new goog.ui.media.FlashObject(dataModel.getPlayer().getTrustedResourceUrl(),domHelper);control.addChild(youtubeFlash,!0)}};goog.ui.media.Youtube.prototype.getCssClass=function(){return goog.ui.media.Youtube.CSS_CLASS};goog.ui.media.YoutubeModel=function(videoId,opt_caption,opt_description){goog.ui.media.MediaModel.call(this,goog.ui.media.YoutubeModel.buildUrl(videoId),opt_caption,opt_description,goog.ui.media.MediaModel.MimeType.FLASH);this.videoId_=videoId;this.setThumbnails([new goog.ui.media.MediaModel.Thumbnail(goog.ui.media.YoutubeModel.getThumbnailUrl(videoId))]);this.setPlayer(new goog.ui.media.MediaModel.Player(goog.ui.media.YoutubeModel.getFlashUrl(videoId,!0)))};goog.inherits(goog.ui.media.YoutubeModel,goog.ui.media.MediaModel);goog.ui.media.YoutubeModel.MATCHER_=/https?:\/\/(?:[a-zA-Z]{1,3}\.)?(?:(?:youtu\.be\/([\w-]+)(?:\?[\w=&-]+)?)|(?:youtube\.com\/watch)(?:\?(?:[\w=-]+&(?:amp;)?)*v=([\w-]+)(?:&(?:amp;)?[\w=-]+)*)?(?:#[!]?(?:(?:(?:[\w=-]+&(?:amp;)?)*(?:v=([\w-]+))(?:&(?:amp;)?[\w=-]+)*)|(?:[\w=&-]+)))?)[^\w-]?/i;goog.ui.media.YoutubeModel.newInstance=function(youtubeUrl,opt_caption,opt_description){var extract=goog.ui.media.YoutubeModel.MATCHER_.exec(youtubeUrl);if(extract){var videoId=extract[1]||extract[2]||extract[3];return new goog.ui.media.YoutubeModel(videoId,opt_caption,opt_description)}throw Error("failed to parse video id from youtube url: "+youtubeUrl)};goog.ui.media.YoutubeModel.buildUrl=function(videoId){return"http://www.youtube.com/watch?v="+goog.string.urlEncode(videoId)};goog.ui.media.YoutubeModel.getThumbnailUrl=function(youtubeId){return"http://i.ytimg.com/vi/"+youtubeId+"/default.jpg"};goog.ui.media.YoutubeModel.getFlashUrl=function(videoId,opt_autoplay){var autoplay=opt_autoplay?"&autoplay=1":"";return goog.html.uncheckedconversions.trustedResourceUrlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Fixed domain, encoded path."),"http://www.youtube.com/v/"+goog.string.urlEncode(videoId)+"&hl=en&fs=1"+autoplay)};goog.ui.media.YoutubeModel.prototype.getVideoId=function(){return this.videoId_};