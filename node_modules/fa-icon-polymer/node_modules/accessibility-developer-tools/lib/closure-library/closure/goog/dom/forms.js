goog.provide("goog.dom.forms");goog.require("goog.dom.InputType");goog.require("goog.dom.TagName");goog.require("goog.structs.Map");goog.require("goog.window");goog.dom.forms.submitFormInNewWindow=function(form,opt_submitElement){var formData=goog.dom.forms.getFormDataMap(form),action=form.action,method=form.method;if(opt_submitElement){if(goog.dom.InputType.SUBMIT!=opt_submitElement.type.toLowerCase()){throw Error("opt_submitElement does not have a valid type.")}var submitValue=goog.dom.forms.getValue(opt_submitElement);if(null!=submitValue){goog.dom.forms.addFormDataToMap_(formData,opt_submitElement.name,submitValue)}if(opt_submitElement.getAttribute("formaction")){action=opt_submitElement.getAttribute("formaction")}if(opt_submitElement.getAttribute("formmethod")){method=opt_submitElement.getAttribute("formmethod")}}return goog.dom.forms.submitFormDataInNewWindow(action,method,formData)};goog.dom.forms.submitFormDataInNewWindow=function(actionUri,method,formData){var newWin=goog.window.openBlank("",{noreferrer:!0});if(!newWin){return!1}var newDocument=newWin.document,newForm=newDocument.createElement("form");newForm.method=method;newForm.action=actionUri;formData.forEach(function(fieldValues,fieldName){for(var i=0;i<fieldValues.length;i++){var fieldValue=fieldValues[i],newInput=newDocument.createElement("input");newInput.name=fieldName;newInput.value=fieldValue;newInput.type="hidden";HTMLFormElement.prototype.appendChild.call(newForm,newInput)}});HTMLFormElement.prototype.submit.call(newForm);return!0};goog.dom.forms.getFormDataMap=function(form){var map=new goog.structs.Map;goog.dom.forms.getFormDataHelper_(form,map,goog.dom.forms.addFormDataToMap_);return map};goog.dom.forms.getFormDataString=function(form){var sb=[];goog.dom.forms.getFormDataHelper_(form,sb,goog.dom.forms.addFormDataToStringBuffer_);return sb.join("&")};goog.dom.forms.getFormDataHelper_=function(form,result,fnAppend){for(var els=form.elements,el,i=0;el=els[i];i++){if(el.form!=form||el.disabled||el.tagName==goog.dom.TagName.FIELDSET){continue}var name=el.name;switch(el.type.toLowerCase()){case goog.dom.InputType.FILE:case goog.dom.InputType.SUBMIT:case goog.dom.InputType.RESET:case goog.dom.InputType.BUTTON:break;case goog.dom.InputType.SELECT_MULTIPLE:var values=goog.dom.forms.getValue(el);if(null!=values){for(var value,j=0;value=values[j];j++){fnAppend(result,name,value)}}break;default:var value=goog.dom.forms.getValue(el);if(null!=value){fnAppend(result,name,value)}}}for(var inputs=form.getElementsByTagName(goog.dom.TagName.INPUT+""),input,i=0;input=inputs[i];i++){if(input.form==form&&input.type.toLowerCase()==goog.dom.InputType.IMAGE){name=input.name;fnAppend(result,name,input.value);fnAppend(result,name+".x","0");fnAppend(result,name+".y","0")}}};goog.dom.forms.addFormDataToMap_=function(map,name,value){var array=map.get(name);if(!array){array=[];map.set(name,array)}array.push(value)};goog.dom.forms.addFormDataToStringBuffer_=function(sb,name,value){sb.push(encodeURIComponent(name)+"="+encodeURIComponent(value))};goog.dom.forms.hasFileInput=function(form){for(var els=form.elements,el,i=0;el=els[i];i++){if(!el.disabled&&el.type&&el.type.toLowerCase()==goog.dom.InputType.FILE){return!0}}return!1};goog.dom.forms.setDisabled=function(el,disabled){if(el.tagName==goog.dom.TagName.FORM){for(var els=el.elements,i=0;el=els[i];i++){goog.dom.forms.setDisabled(el,disabled)}}else{if(!0==disabled){el.blur()}el.disabled=disabled}};goog.dom.forms.focusAndSelect=function(el){el.focus();if(el.select){el.select()}};goog.dom.forms.hasValue=function(el){var value=goog.dom.forms.getValue(el);return!!value};goog.dom.forms.hasValueByName=function(form,name){var value=goog.dom.forms.getValueByName(form,name);return!!value};goog.dom.forms.getValue=function(el){var type=el.type;if(!goog.isDef(type)){return null}switch(type.toLowerCase()){case goog.dom.InputType.CHECKBOX:case goog.dom.InputType.RADIO:return goog.dom.forms.getInputChecked_(el);case goog.dom.InputType.SELECT_ONE:return goog.dom.forms.getSelectSingle_(el);case goog.dom.InputType.SELECT_MULTIPLE:return goog.dom.forms.getSelectMultiple_(el);default:return goog.isDef(el.value)?el.value:null;}};goog.dom.$F=goog.dom.forms.getValue;goog.dom.forms.getValueByName=function(form,name){var els=form.elements[name];if(els){if(els.type){return goog.dom.forms.getValue(els)}else{for(var i=0,val;i<els.length;i++){val=goog.dom.forms.getValue(els[i]);if(val){return val}}}}return null};goog.dom.forms.getInputChecked_=function(el){return el.checked?el.value:null};goog.dom.forms.getSelectSingle_=function(el){var selectedIndex=el.selectedIndex;return 0<=selectedIndex?el.options[selectedIndex].value:null};goog.dom.forms.getSelectMultiple_=function(el){for(var values=[],option,i=0;option=el.options[i];i++){if(option.selected){values.push(option.value)}}return values.length?values:null};goog.dom.forms.setValue=function(el,opt_value){var type=el.type;if(goog.isDef(type)){switch(type.toLowerCase()){case goog.dom.InputType.CHECKBOX:case goog.dom.InputType.RADIO:goog.dom.forms.setInputChecked_(el,opt_value);break;case goog.dom.InputType.SELECT_ONE:goog.dom.forms.setSelectSingle_(el,opt_value);break;case goog.dom.InputType.SELECT_MULTIPLE:goog.dom.forms.setSelectMultiple_(el,opt_value);break;default:el.value=goog.isDefAndNotNull(opt_value)?opt_value:"";}}};goog.dom.forms.setInputChecked_=function(el,opt_value){el.checked=opt_value};goog.dom.forms.setSelectSingle_=function(el,opt_value){el.selectedIndex=-1;if(goog.isString(opt_value)){for(var option,i=0;option=el.options[i];i++){if(option.value==opt_value){option.selected=!0;break}}}};goog.dom.forms.setSelectMultiple_=function(el,opt_value){if(goog.isString(opt_value)){opt_value=[opt_value]}for(var option,i=0;option=el.options[i];i++){option.selected=!1;if(opt_value){for(var value,j=0;value=opt_value[j];j++){if(option.value==value){option.selected=!0}}}}};