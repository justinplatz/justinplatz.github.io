goog.provide("goog.baseTest");goog.setTestOnly("goog.baseTest");goog.require("goog.Promise");goog.require("goog.Timer");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.functions");goog.require("goog.object");goog.require("goog.test_module");goog.require("goog.testing.PropertyReplacer");goog.require("goog.testing.jsunit");goog.require("goog.testing.recordFunction");goog.require("goog.userAgent");var earlyTestModuleGet=goog.module.get("goog.test_module");function getFramedVars(name){var w=window.frames[name],doc=w.document;doc.open();doc.write("<script>"+"var a = [0, 1, 2];"+"var o = {a: 0, b: 1};"+"var n = 42;"+"var b = true;"+"var s = \"string\";"+"var nv = null;"+"var u = undefined;"+"var fv = function(){};"+"</"+"script>");doc.close();return{array:w.a,object:w.o,number:w.n,boolean:w.b,string:w.s,functionVar:w.fv,nullVar:w.nv,undefinedVar:w.u}}var framedVars=getFramedVars("f1"),framedVars2=getFramedVars("f2"),iframeElement=document.getElementById("f2");iframeElement.parentNode.removeChild(iframeElement);var stubs=new goog.testing.PropertyReplacer,originalGoogBind=goog.bind;function tearDown(){goog.setCssNameMapping(void 0);stubs.reset();goog.bind=originalGoogBind}function testLibrary(){assertNotUndefined("'goog' not loaded",goog)}function testDefine(){goog.define("SOME_DEFINE",123);assertEquals(SOME_DEFINE,456);goog.define("SOME_OTHER_DEFINE",123);assertEquals(SOME_OTHER_DEFINE,123);goog.provide("ns");goog.define("ns.SOME_DEFINE",123);assertEquals(SOME_DEFINE,456);goog.define("ns.SOME_OTHER_DEFINE",123);assertEquals(SOME_OTHER_DEFINE,123)}function testProvide(){goog.provide("goog.test.name.space");assertNotUndefined("provide failed: goog.test",goog.test);assertNotUndefined("provide failed: goog.test.name",goog.test.name);assertNotUndefined("provide failed: goog.test.name.space",goog.test.name.space);goog.provide("goog.test");goog.provide("goog.test.name");delete goog.test}function testProvideStrictness(){goog.provide("goog.xy");assertProvideFails("goog.xy");goog.provide("goog.xy.z");assertProvideFails("goog.xy");window.goog.xyz="Bob";assertProvideFails("goog.xyz");delete goog.xy;delete goog.xyz}function assertProvideFails(namespace){assertThrows("goog.provide("+namespace+") should have failed",goog.partial(goog.provide,namespace))}function testIsProvided(){goog.provide("goog.explicit");assertTrue(goog.isProvided_("goog.explicit"));goog.provide("goog.implicit.explicit");assertFalse(goog.isProvided_("goog.implicit"));assertTrue(goog.isProvided_("goog.implicit.explicit"))}function testGlobalize(){var a={a:1,b:2,c:3},b={};goog.globalize(a,b);assertNotUndefined("Globalize to arbitrary object",b.a);assertNotUndefined("Globalize to arbitrary object",b.b);assertNotUndefined("Globalize to arbitrary object",b.c)}function testExportSymbol(){var date=new Date;assertTrue("undefined"==typeof nodots);goog.exportSymbol("nodots",date);assertEquals(date,nodots);nodots=void 0;assertTrue("undefined"==typeof gotcher);goog.exportSymbol("gotcher.dots.right.Here",date);assertEquals(date,gotcher.dots.right.Here);gotcher=void 0;goog.provide("an.existing.path");assertNotNull(an.existing.path);goog.exportSymbol("an.existing.path",date);assertEquals(date,an.existing.path);an=void 0;var foo={foo:"foo"},bar={bar:"bar"},baz={baz:"baz"};goog.exportSymbol("one.two.three.Four",foo);goog.exportSymbol("one.two.three.five",bar);goog.exportSymbol("one.two.six",baz);assertEquals(foo,one.two.three.Four);assertEquals(bar,one.two.three.five);assertEquals(baz,one.two.six);var win={},fooBar={foo:"foo",bar:"bar"};goog.exportSymbol("one.two.four",fooBar,win);assertEquals(fooBar,win.one.two.four);assertTrue("four"in win.one.two);assertFalse("four"in one.two);one=void 0}goog.exportSymbol("exceptionTest",function(){throw Error("ERROR")});function testExportSymbolExceptions(){var inner=function(){exceptionTest()},e=assertThrows("Exception wasn't thrown by exported function",inner);assertEquals("Unexpected error thrown","ERROR",e.message)}function testRequireClosure(){assertNotUndefined("goog.Timer should be available",goog.Timer);assertNotUndefined("goog.events.EventTarget should be available",goog.events.EventTarget)}function testRequireWithExternalDuplicate(){goog.addDependency("dup.js",["dup.base"],[]);goog.addDependency("dup-child.js",["dup.base.child"],["dup.base"]);goog.provide("dup.base");stubs.set(goog,"isDocumentFinishedLoading_",!1);stubs.set(goog.global,"CLOSURE_IMPORT_SCRIPT",function(src){if(src==goog.basePath+"dup.js"){fail("Duplicate script written!")}else if(src==goog.basePath+"dup-child.js"){return!0}else{return!1}});var require=goog.require;require("dup.base.child")}function testTypeOf(){assertEquals("array",goog.typeOf([]));assertEquals("string",goog.typeOf("string"));assertEquals("number",goog.typeOf(123));assertEquals("null",goog.typeOf(null));assertEquals("undefined",goog.typeOf(void 0));assertEquals("object",goog.typeOf({}));assertEquals("function",goog.typeOf(function(){}));assertNotEquals("array",goog.typeOf(document.getElementsByName("*")));assertNotEquals("function",goog.typeOf(document.getElementsByName("*")));assertEquals("object",goog.typeOf(document.getElementsByName("*")))}function testTypeOfFramed(){assertEquals("array",goog.typeOf(framedVars.array));assertEquals("string",goog.typeOf(framedVars.string));assertEquals("number",goog.typeOf(framedVars.number));assertEquals("null",goog.typeOf(framedVars.nullVar));assertEquals("undefined",goog.typeOf(framedVars.undefinedVar));assertEquals("object",goog.typeOf(framedVars.object));assertEquals("function",goog.typeOf(framedVars.functionVar))}function testTypeOfFramed2(){assertEquals("array",goog.typeOf(framedVars2.array));assertEquals("string",goog.typeOf(framedVars2.string));assertEquals("number",goog.typeOf(framedVars2.number));assertEquals("null",goog.typeOf(framedVars2.nullVar));assertEquals("undefined",goog.typeOf(framedVars2.undefinedVar));assertEquals("object",goog.typeOf(framedVars2.object));assertEquals("function",goog.typeOf(framedVars2.functionVar))}function testIsDef(){var defined="foo",nullVar=null,notDefined;assertTrue("defined should be defined",goog.isDef(defined));assertTrue("null should be defined",goog.isDef(nullVar));assertFalse("undefined should not be defined",goog.isDef(notDefined))}function testIsDefAndNotNull(){assertTrue("string is defined and non-null",goog.isDefAndNotNull(""));assertTrue("object is defined and non-null",goog.isDefAndNotNull({}));assertTrue("function is defined and non-null",goog.isDefAndNotNull(goog.nullFunction));assertTrue("zero is defined and non-null",goog.isDefAndNotNull(0));assertFalse("null",goog.isDefAndNotNull(null));assertFalse("undefined",goog.isDefAndNotNull(void 0))}function testIsNull(){var notNull="foo",nullVar=null,notDefined;assertFalse("defined should not be null",goog.isNull(notNull));assertTrue("null should be null",goog.isNull(nullVar));assertFalse("undefined should not be null",goog.isNull(notDefined))}function testIsArray(){var array=[1,2,3],arrayWithLengthSet=[1,2,3];arrayWithLengthSet.length=2;var objWithArrayFunctions={slice:function(){},length:0},object={a:1,b:2,c:3},nullVar=null,notDefined,elem=document.getElementById("elem"),text=document.getElementById("text").firstChild,impostor=document.body.getElementsByTagName("BOGUS");impostor.push=Array.prototype.push;impostor.pop=Array.prototype.pop;impostor.slice=Array.prototype.slice;impostor.splice=Array.prototype.splice;assertTrue("array should be an array",goog.isArray(array));assertTrue("arrayWithLengthSet should be an array",goog.isArray(arrayWithLengthSet));assertFalse("object with array functions should not be an array unless "+"length is not enumerable",goog.isArray(objWithArrayFunctions));assertFalse("object should not be an array",goog.isArray(object));assertFalse("null should not be an array",goog.isArray(nullVar));assertFalse("undefined should not be an array",goog.isArray(notDefined));assertFalse("NodeList should not be an array",goog.isArray(elem.childNodes));assertFalse("TextNode should not be an array",goog.isArray(text));assertTrue("Array of nodes should be an array",goog.isArray([elem.firstChild,elem.lastChild]));assertFalse("An impostor should not be an array",goog.isArray(impostor))}function testTypeOfAcrossWindow(){if(goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("10")&&!goog.userAgent.isVersionOrHigher("11")){return}var w=window.open("","blank");if(w){try{var d=w.document;d.open();d.write("<script>function fun(){};"+"var arr = [];"+"var x = 42;"+"var s = \"\";"+"var b = true;"+"var obj = {length: 0, splice: {}, call: {}};"+"</"+"script>");d.close();assertEquals("function",goog.typeOf(w.fun));assertEquals("array",goog.typeOf(w.arr));assertEquals("number",goog.typeOf(w.x));assertEquals("string",goog.typeOf(w.s));assertEquals("boolean",goog.typeOf(w.b));assertEquals("object",goog.typeOf(w.obj))}finally{w.close()}}}function testIsArrayLike(){var array=[1,2,3],objectWithNumericLength={length:2},objectWithNonNumericLength={length:"a"},object={a:1,b:2},nullVar=null,notDefined,elem=document.getElementById("elem"),text=document.getElementById("text").firstChild;assertTrue("array should be array-like",goog.isArrayLike(array));assertTrue("obj w/numeric length should be array-like",goog.isArrayLike(objectWithNumericLength));assertFalse("obj w/non-numeric length should not be array-like",goog.isArrayLike(objectWithNonNumericLength));assertFalse("object should not be array-like",goog.isArrayLike(object));assertFalse("null should not be array-like",goog.isArrayLike(nullVar));assertFalse("undefined should not be array-like",goog.isArrayLike(notDefined));assertTrue("NodeList should be array-like",goog.isArrayLike(elem.childNodes));assertTrue("Array of nodes should be array-like",goog.isArrayLike([elem.firstChild,elem.lastChild]))}function MockGoogDate(){}MockGoogDate.prototype.getFullYear=function(){return 2007};function testIsDateLike(){var jsDate=new Date,googDate=new MockGoogDate,string="foo",number=1,nullVar=null,notDefined;assertTrue("js Date should be date-like",goog.isDateLike(jsDate));assertTrue("goog Date should be date-like",goog.isDateLike(googDate));assertFalse("string should not be date-like",goog.isDateLike(string));assertFalse("number should not be date-like",goog.isDateLike(number));assertFalse("nullVar should not be date-like",goog.isDateLike(nullVar));assertFalse("undefined should not be date-like",goog.isDateLike(notDefined))}function testIsString(){var string="foo",number=2,nullVar=null,notDefined;assertTrue("string should be a string",goog.isString(string));assertFalse("number should not be a string",goog.isString(number));assertFalse("null should not be a string",goog.isString(nullVar));assertFalse("undefined should not be a string",goog.isString(notDefined))}function testIsBoolean(){var b=!0,s="true",num=1,nullVar=null,notDefined;assertTrue("boolean should be a boolean",goog.isBoolean(b));assertFalse("string should not be a boolean",goog.isBoolean(s));assertFalse("number should not be a boolean",goog.isBoolean(num));assertFalse("null should not be a boolean",goog.isBoolean(nullVar));assertFalse("undefined should not be a boolean",goog.isBoolean(notDefined))}function testIsNumber(){var number=1,string="1",nullVar=null,notDefined;assertTrue("number should be a number",goog.isNumber(number));assertFalse("string should not be a number",goog.isNumber(string));assertFalse("null should not be a number",goog.isNumber(nullVar));assertFalse("undefined should not be a number",goog.isNumber(notDefined))}function testIsFunction(){var func=function(){return 1},object={a:1,b:2},nullVar=null,notDefined;assertTrue("function should be a function",goog.isFunction(func));assertFalse("object should not be a function",goog.isFunction(object));assertFalse("null should not be a function",goog.isFunction(nullVar));assertFalse("undefined should not be a function",goog.isFunction(notDefined))}function testIsObject(){var object={a:1,b:2},string="b",nullVar=null,notDefined,array=[0,1,2],fun=function(){};assertTrue("object should be an object",goog.isObject(object));assertTrue("array should be an object",goog.isObject(array));assertTrue("function should be an object",goog.isObject(fun));assertFalse("string should not be an object",goog.isObject(string));assertFalse("null should not be an object",goog.isObject(nullVar));assertFalse("undefined should not be an object",goog.isObject(notDefined))}function testGetUid(){var a={},b={},c={},uid1=goog.getUid(a),uid2=goog.getUid(b),uid3=goog.getUid(c);assertNotEquals("Unique IDs must be unique",uid1,uid2);assertNotEquals("Unique IDs must be unique",uid1,uid3);assertNotEquals("Unique IDs must be unique",uid2,uid3)}function testHasUid(){var a={};assertFalse(goog.hasUid(a));assertFalse(goog.UID_PROPERTY_ in a);var uid=goog.getUid(a);assertTrue(goog.hasUid(a));assertEquals(uid,goog.getUid(a))}function testRemoveUidFromPlainObject(){var a={},uid=goog.getUid(a);goog.removeUid(a);assertNotEquals("An object's old and new unique IDs should be different",uid,goog.getUid(a))}function testRemoveUidFromObjectWithoutUid(){var a={};goog.removeUid(a)}function testRemoveUidFromNode(){var node=goog.dom.createElement(goog.dom.TagName.DIV),nodeUid=goog.getUid(node);goog.removeUid(node);assertNotEquals("A node's old and new unique IDs should be different",nodeUid,goog.getUid(node))}function testConstructorUid(){function BaseClass(){}function SubClass(){}goog.inherits(SubClass,BaseClass);var baseClassUid=goog.getUid(BaseClass),subClassUid=goog.getUid(SubClass);assertTrue("Unique ID of BaseClass must be a number","number"==typeof baseClassUid);assertTrue("Unique ID of SubClass must be a number","number"==typeof subClassUid);assertNotEquals("Unique IDs of BaseClass and SubClass must differ",baseClassUid,subClassUid);assertNotEquals("Unique IDs of BaseClass and SubClass instances must differ",goog.getUid(new BaseClass),goog.getUid(new SubClass));assertEquals("Unique IDs of BaseClass.prototype and SubClass.prototype "+"should differ, but to keep the implementation simple, we do not "+"handle this edge case.",goog.getUid(BaseClass.prototype),goog.getUid(SubClass.prototype))}function testUidNotUndefinedOnReusedElement(){var div=goog.dom.createElement(goog.dom.TagName.DIV);document.body.appendChild(div);div.innerHTML="<form id=\"form\"></form>";var span=goog.dom.getElementsByTagName(goog.dom.TagName.FORM,div)[0];goog.getUid(span);div.innerHTML="<form id=\"form\"></form>";var span2=goog.dom.getElementsByTagName(goog.dom.TagName.FORM,div)[0];assertNotUndefined(goog.getUid(span2))}function testWindowUid(){var uid=goog.getUid(window);assertTrue("window unique id is a number",goog.isNumber(uid));assertEquals("returns the same id second time",uid,goog.getUid(window));goog.removeUid(window);assertNotEquals("generates new id after the old one is removed",goog.getUid(window))}function testClonePrimitive(){assertEquals("cloning a primitive should return an equal primitive",5,goog.cloneObject(5))}function testCloneObjectThatHasACloneMethod(){var original={name:"original",clone:function(){return{name:"clone"}}},clone=goog.cloneObject(original);assertEquals("original",original.name);assertEquals("clone",clone.name)}function testCloneFlatObject(){var original={a:1,b:2,c:3},clone=goog.cloneObject(original);assertNotEquals(original,clone);assertEquals(1,clone.a);assertEquals(2,clone.b);assertEquals(3,clone.c)}function testCloneDeepObject(){var original={a:1,b:{c:2,d:3},e:{f:{g:4,h:5}}},clone=goog.cloneObject(original);assertNotEquals(original,clone);assertNotEquals(original.b,clone.b);assertNotEquals(original.e,clone.e);assertEquals(1,clone.a);assertEquals(2,clone.b.c);assertEquals(3,clone.b.d);assertEquals(4,clone.e.f.g);assertEquals(5,clone.e.f.h)}function testCloneFunctions(){var original={f:function(){return"hi"}},clone=goog.cloneObject(original);assertNotEquals(original,clone);assertEquals("hi",clone.f());assertEquals(original.f,clone.f)}var foo="global",obj={foo:"obj"};function getFoo(arg1,arg2){return{foo:this.foo,arg1:arg1,arg2:arg2}}function testBindWithoutObj(){if(Function.prototype.bind){assertEquals(foo,getFoo.bind()().foo)}}function testBindWithObj(){if(Function.prototype.bind){assertEquals(obj.foo,getFoo.bind(obj)().foo)}}function testBindWithNullObj(){if(Function.prototype.bind){assertEquals(foo,getFoo.bind()().foo)}}function testBindStaticArgs(){if(Function.prototype.bind){var fooprime=getFoo.bind(obj,"hot","dog"),res=fooprime();assertEquals(obj.foo,res.foo);assertEquals("hot",res.arg1);assertEquals("dog",res.arg2)}}function testBindDynArgs(){if(Function.prototype.bind){var res=getFoo.bind(obj)("hot","dog");assertEquals(obj.foo,res.foo);assertEquals("hot",res.arg1);assertEquals("dog",res.arg2)}}function testBindCurriedArgs(){if(Function.prototype.bind){var res=getFoo.bind(obj,"hot")("dog");assertEquals(obj.foo,res.foo);assertEquals("hot",res.arg1);assertEquals("dog",res.arg2)}}function testBindDoubleBind(){var getFooP=goog.bind(getFoo,obj,"hot"),getFooP2=goog.bind(getFooP,null,"dog"),res=getFooP2();assertEquals("res.arg1 should be 'hot'","hot",res.arg1);assertEquals("res.arg2 should be 'dog'","dog",res.arg2)}function testBindWithCall(){var obj={},obj2={},f=function(){assertEquals("this should be bound to obj",obj,this)},b=goog.bind(f,obj);b.call(null);b.call(obj2)}function testBindJs(){assertEquals(1,goog.bindJs_(add,{valueOf:function(){return 1}})());assertEquals(3,goog.bindJs_(add,null,1,2)())}function testBindNative(){if(Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")){assertEquals(1,goog.bindNative_(add,{valueOf:function(){return 1}})());assertEquals(3,goog.bindNative_(add,null,1,2)());assertThrows(function(){goog.bindNative_(null,null)})}}function testBindDefault(){assertEquals(1,goog.bind(add,{valueOf:function(){return 1}})());assertEquals(3,goog.bind(add,null,1,2)())}function add(var_args){for(var sum=+this||0,i=0;i<arguments.length;i++){sum+=arguments[i]}return sum}function testPartial(){var f=function(x,y){return x+y},g=goog.partial(f,1);assertEquals(3,g(2));var h=goog.partial(f,1,2);assertEquals(3,h());var i=goog.partial(f);assertEquals(3,i(1,2))}function testPartialUsesGlobal(){var f=function(x,y){assertEquals(goog.global,this);return x+y},g=goog.partial(f,1),h=goog.partial(g,2);assertEquals(3,h())}function testPartialWithCall(){var obj={},f=function(x,y){assertEquals(obj,this);return x+y},g=goog.partial(f,1),h=goog.partial(g,2);assertEquals(3,h.call(obj))}function testPartialAndBind(){var p=goog.partial(getFoo,"hot"),b=goog.bind(p,obj,"dog"),res=b();assertEquals(obj.foo,res.foo);assertEquals("hot",res.arg1);assertEquals("dog",res.arg2)}function testBindAndPartial(){var b=goog.bind(getFoo,obj,"hot"),p=goog.partial(b,"dog"),res=p();assertEquals(obj.foo,res.foo);assertEquals("hot",res.arg1);assertEquals("dog",res.arg2)}function testPartialMultipleCalls(){var f=goog.testing.recordFunction(),a=goog.partial(f,"foo"),b=goog.partial(a,"bar");a();a();b();b();assertEquals(4,f.getCallCount());var calls=f.getCalls();assertArrayEquals(["foo"],calls[0].getArguments());assertArrayEquals(["foo"],calls[1].getArguments());assertArrayEquals(["foo","bar"],calls[2].getArguments());assertArrayEquals(["foo","bar"],calls[3].getArguments())}function testGlobalEval(){goog.globalEval("var foofoofoo = 125;");assertEquals("Var should be globally assigned",125,goog.global.foofoofoo);var foofoofoo=128;assertEquals("Global should not have changed",125,goog.global.foofoofoo)}function testGlobalEvalWithHtml(){goog.global.evalTestResult="failed";goog.global.evalTest=function(arg){goog.global.evalTestResult=arg};goog.globalEval("evalTest(\"<test>\")");assertEquals("Should be able to evaluate strings with HTML in","<test>",goog.global.evalTestResult)}function testInherits(){function Foo(){}function Bar(){}goog.inherits(Bar,Foo);var bar=new Bar;assert("object should be instance of constructor",bar instanceof Bar);assert("object should be instance of base constructor",bar instanceof Foo)}function testInherits_constructor(){function Foo(){}function Bar(){}goog.inherits(Bar,Foo);var bar=new Bar;assertEquals("constructor property should match constructor function",Bar,bar.constructor);assertEquals("Superclass constructor should match constructor function",Foo,Bar.superClass_.constructor)}function testMakeSingleton(){function Foo(){}goog.addSingletonGetter(Foo);assertNotNull("Should add get instance function",Foo.getInstance);var x=Foo.getInstance();assertNotNull("Should successfully create an object",x);var y=Foo.getInstance();assertEquals("Should return the same object",x,y);delete Foo.instance_;var z=Foo.getInstance();assertNotNull("Should work after clearing for testing",z);assertNotEquals("Should return a different object after clearing for testing",x,z)}function testNow(){var toleranceMilliseconds=20,now1=new Date().getTime(),now2=goog.now();assertTrue(Math.abs(now1-now2)<toleranceMilliseconds)}function testInHtmlDocument(){var savedGoogGlobal=goog.global;try{goog.global={};assertFalse(goog.inHtmlDocument_());goog.global.document={};assertFalse(goog.inHtmlDocument_());goog.global.document.write=function(){};assertTrue(goog.inHtmlDocument_())}finally{goog.global=savedGoogGlobal}}function testLoadInNonHtmlNotThrows(){var savedGoogGlobal=goog.global;try{goog.global={};goog.global.document={};assertFalse(goog.inHtmlDocument_());goog.findBasePath_();goog.writeScriptTag_(goog.basePath+"deps.js")}finally{goog.global=savedGoogGlobal}}function testLoadBaseWithQueryParamOk(){var savedGoogGlobal=goog.global;try{goog.global={};goog.global.document={write:goog.nullFunction,getElementsByTagName:goog.functions.constant([{src:"/path/to/base.js?zx=5"}])};assertTrue(goog.inHtmlDocument_());goog.findBasePath_();assertEquals("/path/to/",goog.basePath)}finally{goog.global=savedGoogGlobal}}function testGetMsgWithDollarSigns(){var msg=goog.getMsg("{$amount} per minute",{amount:"$0.15"});assertEquals("$0.15 per minute",msg);msg=goog.getMsg("{$amount} per minute",{amount:"$0.$1$5"});assertEquals("$0.$1$5 per minute",msg);msg=goog.getMsg("This is a {$rate} sale!",{rate:"$$$$$$$$$$10"});assertEquals("This is a $$$$$$$$$$10 sale!",msg);msg=goog.getMsg("{$name}! Hamburgers: {$hCost}, Hotdogs: {$dCost}.",{name:"Burger Bob",hCost:"$0.50",dCost:"$100"});assertEquals("Burger Bob! Hamburgers: $0.50, Hotdogs: $100.",msg)}function testGetMsgWithPlaceholders(){var msg=goog.getMsg("{$a} has {$b}",{a:"{$b}",b:1});assertEquals("{$b} has 1",msg);msg=goog.getMsg("{$a}{$b}",{b:""});assertEquals("{$a}",msg)}function testGetObjectByName(){var m={undefined:void 0,null:null,emptyString:"",false:!1,true:!0,zero:0,one:1,two:{three:3,four:{five:5}},"six|seven":"6|7","eight.nine":8.9};goog.global.m=m;assertNull(goog.getObjectByName("m.undefined"));assertNull(goog.getObjectByName("m.null"));assertEquals(goog.getObjectByName("m.emptyString"),"");assertEquals(goog.getObjectByName("m.false"),!1);assertEquals(goog.getObjectByName("m.true"),!0);assertEquals(goog.getObjectByName("m.zero"),0);assertEquals(goog.getObjectByName("m.one"),1);assertEquals(goog.getObjectByName("m.two.three"),3);assertEquals(goog.getObjectByName("m.two.four.five"),5);assertEquals(goog.getObjectByName("m.six|seven"),"6|7");assertNull(goog.getObjectByName("m.eight.nine"));assertNull(goog.getObjectByName("m.notThere"));assertEquals(goog.getObjectByName("one",m),1);assertEquals(goog.getObjectByName("two.three",m),3);assertEquals(goog.getObjectByName("two.four.five",m),5);assertEquals(goog.getObjectByName("six|seven",m),"6|7");assertNull(goog.getObjectByName("eight.nine",m));assertNull(goog.getObjectByName("notThere",m))}function testGetCssName(){assertEquals("classname",goog.getCssName("classname"));assertEquals("random-classname",goog.getCssName("random-classname"));assertEquals("control-modifier",goog.getCssName("control","modifier"));goog.setCssNameMapping({goog:"a",disabled:"b"},"BY_PART");var g=goog.getCssName("goog");assertEquals("a",g);assertEquals("a-b",goog.getCssName(g,"disabled"));assertEquals("a-b",goog.getCssName("goog-disabled"));assertEquals("a-button",goog.getCssName("goog-button"));goog.setCssNameMapping({"goog-button":"a",active:"b"},"BY_WHOLE");g=goog.getCssName("goog-button");assertEquals("a",g);assertEquals("a-b",goog.getCssName(g,"active"));assertEquals("goog-disabled",goog.getCssName("goog-disabled"));e=assertThrows(function(){goog.getCssName(".name")});assertEquals("className passed in goog.getCssName must not start with \".\"."+" You passed: .name",e.message);assertNull(goog.getCssName(null))}function testGetCssName_nameMapFn(){assertEquals("classname",goog.getCssName("classname"));goog.global.CLOSURE_CSS_NAME_MAP_FN=function(classname){return classname+"!"};assertEquals("classname!",goog.getCssName("classname"))}function testAddDependency(){stubs.set(goog,"writeScriptTag_",goog.nullFunction);goog.addDependency("foo.js",["testDep.foo"],["testDep.bar"]);goog.provide("testDep.bar");var require=goog.require;require("testDep.foo");assertTrue(goog.isObject(testDep.bar));testDep=void 0}function testAddDependencyModule(){var load=goog.testing.recordFunction();stubs.set(goog,"writeScriptTag_",load);goog.addDependency("mod.js",["testDep.mod"],[],!0);goog.addDependency("empty.js",["testDep.empty"],[],{});goog.addDependency("mod-goog.js",["testDep.goog"],[],{module:"goog"});var require=goog.require,assertModuleLoad=function(module,args){assertEquals(2,args.length);assertEquals("",args[0]);assertRegExp("^goog\\.retrieveAndExec_\\(\".*/"+module+"\", true, false\\);$",args[1])};require("testDep.mod");assertEquals(1,load.getCallCount());assertModuleLoad("mod.js",load.getCalls()[0].getArguments());require("testDep.empty");assertEquals(2,load.getCallCount());assertEquals(2,load.getCalls()[1].getArguments().length);assertRegExp("^.*/empty.js$",load.getCalls()[1].getArguments()[0]);assertUndefined(load.getCalls()[1].getArguments()[1]);require("testDep.goog");assertEquals(3,load.getCallCount());assertModuleLoad("mod-goog.js",load.getCalls()[2].getArguments());testDep=void 0}function testAddDependencyEs6(){var script=null,requireTranspilation=!1;stubs.set(goog,"needsTranspile_",function(){return requireTranspilation});stubs.set(goog,"writeScriptTag_",function(src,scriptText){if(null!=script){throw new Error("Multiple scripts written")}script=scriptText});goog.addDependency("fancy.js",["testDep.fancy"],[],{lang:"es6-impl",module:"goog"});goog.addDependency("super.js",["testDep.superFancy"],[],{lang:"es6"});var require=goog.require;requireTranspilation=!1;require("testDep.fancy");assertRegExp(/^goog\.retrieveAndExec_\(".*\/fancy\.js", true, false\);$/,script);script=null;requireTranspilation=!0;require("testDep.superFancy");assertRegExp(/^goog\.retrieveAndExec_\(".*\/super\.js", false, true\);$/,script);testDep=void 0}function testBaseMethod(){function A(){}A.prototype.foo=function(x,y){return x+y};function B(){}goog.inherits(B,A);B.prototype.foo=function(x,y){return 2+goog.base(this,"foo",x,y)};function C(){}goog.inherits(C,B);C.prototype.foo=function(x,y){return 4+goog.base(this,"foo",x,y)};var d=new C;d.foo=function(x,y){return 8+goog.base(this,"foo",x,y)};assertEquals(15,d.foo(1,0));assertEquals(16,d.foo(1,1));assertEquals(16,d.foo(2,0));assertEquals(7,new C().foo(1,0));assertEquals(3,new B().foo(1,0));assertThrows(function(){goog.base(d,"foo",1,0)});delete B.prototype.foo;assertEquals(13,d.foo(1,0));delete C.prototype.foo;assertEquals(9,d.foo(1,0))}function testBaseMethodAndBaseCtor(){function A(x,y){this.foo(x,y)}A.prototype.foo=function(x,y){this.bar=x+y};function B(x,y){goog.base(this,x,y)}goog.inherits(B,A);B.prototype.foo=function(x,y){goog.base(this,"foo",x,y);this.bar=2*this.bar};assertEquals(14,new B(3,4).bar)}function testBaseClass(){function A(x,y){this.foo=x+y}function B(x,y){goog.base(this,x,y);this.foo+=2}goog.inherits(B,A);function C(x,y){goog.base(this,x,y);this.foo+=4}goog.inherits(C,B);function D(x,y){goog.base(this,x,y);this.foo+=8}goog.inherits(D,C);assertEquals(15,new D(1,0).foo);assertEquals(16,new D(1,1).foo);assertEquals(16,new D(2,0).foo);assertEquals(7,new C(1,0).foo);assertEquals(3,new B(1,0).foo)}function testClassBaseOnMethod(){function A(){}A.prototype.foo=function(x,y){return x+y};function B(){}goog.inherits(B,A);B.prototype.foo=function(x,y){return 2+B.base(this,"foo",x,y)};function C(){}goog.inherits(C,B);C.prototype.foo=function(x,y){return 4+C.base(this,"foo",x,y)};var d=new C;assertEquals(7,d.foo(1,0));assertEquals(8,d.foo(1,1));assertEquals(8,d.foo(2,0));assertEquals(3,new B().foo(1,0));delete B.prototype.foo;assertEquals(5,d.foo(1,0));delete C.prototype.foo;assertEquals(1,d.foo(1,0))}function testClassBaseOnConstructor(){function A(x,y){this.foo=x+y}function B(x,y){B.base(this,"constructor",x,y);this.foo+=2}goog.inherits(B,A);function C(x,y){C.base(this,"constructor",x,y);this.foo+=4}goog.inherits(C,B);function D(x,y){D.base(this,"constructor",x,y);this.foo+=8}goog.inherits(D,C);assertEquals(15,new D(1,0).foo);assertEquals(16,new D(1,1).foo);assertEquals(16,new D(2,0).foo);assertEquals(7,new C(1,0).foo);assertEquals(3,new B(1,0).foo)}function testClassBaseOnMethodAndBaseCtor(){function A(x,y){this.foo(x,y)}A.prototype.foo=function(x,y){this.bar=x+y};function B(x,y){B.base(this,"constructor",x,y)}goog.inherits(B,A);B.prototype.foo=function(x,y){B.base(this,"foo",x,y);this.bar=2*this.bar};assertEquals(14,new B(3,4).bar)}function testGoogRequireCheck(){stubs.set(goog,"ENABLE_DEBUG_LOADER",!0);stubs.set(goog,"useStrictRequires",!0);stubs.set(goog,"implicitNamespaces_",{});var require=goog.require;assertThrows("Requiring non-required namespace should fail",function(){require("far.outnotprovided")});assertUndefined(goog.global.far);assertEvaluatesToFalse(goog.getObjectByName("far.out"));assertObjectEquals({},goog.implicitNamespaces_);assertFalse(goog.isProvided_("far.out"));goog.provide("far.out");assertNotUndefined(far.out);assertEvaluatesToTrue(goog.getObjectByName("far.out"));assertObjectEquals({far:!0},goog.implicitNamespaces_);assertTrue(goog.isProvided_("far.out"));goog.global.far.out=42;assertEquals(42,goog.getObjectByName("far.out"));assertTrue(goog.isProvided_("far.out"));goog.global.far.out="";assertEquals("",goog.getObjectByName("far.out"));assertTrue(goog.isProvided_("far.out"));goog.global.far.out=null;assertNull(goog.getObjectByName("far.out"));assertFalse(goog.isProvided_("far.out"));goog.global.far.out=void 0;assertNull(goog.getObjectByName("far.out"));assertFalse(goog.isProvided_("far.out"));stubs.reset();delete far}function diables_testCspSafeGoogRequire(){if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("10")){return}stubs.set(goog,"ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING",!0);var require=goog.require;require("goog.Uri");var ASYNC_TIMEOUT_MS=1e3,resolver=goog.Promise.withResolver();window.setTimeout(function(){assertNotUndefined(goog.Uri);resolver.resolve();stubs.reset()},ASYNC_TIMEOUT_MS);return resolver.promise}function testLateRequireProtection(){if(!document.readyState)return;var e=assertThrows(function(){var require=goog.require;require("goog.ui.Component")});assertContains("after document load",e.message)}function testDefineClass(){var Base=goog.defineClass(null,{constructor:function(foo){this.foo=foo},statics:{x:42},frobnicate:function(){return this.foo+this.foo}}),Derived=goog.defineClass(Base,{constructor:function(){Derived.base(this,"constructor","bar")},frozzle:function(foo){this.foo=foo}});assertEquals(42,Base.x);var der=new Derived;assertEquals("barbar",der.frobnicate());der.frozzle("qux");assertEquals("quxqux",der.frobnicate())}function testDefineClass_interface(){var Interface=goog.defineClass(null,{statics:{foo:"bar"},qux:function(){}});assertEquals("bar",Interface.foo);assertThrows(function(){new Interface})}function testDefineClass_seals(){if(!(Object.seal instanceof Function))return;var A=goog.defineClass(null,{constructor:function(){}}),a=new A;try{a.foo="bar"}catch(expectedInStrictModeOnly){}assertEquals(void 0,a.foo)}function testDefineClass_unsealable(){var LegacyBase=function(){};LegacyBase.prototype.foo=null;LegacyBase.prototype.setFoo=function(foo){this.foo=foo};goog.tagUnsealableClass(LegacyBase);var Derived=goog.defineClass(LegacyBase,{constructor:function(){}}),der=new Derived;der.setFoo("bar");assertEquals("bar",der.foo)}function testDefineClass_constructorIsNotWrappedWhenSealingIsDisabled(){var org=goog.defineClass,ctr=null,replacement=function(superClass,def){ctr=def.constructor;return org(superClass,def)};goog.object.extend(replacement,org);replacement.SEAL_CLASS_INSTANCES=!1;stubs.replace(goog,"defineClass",replacement);var MyClass=goog.defineClass(null,{constructor:function(){}});assertEquals("The constructor should not be wrapped.",ctr,MyClass)}function testDefineClass_unsealableConstructorIsWrapped(){var LegacyBase=function(){};LegacyBase.prototype.foo=null;LegacyBase.prototype.setFoo=function(foo){this.foo=foo};goog.tagUnsealableClass(LegacyBase);var org=goog.defineClass,ctr=null,replacement=function(superClass,def){ctr=def.constructor;return org(superClass,def)};goog.object.extend(replacement,org);stubs.replace(goog,"defineClass",replacement);var Derived=goog.defineClass(LegacyBase,{constructor:function(){}});assertNotEquals("The constructor should be wrapped.",ctr,Derived)}function testGoogModuleGet(){assertUndefined("module failed to protect global namespace: "+"goog.test_module_dep",goog.test_module_dep);assertNotUndefined("module failed to declare global namespace: "+"goog.test_module",goog.test_module);assertNotUndefined("module failed to protect global namespace: "+"goog.test_module_dep",earlyTestModuleGet);assertEquals(null,goog.module.get("unrequired.module.id"));var testModuleExports=goog.module.get("goog.test_module");assertTrue(goog.isFunction(testModuleExports));assertEquals(earlyTestModuleGet,testModuleExports)}function testGoogLoadModuleByUrl(){if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("10")){return}stubs.set(goog,"loadFileSync_",function(src){return"closure load file sync: "+src});var err=assertThrows("loadModuleFromUrl should not hide failures",function(){goog.loadModuleFromUrl("bogus url")});assertContains("Cannot write \"bogus url\" after document load",err.message)}function testLoadFileSync(){var fileContents=goog.loadFileSync_("deps.js");assertTrue("goog.loadFileSync_ returns string","string"===typeof fileContents);assertTrue("goog.loadFileSync_ string length > 0",0<fileContents.length);stubs.set(goog.global,"CLOSURE_LOAD_FILE_SYNC",function(src){return"closure load file sync: "+src});assertEquals("goog.CLOSURE_LOAD_FILE_SYNC override",goog.loadFileSync_("test url"),"closure load file sync: test url")}function testNormalizePath1(){assertEquals("foo/path.js",goog.normalizePath_("./foo/./path.js"));assertEquals("foo/path.js",goog.normalizePath_("bar/../foo/path.js"));assertEquals("bar/path.js",goog.normalizePath_("bar/foo/../path.js"));assertEquals("path.js",goog.normalizePath_("bar/foo/../../path.js"));assertEquals("../foo/path.js",goog.normalizePath_("../foo/path.js"));assertEquals("../../foo/path.js",goog.normalizePath_("../../foo/path.js"));assertEquals("../path.js",goog.normalizePath_("../foo/../path.js"));assertEquals("../../path.js",goog.normalizePath_("../foo/../../path.js"));assertEquals("/../foo/path.js",goog.normalizePath_("/../foo/path.js"));assertEquals("/path.js",goog.normalizePath_("/foo/../path.js"));assertEquals("/foo/path.js",goog.normalizePath_("/./foo/path.js"));assertEquals("//../foo/path.js",goog.normalizePath_("//../foo/path.js"));assertEquals("//path.js",goog.normalizePath_("//foo/../path.js"));assertEquals("//foo/path.js",goog.normalizePath_("//./foo/path.js"));assertEquals("http://../x/y.js",goog.normalizePath_("http://../x/y.js"));assertEquals("http://path.js",goog.normalizePath_("http://foo/../path.js"));assertEquals("http://x/path.js",goog.normalizePath_("http://./x/path.js"))}function testGoogModuleNames(){var module=goog.module;function assertInvalidId(id){var err=assertThrows(function(){module(id)});assertEquals("Invalid module identifier",err.message)}function assertValidId(id){var err=assertThrows(function(){module(id)});assertTrue(-1!=err.message.indexOf("has been loaded incorrectly"))}assertInvalidId("/somepath/module.js");assertInvalidId("./module.js");assertInvalidId("1");assertValidId("a");assertValidId("a.b");assertValidId("a.b.c");assertValidId("aB.Cd.eF");assertValidId("a1.0E.Fg");assertValidId("_");assertValidId("$");assertValidId("_$");assertValidId("$_")}