goog.provide("goog.debug.Formatter");goog.provide("goog.debug.HtmlFormatter");goog.provide("goog.debug.TextFormatter");goog.require("goog.debug");goog.require("goog.debug.Logger");goog.require("goog.debug.RelativeTimeProvider");goog.require("goog.html.SafeHtml");goog.debug.Formatter=function(opt_prefix){this.prefix_=opt_prefix||"";this.startTimeProvider_=goog.debug.RelativeTimeProvider.getDefaultInstance()};goog.debug.Formatter.prototype.appendNewline=!0;goog.debug.Formatter.prototype.showAbsoluteTime=!0;goog.debug.Formatter.prototype.showRelativeTime=!0;goog.debug.Formatter.prototype.showLoggerName=!0;goog.debug.Formatter.prototype.showExceptionText=!1;goog.debug.Formatter.prototype.showSeverityLevel=!1;goog.debug.Formatter.prototype.formatRecord=goog.abstractMethod;goog.debug.Formatter.prototype.formatRecordAsHtml=goog.abstractMethod;goog.debug.Formatter.prototype.setStartTimeProvider=function(provider){this.startTimeProvider_=provider};goog.debug.Formatter.prototype.getStartTimeProvider=function(){return this.startTimeProvider_};goog.debug.Formatter.prototype.resetRelativeTimeStart=function(){this.startTimeProvider_.reset()};goog.debug.Formatter.getDateTimeStamp_=function(logRecord){var time=new Date(logRecord.getMillis());return goog.debug.Formatter.getTwoDigitString_(time.getFullYear()-2e3)+goog.debug.Formatter.getTwoDigitString_(time.getMonth()+1)+goog.debug.Formatter.getTwoDigitString_(time.getDate())+" "+goog.debug.Formatter.getTwoDigitString_(time.getHours())+":"+goog.debug.Formatter.getTwoDigitString_(time.getMinutes())+":"+goog.debug.Formatter.getTwoDigitString_(time.getSeconds())+"."+goog.debug.Formatter.getTwoDigitString_(Math.floor(time.getMilliseconds()/10))};goog.debug.Formatter.getTwoDigitString_=function(n){if(10>n){return"0"+n}return n+""};goog.debug.Formatter.getRelativeTime_=function(logRecord,relativeTimeStart){var ms=logRecord.getMillis()-relativeTimeStart,sec=ms/1e3,str=sec.toFixed(3),spacesToPrepend=0;if(1>sec){spacesToPrepend=2}else{while(100>sec){spacesToPrepend++;sec*=10}}while(0<spacesToPrepend--){str=" "+str}return str};goog.debug.HtmlFormatter=function(opt_prefix){goog.debug.Formatter.call(this,opt_prefix)};goog.inherits(goog.debug.HtmlFormatter,goog.debug.Formatter);goog.debug.HtmlFormatter.prototype.showExceptionText=!0;goog.debug.HtmlFormatter.prototype.formatRecord=function(logRecord){if(!logRecord){return""}return this.formatRecordAsHtml(logRecord).getTypedStringValue()};goog.debug.HtmlFormatter.prototype.formatRecordAsHtml=function(logRecord){if(!logRecord){return goog.html.SafeHtml.EMPTY}var className;switch(logRecord.getLevel().value){case goog.debug.Logger.Level.SHOUT.value:className="dbg-sh";break;case goog.debug.Logger.Level.SEVERE.value:className="dbg-sev";break;case goog.debug.Logger.Level.WARNING.value:className="dbg-w";break;case goog.debug.Logger.Level.INFO.value:className="dbg-i";break;case goog.debug.Logger.Level.FINE.value:default:className="dbg-f";break;}var sb=[this.prefix_," "];if(this.showAbsoluteTime){sb.push("[",goog.debug.Formatter.getDateTimeStamp_(logRecord),"] ")}if(this.showRelativeTime){sb.push("[",goog.debug.Formatter.getRelativeTime_(logRecord,this.startTimeProvider_.get()),"s] ")}if(this.showLoggerName){sb.push("[",logRecord.getLoggerName(),"] ")}if(this.showSeverityLevel){sb.push("[",logRecord.getLevel().name,"] ")}var fullPrefixHtml=goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces(sb.join("")),exceptionHtml=goog.html.SafeHtml.EMPTY;if(this.showExceptionText&&logRecord.getException()){exceptionHtml=goog.html.SafeHtml.concat(goog.html.SafeHtml.BR,goog.debug.exposeExceptionAsHtml(logRecord.getException()))}var logRecordHtml=goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces(logRecord.getMessage()),recordAndExceptionHtml=goog.html.SafeHtml.create("span",{class:className},goog.html.SafeHtml.concat(logRecordHtml,exceptionHtml)),html;if(this.appendNewline){html=goog.html.SafeHtml.concat(fullPrefixHtml,recordAndExceptionHtml,goog.html.SafeHtml.BR)}else{html=goog.html.SafeHtml.concat(fullPrefixHtml,recordAndExceptionHtml)}return html};goog.debug.TextFormatter=function(opt_prefix){goog.debug.Formatter.call(this,opt_prefix)};goog.inherits(goog.debug.TextFormatter,goog.debug.Formatter);goog.debug.TextFormatter.prototype.formatRecord=function(logRecord){var sb=[this.prefix_," "];if(this.showAbsoluteTime){sb.push("[",goog.debug.Formatter.getDateTimeStamp_(logRecord),"] ")}if(this.showRelativeTime){sb.push("[",goog.debug.Formatter.getRelativeTime_(logRecord,this.startTimeProvider_.get()),"s] ")}if(this.showLoggerName){sb.push("[",logRecord.getLoggerName(),"] ")}if(this.showSeverityLevel){sb.push("[",logRecord.getLevel().name,"] ")}sb.push(logRecord.getMessage());if(this.showExceptionText){var exception=logRecord.getException();if(exception){var exceptionText=exception instanceof Error?exception.message:exception.toString();sb.push("\n",exceptionText)}}if(this.appendNewline){sb.push("\n")}return sb.join("")};goog.debug.TextFormatter.prototype.formatRecordAsHtml=function(logRecord){return goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces(goog.debug.TextFormatter.prototype.formatRecord(logRecord))};