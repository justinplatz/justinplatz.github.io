goog.provide("goog.dom.xml");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.userAgent");goog.dom.xml.MAX_XML_SIZE_KB=1024*2;goog.dom.xml.MAX_ELEMENT_DEPTH=256;goog.dom.xml.hasActiveXObjectSupport_=function(){if(!goog.userAgent.IE){return!1}try{new ActiveXObject("MSXML2.DOMDocument");return!0}catch(e){return!1}};goog.dom.xml.ACTIVEX_SUPPORT=goog.userAgent.IE&&goog.dom.xml.hasActiveXObjectSupport_();goog.dom.xml.createDocument=function(opt_rootTagName,opt_namespaceUri,opt_preferActiveX){if(opt_namespaceUri&&!opt_rootTagName){throw Error("Can't create document with namespace and no root tag")}if(document.implementation&&document.implementation.createDocument&&!(goog.dom.xml.ACTIVEX_SUPPORT&&opt_preferActiveX)){return document.implementation.createDocument(opt_namespaceUri||"",opt_rootTagName||"",null)}else if(goog.dom.xml.ACTIVEX_SUPPORT){var doc=goog.dom.xml.createMsXmlDocument_();if(doc){if(opt_rootTagName){doc.appendChild(doc.createNode(goog.dom.NodeType.ELEMENT,opt_rootTagName,opt_namespaceUri||""))}return doc}}throw Error("Your browser does not support creating new documents")};goog.dom.xml.loadXml=function(xml,opt_preferActiveX){if("undefined"!=typeof DOMParser&&!(goog.dom.xml.ACTIVEX_SUPPORT&&opt_preferActiveX)){return new DOMParser().parseFromString(xml,"application/xml")}else if(goog.dom.xml.ACTIVEX_SUPPORT){var doc=goog.dom.xml.createMsXmlDocument_();doc.loadXML(xml);return doc}throw Error("Your browser does not support loading xml documents")};goog.dom.xml.serialize=function(xml){var text=xml.xml;if(text){return text}if("undefined"!=typeof XMLSerializer){return new XMLSerializer().serializeToString(xml)}throw Error("Your browser does not support serializing XML documents")};goog.dom.xml.selectSingleNode=function(node,path){if("undefined"!=typeof node.selectSingleNode){var doc=goog.dom.getOwnerDocument(node);if("undefined"!=typeof doc.setProperty){doc.setProperty("SelectionLanguage","XPath")}return node.selectSingleNode(path)}else if(document.implementation.hasFeature("XPath","3.0")){var doc=goog.dom.getOwnerDocument(node),resolver=doc.createNSResolver(doc.documentElement),result=doc.evaluate(path,node,resolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return result.singleNodeValue}return null};goog.dom.xml.selectNodes=function(node,path){if("undefined"!=typeof node.selectNodes){var doc=goog.dom.getOwnerDocument(node);if("undefined"!=typeof doc.setProperty){doc.setProperty("SelectionLanguage","XPath")}return node.selectNodes(path)}else if(document.implementation.hasFeature("XPath","3.0")){for(var doc=goog.dom.getOwnerDocument(node),resolver=doc.createNSResolver(doc.documentElement),nodes=doc.evaluate(path,node,resolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),results=[],count=nodes.snapshotLength,i=0;i<count;i++){results.push(nodes.snapshotItem(i))}return results}else{return[]}};goog.dom.xml.setAttributes=function(element,attributes){for(var key in attributes){if(attributes.hasOwnProperty(key)){element.setAttribute(key,attributes[key])}}};goog.dom.xml.createMsXmlDocument_=function(){var doc=new ActiveXObject("MSXML2.DOMDocument");if(doc){doc.resolveExternals=!1;doc.validateOnParse=!1;try{doc.setProperty("ProhibitDTD",!0);doc.setProperty("MaxXMLSize",goog.dom.xml.MAX_XML_SIZE_KB);doc.setProperty("MaxElementDepth",goog.dom.xml.MAX_ELEMENT_DEPTH)}catch(e){}}return doc};