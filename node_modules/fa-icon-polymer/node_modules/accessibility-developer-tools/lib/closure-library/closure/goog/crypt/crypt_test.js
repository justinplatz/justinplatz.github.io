goog.provide("goog.cryptTest");goog.setTestOnly("goog.cryptTest");goog.require("goog.crypt");goog.require("goog.string");goog.require("goog.testing.jsunit");var UTF8_RANGES_BYTE_ARRAY=[0,127,194,128,223,191,224,160,128,239,191,191],UTF8_SURROGATE_PAIR_RANGES_BYTE_ARRAY=[240,144,128,128,240,144,143,191,244,143,176,128,244,143,191,191],UTF8_RANGES_STRING="\0\x7F\x80\u07FF\u0800\uFFFF",UTF8_SURROGATE_PAIR_RANGES_STRING="\uD800\uDC00\uD800\uDFFF\uDBFF\uDC00\uDBFF\uDFFF";function testStringToUtf8ByteArray(){assertArrayEquals("ASCII",[72,101,108,108,111,44,32,119,111,114,108,100],goog.crypt.stringToUtf8ByteArray("Hello, world"));assertArrayEquals("Latin",[83,99,104,195,182,110],goog.crypt.stringToUtf8ByteArray("Sch\xF6n"));assertArrayEquals("limits of the first 3 UTF-8 character ranges",UTF8_RANGES_BYTE_ARRAY,goog.crypt.stringToUtf8ByteArray(UTF8_RANGES_STRING));assertArrayEquals("Surrogate Pair",UTF8_SURROGATE_PAIR_RANGES_BYTE_ARRAY,goog.crypt.stringToUtf8ByteArray(UTF8_SURROGATE_PAIR_RANGES_STRING))}function testUtf8ByteArrayToString(){assertEquals("ASCII","Hello, world",goog.crypt.utf8ByteArrayToString([72,101,108,108,111,44,32,119,111,114,108,100]));assertEquals("Latin","Sch\xF6n",goog.crypt.utf8ByteArrayToString([83,99,104,195,182,110]));assertEquals("limits of the first 3 UTF-8 character ranges",UTF8_RANGES_STRING,goog.crypt.utf8ByteArrayToString(UTF8_RANGES_BYTE_ARRAY));assertEquals("Surrogate Pair",UTF8_SURROGATE_PAIR_RANGES_STRING,goog.crypt.utf8ByteArrayToString(UTF8_SURROGATE_PAIR_RANGES_BYTE_ARRAY))}function testUint8ArrayToString(){if(!goog.global.Uint8Array){return}var arr=new Uint8Array([72,101,108,108,111,44,32,119,111,114,108,100]);assertEquals("ASCII","Hello, world",goog.crypt.utf8ByteArrayToString(arr));arr=new Uint8Array([83,99,104,195,182,110]);assertEquals("Latin","Sch\xF6n",goog.crypt.utf8ByteArrayToString(arr));arr=new Uint8Array(UTF8_RANGES_BYTE_ARRAY);assertEquals("limits of the first 3 UTF-8 character ranges",UTF8_RANGES_STRING,goog.crypt.utf8ByteArrayToString(arr))}function testByteArrayToString(){assertEquals("",goog.crypt.byteArrayToString([]));assertEquals("abc",goog.crypt.byteArrayToString([97,98,99]))}function testHexToByteArray(){assertElementsEquals([202,254,222,173],goog.crypt.hexToByteArray("cafedead"));assertElementsEquals([222,173,190,239],goog.crypt.hexToByteArray("DEADBEEF"))}function testByteArrayToHex(){assertEquals("cafedead",goog.crypt.byteArrayToHex([202,254,222,173]));assertEquals("deadbeef",goog.crypt.byteArrayToHex([222,173,190,239]))}function testUint8ArrayToHex(){if(!goog.isDef(goog.global.Uint8Array)){return}assertEquals("cafedead",goog.crypt.byteArrayToHex(new Uint8Array([202,254,222,173])));assertEquals("deadbeef",goog.crypt.byteArrayToHex(new Uint8Array([222,173,190,239])))}function testXorByteArray(){assertElementsEquals([20,83,96,66],goog.crypt.xorByteArray([202,254,222,173],[222,173,190,239]))}function testXorUint8Array(){if(!goog.isDef(goog.global.Uint8Array)){return}assertElementsEquals([20,83,96,66],goog.crypt.xorByteArray(new Uint8Array([202,254,222,173]),new Uint8Array([222,173,190,239])))}function testByteArrayToStringCallStack(){for(var count=1048576,bytes=[],i=0;i<count;i++){bytes.push("A".charCodeAt(0))}var str=goog.crypt.byteArrayToString(bytes);assertEquals(goog.string.repeat("A",count),str)}