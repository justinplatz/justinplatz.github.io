goog.provide("goog.net.ChannelDebug");goog.require("goog.json");goog.require("goog.log");goog.net.ChannelDebug=function(){this.logger_=goog.log.getLogger("goog.net.BrowserChannel")};goog.net.ChannelDebug.prototype.getLogger=function(){return this.logger_};goog.net.ChannelDebug.prototype.browserOfflineResponse=function(url){this.info("BROWSER_OFFLINE: "+url)};goog.net.ChannelDebug.prototype.xmlHttpChannelRequest=function(verb,uri,id,attempt,postData){this.info("XMLHTTP REQ ("+id+") [attempt "+attempt+"]: "+verb+"\n"+uri+"\n"+this.maybeRedactPostData_(postData))};goog.net.ChannelDebug.prototype.xmlHttpChannelResponseMetaData=function(verb,uri,id,attempt,readyState,statusCode){this.info("XMLHTTP RESP ("+id+") [ attempt "+attempt+"]: "+verb+"\n"+uri+"\n"+readyState+" "+statusCode)};goog.net.ChannelDebug.prototype.xmlHttpChannelResponseText=function(id,responseText,opt_desc){this.info("XMLHTTP TEXT ("+id+"): "+this.redactResponse_(responseText)+(opt_desc?" "+opt_desc:""))};goog.net.ChannelDebug.prototype.tridentChannelRequest=function(verb,uri,id,attempt){this.info("TRIDENT REQ ("+id+") [ attempt "+attempt+"]: "+verb+"\n"+uri)};goog.net.ChannelDebug.prototype.tridentChannelResponseText=function(id,responseText){this.info("TRIDENT TEXT ("+id+"): "+this.redactResponse_(responseText))};goog.net.ChannelDebug.prototype.tridentChannelResponseDone=function(id,successful){this.info("TRIDENT TEXT ("+id+"): "+successful?"success":"failure")};goog.net.ChannelDebug.prototype.timeoutResponse=function(uri){this.info("TIMEOUT: "+uri)};goog.net.ChannelDebug.prototype.debug=function(text){this.info(text)};goog.net.ChannelDebug.prototype.dumpException=function(e,opt_msg){this.severe((opt_msg||"Exception")+e)};goog.net.ChannelDebug.prototype.info=function(text){goog.log.info(this.logger_,text)};goog.net.ChannelDebug.prototype.warning=function(text){goog.log.warning(this.logger_,text)};goog.net.ChannelDebug.prototype.severe=function(text){goog.log.error(this.logger_,text)};goog.net.ChannelDebug.prototype.redactResponse_=function(responseText){if(!responseText||responseText==goog.net.ChannelDebug.MAGIC_RESPONSE_COOKIE){return responseText}try{var responseArray=goog.json.unsafeParse(responseText);if(responseArray){for(var i=0;i<responseArray.length;i++){if(goog.isArray(responseArray[i])){this.maybeRedactArray_(responseArray[i])}}}return goog.json.serialize(responseArray)}catch(e){this.debug("Exception parsing expected JS array - probably was not JS");return responseText}};goog.net.ChannelDebug.prototype.maybeRedactArray_=function(array){if(2>array.length){return}var dataPart=array[1];if(!goog.isArray(dataPart)){return}if(1>dataPart.length){return}var type=dataPart[0];if("noop"!=type&&"stop"!=type){for(var i=1;i<dataPart.length;i++){dataPart[i]=""}}};goog.net.ChannelDebug.prototype.maybeRedactPostData_=function(data){if(!data){return null}for(var out="",params=data.split("&"),i=0;i<params.length;i++){var param=params[i],keyValue=param.split("=");if(1<keyValue.length){var key=keyValue[0],value=keyValue[1],keyParts=key.split("_");if(2<=keyParts.length&&"type"==keyParts[1]){out+=key+"="+value+"&"}else{out+=key+"="+"redacted"+"&"}}}return out};goog.net.ChannelDebug.MAGIC_RESPONSE_COOKIE="y2f%";