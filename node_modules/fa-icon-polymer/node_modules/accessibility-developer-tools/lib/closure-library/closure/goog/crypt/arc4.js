goog.provide("goog.crypt.Arc4");goog.require("goog.asserts");goog.crypt.Arc4=function(){this.state_=[];this.index1_=0;this.index2_=0};goog.crypt.Arc4.prototype.setKey=function(key,opt_length){goog.asserts.assertArray(key,"Key parameter must be a byte array");if(!opt_length){opt_length=key.length}for(var state=this.state_,i=0;256>i;++i){state[i]=i}for(var j=0,i=0;256>i;++i){j=255&j+state[i]+key[i%opt_length];var tmp=state[i];state[i]=state[j];state[j]=tmp}this.index1_=0;this.index2_=0};goog.crypt.Arc4.prototype.discard=function(length){for(var i=this.index1_,j=this.index2_,state=this.state_,n=0;n<length;++n){i=255&i+1;j=255&j+state[i];var tmp=state[i];state[i]=state[j];state[j]=tmp}this.index1_=i;this.index2_=j};goog.crypt.Arc4.prototype.crypt=function(data,opt_length){if(!opt_length){opt_length=data.length}for(var i=this.index1_,j=this.index2_,state=this.state_,n=0;n<opt_length;++n){i=255&i+1;j=255&j+state[i];var tmp=state[i];state[i]=state[j];state[j]=tmp;data[n]^=state[255&state[i]+state[j]]}this.index1_=i;this.index2_=j};