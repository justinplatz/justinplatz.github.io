goog.provide("goog.fs");goog.require("goog.array");goog.require("goog.async.Deferred");goog.require("goog.fs.Error");goog.require("goog.fs.FileReader");goog.require("goog.fs.FileSystemImpl");goog.require("goog.fs.url");goog.require("goog.userAgent");goog.fs.get_=function(type,size){var requestFileSystem=goog.global.requestFileSystem||goog.global.webkitRequestFileSystem;if(!goog.isFunction(requestFileSystem)){return goog.async.Deferred.fail(new Error("File API unsupported"))}var d=new goog.async.Deferred;requestFileSystem(type,size,function(fs){d.callback(new goog.fs.FileSystemImpl(fs))},function(err){d.errback(new goog.fs.Error(err,"requesting filesystem"))});return d};goog.fs.FileSystemType_={TEMPORARY:0,PERSISTENT:1};goog.fs.getTemporary=function(size){return goog.fs.get_(goog.fs.FileSystemType_.TEMPORARY,size)};goog.fs.getPersistent=function(size){return goog.fs.get_(goog.fs.FileSystemType_.PERSISTENT,size)};goog.fs.createObjectUrl=function(blob){return goog.fs.url.createObjectUrl(blob)};goog.fs.revokeObjectUrl=function(url){goog.fs.url.revokeObjectUrl(url)};goog.fs.browserSupportsObjectUrls=function(){return goog.fs.url.browserSupportsObjectUrls()};goog.fs.getBlob=function(var_args){var BlobBuilder=goog.global.BlobBuilder||goog.global.WebKitBlobBuilder;if(goog.isDef(BlobBuilder)){for(var bb=new BlobBuilder,i=0;i<arguments.length;i++){bb.append(arguments[i])}return bb.getBlob()}else{return goog.fs.getBlobWithProperties(goog.array.toArray(arguments))}};goog.fs.getBlobWithProperties=function(parts,opt_type,opt_endings){var BlobBuilder=goog.global.BlobBuilder||goog.global.WebKitBlobBuilder;if(goog.isDef(BlobBuilder)){for(var bb=new BlobBuilder,i=0;i<parts.length;i++){bb.append(parts[i],opt_endings)}return bb.getBlob(opt_type)}else if(goog.isDef(goog.global.Blob)){var properties={};if(opt_type){properties.type=opt_type}if(opt_endings){properties.endings=opt_endings}return new Blob(parts,properties)}else{throw Error("This browser doesn't seem to support creating Blobs")}};goog.fs.blobToString=function(blob,opt_encoding){return goog.fs.FileReader.readAsText(blob,opt_encoding)};goog.fs.sliceBlob=function(blob,start,opt_end){if(!goog.isDef(opt_end)){opt_end=blob.size}if(blob.webkitSlice){return blob.webkitSlice(start,opt_end)}else if(blob.mozSlice){return blob.mozSlice(start,opt_end)}else if(blob.slice){if(goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("13.0")||goog.userAgent.WEBKIT&&!goog.userAgent.isVersionOrHigher("537.1")){if(0>start){start+=blob.size}if(0>start){start=0}if(0>opt_end){opt_end+=blob.size}if(opt_end<start){opt_end=start}return blob.slice(start,opt_end-start)}return blob.slice(start,opt_end)}return null};