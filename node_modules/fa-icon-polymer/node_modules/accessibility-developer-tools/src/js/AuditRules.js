goog.require("axs.AuditRule");goog.provide("axs.AuditRules");(function(){var auditRulesByName={},auditRulesByCode={};axs.AuditRules.specs={};axs.AuditRules.addRule=function(spec){var auditRule=new axs.AuditRule(spec);if(auditRule.code in auditRulesByCode)throw new Error("Can not add audit rule with same code: \""+auditRule.code+"\"");if(auditRule.name in auditRulesByName)throw new Error("Can not add audit rule with same name: \""+auditRule.name+"\"");auditRulesByName[auditRule.name]=auditRulesByCode[auditRule.code]=auditRule;axs.AuditRules.specs[spec.name]=spec};axs.AuditRules.getRule=function(name){return auditRulesByName[name]||auditRulesByCode[name]||null};axs.AuditRules.getRules=function(opt_namesOnly){var ruleNames=Object.keys(auditRulesByName);if(opt_namesOnly)return ruleNames;return ruleNames.map(function(name){return this.getRule(name)},axs.AuditRules)};axs.AuditRules.getActiveRules=function(configuration){var auditRules;if(configuration.auditRulesToRun&&0<configuration.auditRulesToRun.length){auditRules=configuration.auditRulesToRun}else{auditRules=axs.AuditRules.getRules(!0)}if(configuration.auditRulesToIgnore){for(var i=0,auditRuleToIgnore;i<configuration.auditRulesToIgnore.length;i++){auditRuleToIgnore=configuration.auditRulesToIgnore[i];if(0>auditRules.indexOf(auditRuleToIgnore))continue;auditRules.splice(auditRules.indexOf(auditRuleToIgnore),1)}}return auditRules.map(axs.AuditRules.getRule)}})();