var type=require("type-detect"),Buffer;try{Buffer=require("buffer").Buffer}catch(ex){Buffer={};Buffer.isBuffer=function(){return!1}}module.exports=deepEqual;function deepEqual(a,b,m){if(sameValue(a,b)){return!0}else if("date"===type(a)){return dateEqual(a,b)}else if("regexp"===type(a)){return regexpEqual(a,b)}else if(Buffer.isBuffer(a)){return bufferEqual(a,b)}else if("arguments"===type(a)){return argumentsEqual(a,b,m)}else if(!typeEqual(a,b)){return!1}else if("object"!==type(a)&&"object"!==type(b)&&"array"!==type(a)&&"array"!==type(b)){return sameValue(a,b)}else{return objectEqual(a,b,m)}}function sameValue(a,b){if(a===b)return 0!==a||1/a===1/b;return a!==a&&b!==b}function typeEqual(a,b){return type(a)===type(b)}function dateEqual(a,b){if("date"!==type(b))return!1;return sameValue(a.getTime(),b.getTime())}function regexpEqual(a,b){if("regexp"!==type(b))return!1;return sameValue(a.toString(),b.toString())}function argumentsEqual(a,b,m){if("arguments"!==type(b))return!1;a=[].slice.call(a);b=[].slice.call(b);return deepEqual(a,b,m)}function enumerable(a){var res=[];for(var key in a)res.push(key);return res}function iterableEqual(a,b){if(a.length!==b.length)return!1;var i=0,match=!0;for(;i<a.length;i++){if(a[i]!==b[i]){match=!1;break}}return match}function bufferEqual(a,b){if(!Buffer.isBuffer(b))return!1;return iterableEqual(a,b)}function isValue(a){return null!==a&&a!==void 0}function objectEqual(a,b,m){if(!isValue(a)||!isValue(b)){return!1}if(a.prototype!==b.prototype){return!1}var i;if(m){for(i=0;i<m.length;i++){if(m[i][0]===a&&m[i][1]===b||m[i][0]===b&&m[i][1]===a){return!0}}}else{m=[]}try{var ka=enumerable(a),kb=enumerable(b)}catch(ex){return!1}ka.sort();kb.sort();if(!iterableEqual(ka,kb)){return!1}m.push([a,b]);var key;for(i=ka.length-1;0<=i;i--){key=ka[i];if(!deepEqual(a[key],b[key],m)){return!1}}return!0}