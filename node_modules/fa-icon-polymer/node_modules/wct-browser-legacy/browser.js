(function(){'use strict';window.__wctUseNpm=!0;var nativeSetInterval=window.setInterval,nativeSetTimeout=window.setTimeout,nativeRequestAnimationFrame=window.requestAnimationFrame;function safeStep(callback,stepFn){var err;try{stepFn()}catch(error){err=error}callback(err)}function testImmediate(name,testFn){if(0<testFn.length){return testImmediateAsync(name,testFn)}var err;try{testFn()}catch(error){err=error}test(name,function(done){done(err)})}function testImmediateAsync(name,testFn){var testComplete=!1,err;test(name,function(done){var intervalId=nativeSetInterval(function(){if(!testComplete)return;clearInterval(intervalId);done(err)},10)});try{testFn(function(error){if(error)err=error;testComplete=!0})}catch(error){err=error;testComplete=!0}}function flush(callback){var done=function done(){callback()},isIE="Microsoft Internet Explorer"===navigator.appName;if(isIE&&window.Platform&&window.Platform.performMicrotaskCheckpoint){var reallyDone_1=done;done=function doneIE(){Platform.performMicrotaskCheckpoint();nativeSetTimeout(reallyDone_1,0)}}var scope;if(window.Polymer&&window.Polymer.dom&&window.Polymer.dom.flush){scope=window.Polymer.dom}else if(window.Polymer&&window.Polymer.flush){scope=window.Polymer}else if(window.WebComponents&&window.WebComponents.flush){scope=window.WebComponents}if(scope){scope.flush()}nativeSetTimeout(done,0)}function animationFrameFlush(callback){flush(function(){nativeRequestAnimationFrame(function(){flush(callback)})})}function asyncPlatformFlush(callback){console.warn("asyncPlatformFlush is deprecated in favor of the more terse flush()");return window.flush(callback)}function waitFor(fn,next,intervalOrMutationEl,timeout,timeoutTime){timeoutTime=timeoutTime||Date.now()+(timeout||1e3);intervalOrMutationEl=intervalOrMutationEl||32;try{fn()}catch(e){if(Date.now()>timeoutTime){throw e}else{if("number"!==typeof intervalOrMutationEl){intervalOrMutationEl.onMutation(intervalOrMutationEl,function(){waitFor(fn,next,intervalOrMutationEl,timeout,timeoutTime)})}else{nativeSetTimeout(function(){waitFor(fn,next,intervalOrMutationEl,timeout,timeoutTime)},intervalOrMutationEl)}return}}next()}window.safeStep=safeStep;window.testImmediate=testImmediate;window.testImmediateAsync=testImmediateAsync;window.flush=flush;window.animationFrameFlush=animationFrameFlush;window.asyncPlatformFlush=asyncPlatformFlush;window.waitFor=waitFor;var _config={environmentScripts:!!window.__wctUseNpm?["stacky/browser.js","async/lib/async.js","lodash/index.js","mocha/mocha.js","chai/chai.js","@polymer/sinonjs/sinon.js","sinon-chai/lib/sinon-chai.js","accessibility-developer-tools/dist/js/axs_testing.js","@polymer/test-fixture/test-fixture.js"]:["stacky/browser.js","async/lib/async.js","lodash/lodash.js","mocha/mocha.js","chai/chai.js","sinonjs/sinon.js","sinon-chai/lib/sinon-chai.js","accessibility-developer-tools/dist/js/axs_testing.js"],environmentImports:!!window.__wctUseNpm?[]:["test-fixture/test-fixture.html"],root:null,waitForFrameworks:!0,waitFor:null,numConcurrentSuites:1,trackConsoleError:!0,mochaOptions:{timeout:1e3*10},verbose:!1};function setup(options){var childRunner=ChildRunner.current();if(childRunner){_deepMerge(_config,childRunner.parentScope.WCT._config);delete _config.mochaOptions.ui}if(options&&"object"===typeof options){_deepMerge(_config,options)}if(!_config.root){var root=scriptPrefix("browser.js");_config.root=basePath(root.substr(0,root.length-1));if(!_config.root){throw new Error("Unable to detect root URL for WCT sources. Please set WCT.root before including browser.js")}}}function get(key){return _config[key]}function _deepMerge(target,source){Object.keys(source).forEach(function(key){if(null!==target[key]&&"object"===typeof target[key]&&!Array.isArray(target[key])){_deepMerge(target[key],source[key])}else{target[key]=source[key]}})}function whenFrameworksReady(callback){debug("whenFrameworksReady");var done=function(){debug("whenFrameworksReady done");callback()};if(window.WebComponents&&!window.WebComponents.ready){debug("WebComponentsReady?");window.addEventListener("WebComponentsReady",function wcReady(){window.removeEventListener("WebComponentsReady",wcReady);debug("WebComponentsReady");done()})}else{done()}}function pluralizedStat(count,kind){if(1===count){return count+" "+kind+" test"}else{return count+" "+kind+" tests"}}function loadScript(path,done){var script=document.createElement("script");script.src=path;if(done){script.onload=done.bind(null,null);script.onerror=done.bind(null,"Failed to load script "+script.src)}document.head.appendChild(script)}function loadStyle(path,done){var link=document.createElement("link");link.rel="stylesheet";link.href=path;if(done){link.onload=done.bind(null,null);link.onerror=done.bind(null,"Failed to load stylesheet "+link.href)}document.head.appendChild(link)}function debug(){for(var var_args=[],_i=0;_i<arguments.length;_i++){var_args[_i]=arguments[_i]}if(!get("verbose")){return}var args=[window.location.pathname].concat(var_args);(console.debug||console.log).apply(console,args)}function parseUrl(url){var parts=url.match(/^(.*?)(?:\?(.*))?$/);return{base:parts[1],params:getParams(parts[2]||"")}}function expandUrl(url,base){if(!base)return url;if(url.match(/^(\/|https?:\/\/)/))return url;if("/"!==base.substr(base.length-1)){base=base+"/"}return base+url}function getParams(query){query="string"===typeof query?query:window.location.search;if("?"===query.substring(0,1)){query=query.substring(1)}if("/"===query.slice(-1)){query=query.substring(0,query.length-1)}if(""===query)return{};var result={};query.split("&").forEach(function(part){var pair=part.split("=");if(2!==pair.length){console.warn("Invalid URL query part:",part);return}var key=decodeURIComponent(pair[0]),value=decodeURIComponent(pair[1]);if(!result[key]){result[key]=[]}result[key].push(value)});return result}function mergeParams(target,source){Object.keys(source).forEach(function(key){if(!(key in target)){target[key]=[]}target[key]=target[key].concat(source[key])})}function getParam(param){var params=getParams();return params[param]?params[param][0]:null}function paramsToQuery(params){var pairs=[];Object.keys(params).forEach(function(key){params[key].forEach(function(value){pairs.push(encodeURIComponent(key)+"="+encodeURIComponent(value))})});return 0<pairs.length?"?"+pairs.join("&"):""}function getPathName(location){return"string"===typeof location?location:location.pathname}function basePath(location){return getPathName(location).match(/^.*\//)[0]}function relativeLocation(location,basePath){var path=getPathName(location);if(0===path.indexOf(basePath)){path=path.substring(basePath.length)}return path}function cleanLocation(location){var path=getPathName(location);if("/index.html"===path.slice(-11)){path=path.slice(0,path.length-10)}return path}function parallel(runners,maybeLimit,done){var limit;if("number"!==typeof maybeLimit){done=maybeLimit;limit=0}else{limit=maybeLimit}if(!runners.length){return done()}var called=!1,total=runners.length,numActive=0,numDone=0;function runnerDone(error){if(called){return}numDone=numDone+1;numActive=numActive-1;if(error||numDone>=total){called=!0;done(error)}else{runOne()}}function runOne(){if(limit&&numActive>=limit){return}if(!runners.length){return}numActive=numActive+1;runners.shift()(runnerDone)}runners.forEach(runOne)}function scriptPrefix(filename){var scripts=document.querySelectorAll("script[src*=\""+filename+"\"]");if(1!==scripts.length){return null}var script=scripts[0].src;return script.substring(0,script.indexOf(filename))}var util=Object.freeze({whenFrameworksReady:whenFrameworksReady,pluralizedStat:pluralizedStat,loadScript:loadScript,loadStyle:loadStyle,debug:debug,parseUrl:parseUrl,expandUrl:expandUrl,getParams:getParams,mergeParams:mergeParams,getParam:getParam,paramsToQuery:paramsToQuery,basePath:basePath,relativeLocation:relativeLocation,cleanLocation:cleanLocation,parallel:parallel,scriptPrefix:scriptPrefix}),ChildRunner=function(){function ChildRunner(url,parentScope){var urlBits=parseUrl(url);mergeParams(urlBits.params,getParams(parentScope.location.search));delete urlBits.params.cli_browser_id;this.url=urlBits.base+paramsToQuery(urlBits.params);this.parentScope=parentScope;this.state="initializing"}ChildRunner.current=function(){return ChildRunner.get(window)};ChildRunner.get=function(target,traversal){var childRunner=ChildRunner._byUrl[target.location.href];if(childRunner){return childRunner}if(window.parent===window){if(traversal){console.warn("Subsuite loaded but was never registered. This most likely is due to wonky history behavior. Reloading...");window.location.reload()}return null}return window.parent.WCT._ChildRunner.get(target,!0)};ChildRunner.prototype.run=function(done){debug("ChildRunner#run",this.url);this.state="loading";this.onRunComplete=done;this.iframe=document.createElement("iframe");this.iframe.src=this.url;this.iframe.classList.add("subsuite");var container=document.getElementById("subsuites");if(!container){container=document.createElement("div");container.id="subsuites";document.body.appendChild(container)}container.appendChild(this.iframe);this.url=this.iframe.src;ChildRunner._byUrl[this.url]=this;this.timeoutId=setTimeout(this.loaded.bind(this,new Error("Timed out loading "+this.url)),ChildRunner.loadTimeout);this.iframe.addEventListener("error",this.loaded.bind(this,new Error("Failed to load document "+this.url)));this.iframe.contentWindow.addEventListener("DOMContentLoaded",this.loaded.bind(this,null))};ChildRunner.prototype.loaded=function(error){debug("ChildRunner#loaded",this.url,error);if(null==this.iframe.contentWindow&&error){this.signalRunComplete(error);this.done();return}if(this.iframe.contentWindow.WCT){this.share=this.iframe.contentWindow.WCT.share}if(error){this.signalRunComplete(error);this.done()}};ChildRunner.prototype.ready=function(error){debug("ChildRunner#ready",this.url,error);if(this.timeoutId){clearTimeout(this.timeoutId)}if(error){this.signalRunComplete(error);this.done()}};ChildRunner.prototype.done=function(){debug("ChildRunner#done",this.url,arguments);this.ready();this.signalRunComplete();if(!this.iframe)return;setTimeout(function(){this.iframe.parentNode.removeChild(this.iframe);this.iframe=null}.bind(this),1)};ChildRunner.prototype.signalRunComplete=function(error){if(!this.onRunComplete)return;this.state="complete";this.onRunComplete(error);this.onRunComplete=null};ChildRunner.loadTimeout=6e4;ChildRunner._byUrl={};return ChildRunner}(),SOCKETIO_ENDPOINT=window.location.protocol+"//"+window.location.host,SOCKETIO_LIBRARY=SOCKETIO_ENDPOINT+"/socket.io/socket.io.js",CLISocket=function(){function CLISocket(browserId,socket){this.browserId=browserId;this.socket=socket}CLISocket.prototype.observe=function(runner){var _this=this;this.emitEvent("browser-start",{url:window.location.toString()});runner.on("test",function(test){_this.emitEvent("test-start",{test:getTitles(test)})});runner.on("test end",function(test){_this.emitEvent("test-end",{state:getState(test),test:getTitles(test),duration:test.duration,error:test.err})});runner.on("fail",function(test,err){if("test"!==test.type){_this.emitEvent("browser-fail","Error thrown outside of test function: "+err.stack)}});runner.on("childRunner start",function(childRunner){_this.emitEvent("sub-suite-start",childRunner.share)});runner.on("childRunner end",function(childRunner){_this.emitEvent("sub-suite-end",childRunner.share)});runner.on("end",function(){_this.emitEvent("browser-end")})};CLISocket.prototype.emitEvent=function(event,data){this.socket.emit("client-event",{browserId:this.browserId,event:event,data:data})};CLISocket.init=function(done){var browserId=getParam("cli_browser_id");if(!browserId)return done();if(ChildRunner.current())return done();loadScript(SOCKETIO_LIBRARY,function(error){if(error)return done(error);var socket=io(SOCKETIO_ENDPOINT);socket.on("error",function(error){socket.off();done(error)});socket.on("connect",function(){socket.off();done(null,new CLISocket(browserId,socket))})})};return CLISocket}();function getTitles(runnable){var titles=[];while(runnable&&!runnable.root&&runnable.title){titles.unshift(runnable.title);runnable=runnable.parent}return titles}function getState(runnable){if("passed"===runnable.state){return"passing"}else if("failed"===runnable.state){return"failing"}else if(runnable.pending){return"pending"}else{return"unknown"}}var console$1=window.console,FONT=";font: normal 13px \"Roboto\", \"Helvetica Neue\", \"Helvetica\", sans-serif;",STYLES={plain:FONT,suite:"color: #5c6bc0"+FONT,test:FONT,passing:"color: #259b24"+FONT,pending:"color: #e65100"+FONT,failing:"color: #c41411"+FONT,stack:"color: #c41411",results:FONT+"font-size: 16px"},userAgent=navigator.userAgent.toLowerCase(),CAN_STYLE_LOG=userAgent.match("firefox")||userAgent.match("webkit"),CAN_STYLE_GROUP=userAgent.match("webkit"),logIndent="";function log(text,style){text=text.split("\n").map(function(l){return logIndent+l}).join("\n");if(CAN_STYLE_LOG){console$1.log("%c"+text,STYLES[style]||STYLES.plain)}else{console$1.log(text)}}function logGroup(text,style){if(CAN_STYLE_GROUP){console$1.group("%c"+text,STYLES[style]||STYLES.plain)}else if(console$1.group){console$1.group(text)}else{logIndent=logIndent+"  ";log(text,style)}}function logGroupEnd(){if(console$1.groupEnd){console$1.groupEnd()}else{logIndent=logIndent.substr(0,logIndent.length-2)}}function logException(error){log(error.stack||error.message||error+"","stack")}var Console=function(){function Console(runner){Mocha.reporters.Base.call(this,runner);runner.on("suite",function(suite){if(suite.root){return}logGroup(suite.title,"suite")}.bind(this));runner.on("suite end",function(suite){if(suite.root){return}logGroupEnd()}.bind(this));runner.on("test",function(test){logGroup(test.title,"test")}.bind(this));runner.on("pending",function(test){logGroup(test.title,"pending")}.bind(this));runner.on("fail",function(_test,error){logException(error)}.bind(this));runner.on("test end",function(_test){logGroupEnd()}.bind(this));runner.on("end",this.logSummary.bind(this))}Console.prototype.logSummary=function(){logGroup("Test Results","results");if(0<this.stats.failures){log(pluralizedStat(this.stats.failures,"failing"),"failing")}if(0<this.stats.pending){log(pluralizedStat(this.stats.pending,"pending"),"pending")}log(pluralizedStat(this.stats.passes,"passing"));if(!this.stats.failures){log("test suite passed","passing")}log("Evaluated "+this.stats.tests+" tests in "+this.stats.duration+"ms.");logGroupEnd()};return Console}();function HTML(runner){var output=document.createElement("div");output.id="mocha";document.body.appendChild(output);runner.on("suite",function(_test){this.total=runner.total}.bind(this));Mocha.reporters.HTML.call(this,runner)}var style=document.createElement("style");style.textContent="\n    html, body {\n      position: relative;\n      height: 100%;\n      width:  100%;\n      min-width: 900px;\n    }\n    #mocha, #subsuites {\n      height: 100%;\n      position: absolute;\n      top: 0;\n    }\n    #mocha {\n      box-sizing: border-box;\n      margin: 0 !important;\n      padding: 60px 20px;\n      right: 0;\n      left: 500px;\n    }\n    #subsuites {\n      -ms-flex-direction: column;\n      -webkit-flex-direction: column;\n      display: -ms-flexbox;\n      display: -webkit-flex;\n      display: flex;\n      flex-direction: column;\n      left: 0;\n      width: 500px;\n    }\n    #subsuites .subsuite {\n      border: 0;\n      width: 100%;\n      height: 100%;\n    }\n    #mocha .test.pass .duration {\n      color: #555 !important;\n    }\n";document.head.appendChild(style);var STACKY_CONFIG={indent:"  ",locationStrip:[/^https?:\/\/[^\/]+/,/\?.*$/],filter:function(line){return!!line.location.match(/\/web-component-tester\/[^\/]+(\?.*)?$/)}},MOCHA_EVENTS=["start","end","suite","suite end","test","test end","hook","hook end","pass","fail","pending","childRunner end"],ESTIMATED_TESTS_PER_SUITE=3,MultiReporter=function(){function MultiReporter(numSuites,reporters,parent){var _this=this;this.reporters=reporters.map(function(reporter){return new reporter(_this)});this.parent=parent;this.basePath=parent&&parent.basePath||basePath(window.location);this.total=numSuites*ESTIMATED_TESTS_PER_SUITE;this.currentRunner=null;this.pendingEvents=[];this.emit("start")}MultiReporter.prototype.childReporter=function(location){var name=this.suiteTitle(location),self=this;return _a=function(){function ChildReporter(runner){runner.name=window.name;self.bindChildRunner(runner)}return ChildReporter}(),_a.title=window.name,_a;var _a};MultiReporter.prototype.done=function(){this.complete=!0;this.flushPendingEvents();this.emit("end")};MultiReporter.prototype.emitOutOfBandTest=function(title,error,suiteTitle,estimated){debug("MultiReporter#emitOutOfBandTest(",arguments,")");var root=new Mocha.Suite(suiteTitle||""),test=new Mocha.Test(title,function(){});test.parent=root;test.state=error?"failed":"passed";test.err=error;if(!estimated){this.total=this.total+ESTIMATED_TESTS_PER_SUITE}var runner={total:1};this.proxyEvent("start",runner);this.proxyEvent("suite",runner,root);this.proxyEvent("test",runner,test);if(error){this.proxyEvent("fail",runner,test,error)}else{this.proxyEvent("pass",runner,test)}this.proxyEvent("test end",runner,test);this.proxyEvent("suite end",runner,root);this.proxyEvent("end",runner)};MultiReporter.prototype.suiteTitle=function(location){var path=relativeLocation(location,this.basePath);path=cleanLocation(path);return path};MultiReporter.prototype.bindChildRunner=function(runner){var _this=this;MOCHA_EVENTS.forEach(function(eventName){runner.on(eventName,_this.proxyEvent.bind(_this,eventName,runner))})};MultiReporter.prototype.proxyEvent=function(eventName,runner){for(var _args=[],_i=2;_i<arguments.length;_i++){_args[_i-2]=arguments[_i]}var extraArgs=Array.prototype.slice.call(arguments,2);if(this.complete){console.warn("out of order Mocha event for "+runner.name+":",eventName,extraArgs);return}if(this.currentRunner&&runner!==this.currentRunner){this.pendingEvents.push(Array.prototype.slice.call(arguments));return}debug("MultiReporter#proxyEvent(",arguments,")");if("fail"===eventName&&!extraArgs[0].err){extraArgs[0].err=extraArgs[1]}if("start"===eventName){this.onRunnerStart(runner)}else if("end"===eventName){this.onRunnerEnd(runner)}else{this.cleanEvent(eventName,runner,extraArgs);this.emit.apply(this,[eventName].concat(extraArgs))}};MultiReporter.prototype.cleanEvent=function(eventName,_runner,extraArgs){if(extraArgs[0]){extraArgs[0]=this.showRootSuite(extraArgs[0])}if("fail"===eventName){extraArgs[1]=Stacky.normalize(extraArgs[1],STACKY_CONFIG)}if(extraArgs[0]&&extraArgs[0].err){extraArgs[0].err=Stacky.normalize(extraArgs[0].err,STACKY_CONFIG)}};MultiReporter.prototype.showRootSuite=function(node){var leaf=node=Object.create(node);while(node&&node.parent){var wrappedParent=Object.create(node.parent);node.parent=wrappedParent;node=wrappedParent}node.root=!1;return leaf};MultiReporter.prototype.onRunnerStart=function(runner){debug("MultiReporter#onRunnerStart:",runner.name);this.total=this.total-ESTIMATED_TESTS_PER_SUITE+runner.total;this.currentRunner=runner};MultiReporter.prototype.onRunnerEnd=function(runner){debug("MultiReporter#onRunnerEnd:",runner.name);this.currentRunner=null;this.flushPendingEvents()};MultiReporter.prototype.flushPendingEvents=function(){var _this=this,events=this.pendingEvents;this.pendingEvents=[];events.forEach(function(eventArgs){_this.proxyEvent.apply(_this,eventArgs)})};return MultiReporter}(),ARC_OFFSET=0,ARC_WIDTH=6,Title=function(){function Title(runner){Mocha.reporters.Base.call(this,runner);runner.on("test end",this.report.bind(this))}Title.prototype.report=function(){this.updateTitle();this.updateFavicon()};Title.prototype.updateTitle=function(){if(0<this.stats.failures){document.title=pluralizedStat(this.stats.failures,"failing")}else{document.title=pluralizedStat(this.stats.passes,"passing")}};Title.prototype.updateFavicon=function(){var canvas=document.createElement("canvas");canvas.height=canvas.width=32;var context=canvas.getContext("2d"),passing=this.stats.passes,pending=this.stats.pending,failing=this.stats.failures,total=Math.max(this.runner.total,passing+pending+failing);drawFaviconArc(context,total,0,passing,"#0e9c57");drawFaviconArc(context,total,passing,pending,"#f3b300");drawFaviconArc(context,total,pending+passing,failing,"#ff5621");this.setFavicon(canvas.toDataURL())};Title.prototype.setFavicon=function(url){var current=document.head.querySelector("link[rel=\"icon\"]");if(current){document.head.removeChild(current)}var link=document.createElement("link");link.rel="icon";link.type="image/x-icon";link.href=url;link.setAttribute("sizes","32x32");document.head.appendChild(link)};return Title}();function drawFaviconArc(context,total,start,length,color){var _MathPI=Math.PI,arcStart=ARC_OFFSET+2*_MathPI*(start/total),arcEnd=ARC_OFFSET+2*_MathPI*((start+length)/total);context.beginPath();context.strokeStyle=color;context.lineWidth=ARC_WIDTH;context.arc(16,16,16-ARC_WIDTH/2,arcStart,arcEnd);context.stroke()}var htmlSuites$1=[],jsSuites$1=[],GREP=getParam("grep");if(GREP){GREP=GREP.replace(/\\\./g,".")}function loadSuites(files){files.forEach(function(file){if(/\.js(\?.*)?$/.test(file)){jsSuites$1.push(file)}else if(/\.html(\?.*)?$/.test(file)){htmlSuites$1.push(file)}else{throw new Error("Unknown resource type: "+file)}})}function activeChildSuites(){var subsuites=htmlSuites$1;if(GREP){for(var cleanSubsuites=[],i=0,subsuite=void 0;subsuite=subsuites[i];i++){if(-1!==GREP.indexOf(cleanLocation(subsuite))){cleanSubsuites.push(subsuite)}}subsuites=cleanSubsuites}return subsuites}function loadJsSuites(_reporter,done){debug("loadJsSuites",jsSuites$1);var loaders=jsSuites$1.map(function(file){return loadScript.bind(util,file)});parallel(loaders,done)}function runSuites(reporter,childSuites,done){debug("runSuites");var suiteRunners=[_runMocha.bind(null,reporter)];childSuites.forEach(function(file){suiteRunners.push(function(next){var childRunner=new ChildRunner(file,window);reporter.emit("childRunner start",childRunner);childRunner.run(function(error){reporter.emit("childRunner end",childRunner);if(error)reporter.emitOutOfBandTest(file,error);next()})})});parallel(suiteRunners,get("numConcurrentSuites"),function(error){reporter.done();done(error)})}function _runMocha(reporter,done,waited){if(get("waitForFrameworks")&&!waited){var waitFor=(get("waitFor")||whenFrameworksReady).bind(window);waitFor(_runMocha.bind(null,reporter,done,!0));return}debug("_runMocha");var mocha=window.mocha,Mocha=window.Mocha;mocha.reporter(reporter.childReporter(window.location));mocha.suite.title=reporter.suiteTitle(window.location);mocha.grep(GREP);var runner=Mocha.prototype.run.call(mocha,function(_error){if(document.getElementById("mocha")){Mocha.utils.highlightTags("code")}done()});if(navigator.userAgent.match(/chrome/i)){window.onerror=null;window.addEventListener("error",function(event){if(!event.error)return;if(event.error.ignore)return;if(window.uncaughtErrorFilter&&window.uncaughtErrorFilter(event)){event.preventDefault();return}runner.uncaught(event.error)})}else{window.onerror=null;window.addEventListener("error",function(event){if(window.uncaughtErrorFilter&&window.uncaughtErrorFilter(event)){event.preventDefault();return}runner.uncaught(event.error)})}}function determineReporters(socket,parent){if(parent){return[parent.childReporter(window.location)]}var reporters=[Title,Console];if(socket){reporters.push(function(runner){socket.observe(runner)})}if(0<htmlSuites$1.length||0<jsSuites$1.length){reporters.push(HTML)}return reporters}function injectMocha(Mocha){_injectPrototype(Console,Mocha.reporters.Base.prototype);_injectPrototype(HTML,Mocha.reporters.HTML.prototype);_injectPrototype(MultiReporter,Object.getPrototypeOf(Mocha.Runner.prototype))}function _injectPrototype(klass,prototype){var newPrototype=Object.create(prototype);Object.keys(klass.prototype).forEach(function(key){newPrototype[key]=klass.prototype[key]});klass.prototype=newPrototype}function loadSync(){debug("Loading environment scripts:");var a11ySuiteScriptPath="web-component-tester/data/a11ySuite.js",scripts=get("environmentScripts"),a11ySuiteWillBeLoaded=window.__generatedByWct||-1<scripts.indexOf(a11ySuiteScriptPath);if(!a11ySuiteWillBeLoaded&&!window.__wctUseNpm){scripts.push(a11ySuiteScriptPath)}scripts.forEach(function(path){var url=expandUrl(path,get("root"));debug("Loading environment script:",url);document.write("<script src=\""+encodeURI(url)+"\"></script>")});debug("Environment scripts loaded");var imports=get("environmentImports");imports.forEach(function(path){var url=expandUrl(path,get("root"));debug("Loading environment import:",url);document.write("<link rel=\"import\" href=\""+encodeURI(url)+"\">")});debug("Environment imports loaded")}function ensureDependenciesPresent(){_ensureMocha();_checkChai()}function _ensureMocha(){var Mocha=window.Mocha;if(!Mocha){throw new Error("WCT requires Mocha. Please ensure that it is present in WCT.environmentScripts, or that you load it before loading web-component-tester/browser.js")}injectMocha(Mocha);var mochaPrefix=scriptPrefix("mocha.js");if(mochaPrefix&&window.top===window.self){loadStyle(mochaPrefix+"mocha.css")}}function _checkChai(){if(!window.chai){debug("Chai not present; not registering shorthands");return}window.assert=window.chai.assert;window.expect=window.chai.expect}var globalErrors=[];function listenForErrors(){window.addEventListener("error",function(event){globalErrors.push(event.error)});var origConsole=console,origError=console.error;console.error=function wctShimmedError(){origError.apply(origConsole,arguments);if(get("trackConsoleError")){throw"console.error: "+Array.prototype.join.call(arguments," ")}}}var interfaceExtensions=[];function extendInterfaces(helperName,helperFactory){interfaceExtensions.push(function(){var Mocha=window.Mocha;Object.keys(Mocha.interfaces).forEach(function(interfaceName){var originalInterface=Mocha.interfaces[interfaceName],teardownProperty="tdd"===interfaceName?"teardown":"afterEach";Mocha.interfaces[interfaceName]=function(suite){originalInterface.apply(this,arguments);suite.on("pre-require",function(context,_file,_mocha){var teardown=context[teardownProperty].bind(context);context[helperName]=helperFactory(context,teardown,interfaceName)})}})})}function applyExtensions(){interfaceExtensions.forEach(function(applyExtension){applyExtension()})}extendInterfaces("fixture",function(context,teardown){return context.fixture||function fixture(fixtureId,model){teardown(function(){document.getElementById(fixtureId).restore()});return document.getElementById(fixtureId).create(model)}});extendInterfaces("stub",function(_context,teardown){return function stub(tagName,implementation){var proto=document.createElement(tagName).constructor.prototype,stubs=Object.keys(implementation).map(function(key){return sinon.stub(proto,key,implementation[key])});teardown(function(){stubs.forEach(function(stub){stub.restore()})})}});var replacements={},replaceTeardownAttached=!1;extendInterfaces("replace",function(_context,teardown){return function replace(oldTagName){return{with:function(tagName){oldTagName=oldTagName.toLowerCase();tagName=tagName.toLowerCase();replacements[oldTagName]=tagName;if(document.importNode.isSinonProxy){return}if(!window.Polymer.Element){window.Polymer.Element=function(){};window.Polymer.Element.prototype._stampTemplate=function(){}}var originalImportNode=document.importNode;sinon.stub(document,"importNode",function(origContent,deep){var templateClone=document.createElement("template"),content=templateClone.content,inertDoc=content.ownerDocument;templateClone.content.appendChild(inertDoc.importNode(origContent,!0));var nodeIterator=document.createNodeIterator(content,NodeFilter.SHOW_ELEMENT,null,!0),node;while(node=nodeIterator.nextNode()){var currentTagName=node.tagName.toLowerCase();if(replacements.hasOwnProperty(currentTagName)){currentTagName=replacements[currentTagName];while(replacements[currentTagName]){currentTagName=replacements[currentTagName]}for(var replacement=document.createElement(currentTagName),index=0;index<node.attributes.length;++index){replacement.setAttribute(node.attributes[index].name,node.attributes[index].value)}node.parentNode.replaceChild(replacement,node)}}return originalImportNode.call(this,content,deep)});if(!replaceTeardownAttached){teardown(function(){replaceTeardownAttached=!0;var documentImportNode=document.importNode;if(documentImportNode.isSinonProxy){documentImportNode.restore()}replacements={}})}}}}});var MOCHA_EXPORTS={tdd:{setup:"\"before\"",teardown:"\"after\"",suiteSetup:"\"beforeEach\"",suiteTeardown:"\"afterEach\"",suite:"\"describe\" or \"context\"",test:"\"it\" or \"specify\""},bdd:{before:"\"setup\"",after:"\"teardown\"",beforeEach:"\"suiteSetup\"",afterEach:"\"suiteTeardown\"",describe:"\"suite\"",context:"\"suite\"",xdescribe:"\"suite.skip\"",xcontext:"\"suite.skip\"",it:"\"test\"",xit:"\"test.skip\"",specify:"\"test\"",xspecify:"\"test.skip\""}};function stubInterfaces(){var keys=Object.keys(MOCHA_EXPORTS);keys.forEach(function(ui){Object.keys(MOCHA_EXPORTS[ui]).forEach(function(key){window[key]=function wrappedMochaFunction(){_setupMocha(ui,key,MOCHA_EXPORTS[ui][key]);if(!window[key]||window[key]===wrappedMochaFunction){throw new Error("Expected mocha.setup to define "+key)}window[key].apply(window,arguments)}})})}var _mochaIsSetup=!1;function _setupMocha(ui,key,alternate){var mochaOptions=get("mochaOptions");if(mochaOptions.ui&&mochaOptions.ui!==ui){var message="Mixing "+mochaOptions.ui+" and "+ui+" Mocha styles is not supported. "+"You called \""+key+"\". Did you mean "+alternate+"?";throw new Error(message)}if(_mochaIsSetup){return}applyExtensions();mochaOptions.ui=ui;mocha.setup(mochaOptions)}setup(window.WCT);var WCT=window.WCT={share:{},_ChildRunner:ChildRunner,_reporter:void 0,_config:_config,loadSuites:loadSuites};listenForErrors();stubInterfaces();loadSync();document.addEventListener("DOMContentLoaded",function(){debug("DOMContentLoaded");ensureDependenciesPresent();CLISocket.init(function(error,socket){if(error)throw error;var current=ChildRunner.current(),parent=current&&current.parentScope.WCT._reporter;debug("parentReporter:",parent);var childSuites=activeChildSuites(),reportersToUse=determineReporters(socket,parent),reporter=new MultiReporter(childSuites.length+1,reportersToUse,parent);WCT._reporter=reporter;loadJsSuites(reporter,function(error){if(current)current.ready(error);if(error)throw error;globalErrors.forEach(function onError(error){reporter.emitOutOfBandTest("Test Suite Initialization",error)});runSuites(reporter,childSuites,function(error){if(current)current.done();if(error)throw error})})})})})();