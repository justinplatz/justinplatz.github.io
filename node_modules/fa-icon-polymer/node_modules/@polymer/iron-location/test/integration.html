<!DOCTYPE html><html><head><title>iron-location</title><script src="../../../@webcomponents/webcomponentsjs/webcomponents-bundle.js"></script><script src="../../../wct-browser-legacy/browser.js"></script><script>define(['../../polymer/polymer-legacy.js']);</script><script>define(['../../promise-polyfill/promise-polyfill.js']);</script><script>define(['../iron-query-params.js']);</script><script>define(['../iron-location.js']);</script><script>define(['./replace-state-patch.js']);</script></head><body><div id="safari-cooldown" hidden=""><div>Danger: URL overheating.</div><div>Safari and Chrome require a cooldown period before we call pushState/replaceState any more.</div><div>Testing will resume after 30 seconds.</div><div><a href="https://forums.developer.apple.com/thread/36650">More info Safari</a> <a href="https://codereview.chromium.org/2972073002">Chrome</a></div></div><dom-module id="integration-element"><template><iron-location id="location" path="{{path}}" query="{{query}}" hash="{{hash}}"></iron-location><iron-query-params id="queryParams" params-string="{{query}}" params-object="{{queryParams}}"></iron-query-params></template><script>define(["../../polymer/polymer-legacy.js","@polymer/promise-polyfill/promise-polyfill.js","../iron-query-params.js","../iron-location.js","./replace-state-patch.js","../../polymer/lib/legacy/polymer-fn.js"],function(_polymerLegacy,_promisePolyfill,_ironQueryParams,_ironLocation,_replaceStatePatch,_polymerFn){"use strict";(0,_polymerFn.Polymer)({is:"integration-element"})});</script></dom-module><test-fixture id="Integration"><template><integration-element></integration-element></template></test-fixture><script>define(["../../polymer/polymer-legacy.js","@polymer/promise-polyfill/promise-polyfill.js","../iron-query-params.js","../iron-location.js","./replace-state-patch.js"],function(_polymerLegacy,_promisePolyfill,_ironQueryParams,_ironLocation,_replaceStatePatch){"use strict";suite("Integration tests",function(){var integration,ironLocation,ironQueryParams;setup(function(){integration=fixture("Integration");ironLocation=integration.$.location;ironQueryParams=integration.$.queryParams;return cooldownFunction.call(this)});teardown(function(){return cooldownFunction.call(this)});test("propagations from location to iqp",function(){var queryEncodingExamples={foo:"?foo","":"","foo bar":"?foo%20bar","foo#bar":"?foo%23bar","foo?bar":"?foo?bar","/foo'bar'baz":["?/foo%27bar%27baz","?/foo'bar'baz"],"foo/bar/baz":"?foo/bar/baz"};for(var plainTextQuery in queryEncodingExamples){var encodedQueries=queryEncodingExamples[plainTextQuery],ironLocationQuery=encodedQueries;if("string"===typeof encodedQueries){encodedQueries=[encodedQueries];ironLocationQuery=[ironLocationQuery.substring(1)]}else{ironLocationQuery=ironLocationQuery.map(function(value){return value.substring(1)})}ironLocation.query=plainTextQuery;expect(encodedQueries).to.contain(window.location.search);expect(ironLocationQuery).to.contain(ironLocation.query);expect(ironLocationQuery).to.contain(ironQueryParams.paramsString);if(plainTextQuery){expect("").to.be.equal(ironQueryParams.paramsObject[plainTextQuery])}else{expect(ironQueryParams.paramsObject[plainTextQuery]).to.be.undefined}}});test("propagations from iqp to location",function(){var queryEncodingExamples={foo:"?foo","":"","foo bar":"?foo%20bar","foo#bar":"?foo%23bar","foo?bar":"?foo?bar","/foo'bar'baz":["?/foo%27bar%27baz","?/foo'bar'baz"],"foo/bar/baz":"?foo/bar/baz"};for(var plainTextQuery in queryEncodingExamples){var encodedQueries=queryEncodingExamples[plainTextQuery],ironLocationQuery=encodedQueries;if("string"===typeof encodedQueries){encodedQueries=[encodedQueries];ironLocationQuery=[ironLocationQuery.substring(1)]}else{ironLocationQuery=ironLocationQuery.map(function(value){return value.substring(1)})}var newParamsObject={};newParamsObject[plainTextQuery]="";ironQueryParams.paramsObject=newParamsObject;expect(encodedQueries).to.contain(window.location.search);expect(ironLocationQuery).to.contain(ironLocation.query)}})})});</script></body></html>