var LodashWrapper=require("./LodashWrapper"),getData=require("./getData"),getFuncName=require("./getFuncName"),isArray=require("../lang/isArray"),isLaziable=require("./isLaziable"),CURRY_FLAG=8,PARTIAL_FLAG=32,ARY_FLAG=128,REARG_FLAG=256,LARGE_ARRAY_SIZE=200,FUNC_ERROR_TEXT="Expected a function";function createFlow(fromRight){return function(){var wrapper,length=arguments.length,index=fromRight?length:-1,leftIndex=0,funcs=Array(length);while(fromRight?index--:++index<length){var func=funcs[leftIndex++]=arguments[index];if("function"!=typeof func){throw new TypeError(FUNC_ERROR_TEXT)}if(!wrapper&&LodashWrapper.prototype.thru&&"wrapper"==getFuncName(func)){wrapper=new LodashWrapper([],!0)}}index=wrapper?-1:length;while(++index<length){func=funcs[index];var funcName=getFuncName(func),data="wrapper"==funcName?getData(func):void 0;if(data&&isLaziable(data[0])&&data[1]==(ARY_FLAG|CURRY_FLAG|PARTIAL_FLAG|REARG_FLAG)&&!data[4].length&&1==data[9]){wrapper=wrapper[getFuncName(data[0])].apply(wrapper,data[3])}else{wrapper=1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}}return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value)&&value.length>=LARGE_ARRAY_SIZE){return wrapper.plant(value).value()}var index=0,result=length?funcs[index].apply(this,args):value;while(++index<length){result=funcs[index].call(this,result)}return result}}}module.exports=createFlow;